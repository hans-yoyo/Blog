{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"themes/next/source/js/algolia-search.js","path":"js/algolia-search.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/affix.js","path":"js/affix.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/exturl.js","path":"js/exturl.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/js.cookie.js","path":"js/js.cookie.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/motion.js","path":"js/motion.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/next-boot.js","path":"js/next-boot.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/post-details.js","path":"js/post-details.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/scroll-cookie.js","path":"js/scroll-cookie.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/scrollspy.js","path":"js/scrollspy.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/utils.js","path":"js/utils.js","modified":1,"renderable":1},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/loading.gif","path":"images/loading.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/searchicon.png","path":"images/searchicon.png","modified":1,"renderable":1},{"_id":"themes/next/source/js/schemes/muse.js","path":"js/schemes/muse.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/schemes/pisces.js","path":"js/schemes/pisces.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":1,"renderable":1},{"_id":"themes/cafe/source/favicon.ico","path":"favicon.ico","modified":1,"renderable":1},{"_id":"themes/cafe/source/css/style.styl","path":"css/style.styl","modified":1,"renderable":1},{"_id":"themes/cafe/source/fancybox/blank.gif","path":"fancybox/blank.gif","modified":1,"renderable":1},{"_id":"themes/cafe/source/fancybox/fancybox_loading.gif","path":"fancybox/fancybox_loading.gif","modified":1,"renderable":1},{"_id":"themes/cafe/source/fancybox/fancybox_loading@2x.gif","path":"fancybox/fancybox_loading@2x.gif","modified":1,"renderable":1},{"_id":"themes/cafe/source/fancybox/fancybox_overlay.png","path":"fancybox/fancybox_overlay.png","modified":1,"renderable":1},{"_id":"themes/cafe/source/fancybox/fancybox_sprite.png","path":"fancybox/fancybox_sprite.png","modified":1,"renderable":1},{"_id":"themes/cafe/source/fancybox/fancybox_sprite@2x.png","path":"fancybox/fancybox_sprite@2x.png","modified":1,"renderable":1},{"_id":"themes/cafe/source/fancybox/jquery.fancybox.css","path":"fancybox/jquery.fancybox.css","modified":1,"renderable":1},{"_id":"themes/cafe/source/fancybox/jquery.fancybox.js","path":"fancybox/jquery.fancybox.js","modified":1,"renderable":1},{"_id":"themes/cafe/source/fancybox/jquery.fancybox.pack.js","path":"fancybox/jquery.fancybox.pack.js","modified":1,"renderable":1},{"_id":"themes/cafe/source/images/fly-to-top.png","path":"images/fly-to-top.png","modified":1,"renderable":1},{"_id":"themes/cafe/source/js/elevator.js","path":"js/elevator.js","modified":1,"renderable":1},{"_id":"themes/cafe/source/js/is.js","path":"js/is.js","modified":1,"renderable":1},{"_id":"themes/cafe/source/js/script.js","path":"js/script.js","modified":1,"renderable":1},{"_id":"themes/cafe/source/duoshuo/embed.js","path":"duoshuo/embed.js","modified":1,"renderable":1},{"_id":"themes/cafe/source/jquery/jquery.min.js","path":"jquery/jquery.min.js","modified":1,"renderable":1},{"_id":"themes/cafe/source/fancybox/helpers/fancybox_buttons.png","path":"fancybox/helpers/fancybox_buttons.png","modified":1,"renderable":1},{"_id":"themes/cafe/source/fancybox/helpers/jquery.fancybox-buttons.css","path":"fancybox/helpers/jquery.fancybox-buttons.css","modified":1,"renderable":1},{"_id":"themes/cafe/source/fancybox/helpers/jquery.fancybox-buttons.js","path":"fancybox/helpers/jquery.fancybox-buttons.js","modified":1,"renderable":1},{"_id":"themes/cafe/source/fancybox/helpers/jquery.fancybox-media.js","path":"fancybox/helpers/jquery.fancybox-media.js","modified":1,"renderable":1},{"_id":"themes/cafe/source/fancybox/helpers/jquery.fancybox-thumbs.css","path":"fancybox/helpers/jquery.fancybox-thumbs.css","modified":1,"renderable":1},{"_id":"themes/cafe/source/fancybox/helpers/jquery.fancybox-thumbs.js","path":"fancybox/helpers/jquery.fancybox-thumbs.js","modified":1,"renderable":1},{"_id":"themes/cafe/source/themes/screenshots/Cafe.png","path":"themes/screenshots/Cafe.png","modified":1,"renderable":1},{"_id":"themes/cafe/source/css/fonts/fontawesome-webfont.woff","path":"css/fonts/fontawesome-webfont.woff","modified":1,"renderable":1},{"_id":"themes/cafe/source/css/fonts/fontawesome-webfont.woff2","path":"css/fonts/fontawesome-webfont.woff2","modified":1,"renderable":1},{"_id":"themes/cafe/source/css/fonts/FontAwesome.otf","path":"css/fonts/FontAwesome.otf","modified":1,"renderable":1},{"_id":"themes/cafe/source/css/fonts/fontawesome-webfont.eot","path":"css/fonts/fontawesome-webfont.eot","modified":1,"renderable":1},{"_id":"themes/cafe/source/css/fonts/fontawesome-webfont.ttf","path":"css/fonts/fontawesome-webfont.ttf","modified":1,"renderable":1},{"_id":"themes/cafe/source/css/images/banner.jpg","path":"css/images/banner.jpg","modified":1,"renderable":1},{"_id":"themes/cafe/source/css/fonts/fontawesome-webfont.svg","path":"css/fonts/fontawesome-webfont.svg","modified":1,"renderable":1}],"Cache":[{"_id":"themes/next/.editorconfig","hash":"792fd2bd8174ece1a75d5fd24ab16594886f3a7f","modified":1556945164547},{"_id":"themes/next/.all-contributorsrc","hash":"d139a3b623b2e40bbff5c96ad44adf7dbdbc5be1","modified":1556945164546},{"_id":"themes/next/.bowerrc","hash":"3228a58ed0ece9f85e1e3136352094080b8dece1","modified":1556945164546},{"_id":"themes/next/.eslintrc.json","hash":"cc5f297f0322672fe3f684f823bc4659e4a54c41","modified":1556945164547},{"_id":"themes/next/.gitattributes","hash":"44bd4729c74ccb88110804f41746fec07bf487d4","modified":1556945164548},{"_id":"themes/next/.gitignore","hash":"3558a8b174618c7a643aceb13233edd729813f9a","modified":1556945164559},{"_id":"themes/next/LICENSE.md","hash":"18144d8ed58c75af66cb419d54f3f63374cd5c5b","modified":1556945164560},{"_id":"themes/next/.stylintrc","hash":"b28e24704a5d8de08346c45286574c8e76cc109f","modified":1556945164559},{"_id":"themes/next/.travis.yml","hash":"3d1dc928c4a97933e64379cfde749dedf62f252c","modified":1556945164560},{"_id":"themes/next/bower.json","hash":"9bc3900396a375f817db47d147bb6d207c661678","modified":1556945164562},{"_id":"themes/next/crowdin.yml","hash":"e026078448c77dcdd9ef50256bb6635a8f83dca6","modified":1556945164562},{"_id":"themes/next/README.md","hash":"7958c3f70b2133b479ddaf525cc4b6d87a37e04a","modified":1556945164561},{"_id":"themes/next/_config.yml","hash":"158ecafc38e01414c3fe669bb619f34f58f7e2e8","modified":1557065182979},{"_id":"themes/next/gulpfile.coffee","hash":"23bd9587807edc4dbecb5c5a29ab96ade24458b5","modified":1556945164576},{"_id":"themes/next/package.json","hash":"0284636ddd0e06ae593f4887819f3a35b08c1370","modified":1556945164621},{"_id":"source/_posts/20190504-Hexo使用方法记录.md","hash":"59da661884b77b267d48189742add64e6122dced","modified":1557238150554},{"_id":"source/_posts/20190507-Git学习笔记.md","hash":"4cc059694ad77a807c1ff5daa46ba7c07343ab9f","modified":1557238157811},{"_id":"source/_posts/20190507-使用PicGo和GitHub搭建个人图床.md","hash":"99b1f4077f383bb894dd9d0e6eca2a2c40ab7861","modified":1557238138760},{"_id":"source/_posts/20190511-CentOS7下搭建FTP.md","hash":"eea5376ca3eb6f0ab873542ce4afa2cb0d661a99","modified":1557588689657},{"_id":"source/_posts/20190520-使用不同json包对象转Json过程中的大小写问题.md","hash":"58a1ccf62e0c3965a18ba6c819912ce15f35228f","modified":1558398870158},{"_id":"source/_posts/20190611-记一次事务不起作用的排错历程.md","hash":"071189c6dcc22b99145b608a9fe4e42c68f4abee","modified":1560262264769},{"_id":"source/about/index.md","hash":"19a5853e93d500d0513843a52f3e62d791de4a16","modified":1556978993430},{"_id":"source/tags/index.md","hash":"d201b448929c9a7330b213e2e7a719718981994e","modified":1556952153497},{"_id":"source/categories/index.md","hash":"0fc6ac175c7445d013251ecb2d2d95a0f960b3c9","modified":1556952119090},{"_id":"themes/next/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1556945164529},{"_id":"themes/next/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1556944971055},{"_id":"themes/next/.git/config","hash":"7f8b507977a695e25b27d4c2e8aaed71410536bf","modified":1556945164534},{"_id":"themes/next/.git/index","hash":"b6c6da1d9a1f388549f66137881b4edc9fa27d49","modified":1556945164701},{"_id":"themes/next/.github/CODE_OF_CONDUCT.md","hash":"c149f003d03501565e7688915cd8f2e99fbf8f42","modified":1556945164551},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"285a95aca36e0ac770bcde2b35e3b572d45d1518","modified":1556945164552},{"_id":"themes/next/.git/packed-refs","hash":"071a85ddf7fe2fd4c736d1f311d94c2cd0402c73","modified":1556945164522},{"_id":"themes/next/.github/ISSUE_TEMPLATE.md","hash":"00c25366764e6b9ccb40b877c60dc13b2916bbf7","modified":1556945164552},{"_id":"themes/next/.github/auto_assign.yml","hash":"cb68a1dca1c4623448c2ca899614a9f21df1b036","modified":1556945164555},{"_id":"themes/next/.github/PULL_REQUEST_TEMPLATE.md","hash":"492b2c159d871e5b5d4c70d259f36e603afe192d","modified":1556945164554},{"_id":"themes/next/.github/eslint-disable-bot.yml","hash":"16541fb7b80f5ab90135db96285badb63c4d7d3e","modified":1556945164556},{"_id":"themes/next/.github/config.yml","hash":"8a5cbf5aa9529390fe0a782758aca9c3a02f9dcf","modified":1556945164555},{"_id":"themes/next/.github/mergeable.yml","hash":"8e3a6abc74b5cba57f9586fe6d98762fd4fc9b04","modified":1556945164556},{"_id":"themes/next/.github/lock.yml","hash":"585d2c471047be320aa62f2b74dad797bf09c530","modified":1556945164556},{"_id":"themes/next/.github/release-drafter.yml","hash":"b4476ada5c62ee7d63ba2e59ead2ec4897086e3c","modified":1556945164557},{"_id":"themes/next/.github/stale.yml","hash":"41bf97ee86b8940a0b2e754499ec77fd2b44b717","modified":1556945164557},{"_id":"themes/next/.github/weekly-digest.yml","hash":"404e4ccb7fcd6587bc9b0247a7a7ff256d21f2cb","modified":1556945164558},{"_id":"themes/next/.github/topissuebot.yml","hash":"10665bf2b5aba351725715c71e94ad183a0e8f18","modified":1556945164558},{"_id":"themes/next/.github/support.yml","hash":"d75db6ffa7b4ca3b865a925f9de9aef3fc51925c","modified":1556945164558},{"_id":"themes/next/docs/ALGOLIA-SEARCH.md","hash":"0d2f22ea09dd1ef63c66164e048d8239d2ccb2b8","modified":1556945164563},{"_id":"themes/next/docs/AGPL3.md","hash":"0d2b8c5fa8a614723be0767cc3bca39c49578036","modified":1556945164563},{"_id":"themes/next/docs/AUTHORS.md","hash":"7b24be2891167bdedb9284a682c2344ec63e50b5","modified":1556945164564},{"_id":"themes/next/docs/DATA-FILES.md","hash":"8e1962dd3e1b700169b3ae5bba43992f100651ce","modified":1556945164565},{"_id":"themes/next/docs/INSTALLATION.md","hash":"2bbdd6c1751b2b42ce9b9335da420c6026a483e9","modified":1556945164565},{"_id":"themes/next/docs/LEANCLOUD-COUNTER-SECURITY.md","hash":"212a36d57495990b5f56e46ca8dce1d76c199660","modified":1556945164566},{"_id":"themes/next/docs/LICENSE.txt","hash":"368bf2c29d70f27d8726dd914f1b3211cae4bbab","modified":1556945164566},{"_id":"themes/next/docs/UPDATE-FROM-5.1.X.md","hash":"ad57c168d12ba01cf144a1ea0627b2ffd1847d3e","modified":1556945164568},{"_id":"themes/next/docs/MATH.md","hash":"026d2cff73c22a30ea39c50783557ff4913aceac","modified":1556945164567},{"_id":"themes/next/languages/de.yml","hash":"9e524b2bdfb848504b93a51c5650e76bba5fa9e0","modified":1556945164576},{"_id":"themes/next/languages/default.yml","hash":"ea5e6aee4cb14510793ac4593a3bddffe23e530c","modified":1556945164577},{"_id":"themes/next/languages/en.yml","hash":"c540c3a0d7db2d4239293c8783881962640b6c34","modified":1556945164577},{"_id":"themes/next/languages/es.yml","hash":"1752429687861b5cedd063c6ebe5dacefbe7e5a7","modified":1556945164577},{"_id":"themes/next/languages/fa.yml","hash":"cd41db832af5e399590b70a5227cfe0b0e98e101","modified":1556945164578},{"_id":"themes/next/languages/fr.yml","hash":"7005c2b42c2c6e82bd7a1be5cc2f443b5fc79105","modified":1556945164578},{"_id":"themes/next/languages/it.yml","hash":"b30ff77ad8044e3b021a3b09187cd377dc789fd2","modified":1556945164579},{"_id":"themes/next/languages/id.yml","hash":"1c4868837f5109f1df863b04fe627352c31d404b","modified":1556945164579},{"_id":"themes/next/languages/ja.yml","hash":"1dc35e436da6214cdb3c2ff44bc4a06d0be5b9a0","modified":1556945164580},{"_id":"themes/next/languages/ko.yml","hash":"20bfaa7600d35235996c18e5c13dcef89c119626","modified":1556945164580},{"_id":"themes/next/languages/nl.yml","hash":"1c44b3cb2f817808607f3bf6ef47f58ce7599995","modified":1556945164580},{"_id":"themes/next/languages/ru.yml","hash":"db0644e738d2306ac38567aa183ca3e859a3980f","modified":1556945164582},{"_id":"themes/next/languages/pt.yml","hash":"8ddac820e2c17b484b56c0da8881e142b10e221b","modified":1556945164582},{"_id":"themes/next/languages/pt-BR.yml","hash":"08b913a5cf4cc160083069cb4dfb2d66eecd1218","modified":1556945164581},{"_id":"themes/next/languages/tr.yml","hash":"c5f0c20743b1dd52ccb256050b1397d023e6bcd9","modified":1556945164583},{"_id":"themes/next/languages/uk.yml","hash":"1eb59e581568da9a81d6e20541b4ada5fc1c55c0","modified":1556945164583},{"_id":"themes/next/languages/vi.yml","hash":"ba7aff8f88e03f69a0acf7f1b90ee03e077ee88e","modified":1556945164584},{"_id":"themes/next/languages/zh-HK.yml","hash":"7903b96912c605e630fb695534012501b2fad805","modified":1556945164584},{"_id":"themes/next/languages/zh-CN.yml","hash":"fbbf3a0b664ae8e927c700b0a813692b94345156","modified":1556945164584},{"_id":"themes/next/languages/zh-TW.yml","hash":"6e6d2cd8f4244cb1b349b94904cb4770935acefd","modified":1556945164585},{"_id":"themes/next/layout/_layout.swig","hash":"74701fcf2303d59400587436ab4c244e04df7ad9","modified":1556945164586},{"_id":"themes/next/layout/archive.swig","hash":"7e8f3a41a68e912f2b2aaba905d314306ccaf794","modified":1556945164618},{"_id":"themes/next/layout/index.swig","hash":"c2a3896c64e96790edc10426ef586b6186a87f46","modified":1556945164619},{"_id":"themes/next/layout/category.swig","hash":"dda0e6b2139decaf5e865d22ec9d45fdb615a703","modified":1556945164619},{"_id":"themes/next/layout/schedule.swig","hash":"3268dd3d90d8b0e142cfa1a2ebb23355baeda148","modified":1556945164620},{"_id":"themes/next/layout/post.swig","hash":"f74929fd792541916eb25c2addfb35431be071ba","modified":1556945164620},{"_id":"themes/next/layout/page.swig","hash":"d8a6cbf6f611c5d68d5da430cb6dc7010ff2c7e0","modified":1556945164619},{"_id":"themes/next/layout/tag.swig","hash":"a6be69a90924c9d2f4d90fb4867234859bd2c2e9","modified":1556945164620},{"_id":"themes/next/scripts/merge-configs.js","hash":"33afe97284d34542015d358a720823feeebef120","modified":1556945164623},{"_id":"themes/next/scripts/merge.js","hash":"9130dabe6a674c54b535f322b17d75fe6081472f","modified":1556945164623},{"_id":"themes/next/test/.jshintrc","hash":"19f93d13d1689fe033c82eb2d5f3ce30b6543cc0","modified":1556945164699},{"_id":"themes/next/test/helpers.js","hash":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1556945164700},{"_id":"themes/next/test/intern.js","hash":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1556945164700},{"_id":"themes/next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1556945164673},{"_id":"themes/next/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1556944971056},{"_id":"themes/next/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1556944971058},{"_id":"themes/next/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1556944971058},{"_id":"themes/next/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1556944971057},{"_id":"themes/next/.git/hooks/pre-commit.sample","hash":"36aed8976dcc08b5076844f0ec645b18bc37758f","modified":1556944971059},{"_id":"themes/next/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1556944971062},{"_id":"themes/next/.git/hooks/pre-rebase.sample","hash":"5885a56ab4fca8075a05a562d005e922cde9853b","modified":1556944971063},{"_id":"themes/next/.git/hooks/prepare-commit-msg.sample","hash":"2b6275eda365cad50d167fe3a387c9bc9fedd54f","modified":1556944971064},{"_id":"themes/next/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1556944971067},{"_id":"themes/next/.git/logs/HEAD","hash":"2510dc7796c565d2bfc2f60edccf9d86d5611faa","modified":1556945164532},{"_id":"themes/next/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1556944971066},{"_id":"themes/next/.github/ISSUE_TEMPLATE/bug-report.md","hash":"c37a60580c901c79ccb22564b228a46e06207445","modified":1556945164553},{"_id":"themes/next/.github/ISSUE_TEMPLATE/custom-issue-template.md","hash":"57e1e06e845193e80c7df4a4454af28352526f7a","modified":1556945164553},{"_id":"themes/next/.github/ISSUE_TEMPLATE/feature-request.md","hash":"07c423cce4157b8e2dbf60907ccbf3f18c4cf98a","modified":1556945164554},{"_id":"themes/next/.github/ISSUE_TEMPLATE/non-english.md","hash":"0b0727ff4d5180ae67f930fb4f8e9488e33eda9f","modified":1556945164554},{"_id":"themes/next/docs/zh-CN/ALGOLIA-SEARCH.md","hash":"caa624092175d44e3d3a8c6ca23922718da2354c","modified":1556945164572},{"_id":"themes/next/docs/zh-CN/CODE_OF_CONDUCT.md","hash":"b218e30df4126b6adc87684775ac4c86ea7f7958","modified":1556945164572},{"_id":"themes/next/docs/zh-CN/DATA-FILES.md","hash":"f3eec572a7d83542e2710a7404082014aaa1a5e7","modified":1556945164573},{"_id":"themes/next/docs/zh-CN/CONTRIBUTING.md","hash":"bc43beb3af74d64fbd3920539d08861e4cadb9a0","modified":1556945164573},{"_id":"themes/next/docs/zh-CN/INSTALLATION.md","hash":"b19a6e0ae96eb7c756fb5b1ba03934c7f9cbb3c3","modified":1556945164574},{"_id":"themes/next/docs/zh-CN/LEANCLOUD-COUNTER-SECURITY.md","hash":"115ffbde2b3ce01ef1f8c2b3833e6f6794650132","modified":1556945164574},{"_id":"themes/next/docs/zh-CN/MATH.md","hash":"83feca62190abcca0332915ffe0eefe582573085","modified":1556945164575},{"_id":"themes/next/docs/zh-CN/UPDATE-FROM-5.1.X.md","hash":"5da70d7fa0c988a66a469b9795d33d471a4a4433","modified":1556945164575},{"_id":"themes/next/docs/zh-CN/README.md","hash":"cdd7a8bdcf4a83ff4c74ee6c95c6bcc0b8c1831c","modified":1556945164575},{"_id":"themes/next/docs/ru/DATA-FILES.md","hash":"d6d20f60f77a76c77f8e65d0c9adbd79d0274557","modified":1556945164569},{"_id":"themes/next/docs/ru/INSTALLATION.md","hash":"6c5d69e94961c793da156217ecf1179e868d7ba1","modified":1556945164570},{"_id":"themes/next/docs/ru/README.md","hash":"4d7ef717d0b57288e606996ee56c20ffd59d5a99","modified":1556945164570},{"_id":"themes/next/docs/ru/UPDATE-FROM-5.1.X.md","hash":"b1dd18d9b890b21718883ea1832e7e02a773104a","modified":1556945164571},{"_id":"themes/next/layout/_custom/header.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1556945164586},{"_id":"themes/next/layout/_custom/head.swig","hash":"9e1b9666efa77f4cf8d8261bcfa445a9ac608e53","modified":1556945164585},{"_id":"themes/next/layout/_custom/sidebar.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1556945164586},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"89b0a0e64637bf5b0cfea0a23642df3d95eedfa4","modified":1556945164588},{"_id":"themes/next/layout/_macro/post.swig","hash":"8a8a2865b09e933c454d9a68e54dd9063dc8c559","modified":1556945164588},{"_id":"themes/next/layout/_partials/comments.swig","hash":"5352f96f4544c1520babf1cec7b44ddf2f8057b3","modified":1556945164589},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"480d93619479dcfcbec6906803bb38b2dfbeae53","modified":1556945164589},{"_id":"themes/next/layout/_partials/footer.swig","hash":"589f545333e21a8c7823bce89ab45cf1eb7db6e2","modified":1556945164590},{"_id":"themes/next/layout/_partials/github-banner.swig","hash":"6357537ac0bb114aed4d61bafb39e6690a413697","modified":1556945164590},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"dbe321bcf3cf45917cc11a3e3f50d8572bac2c70","modified":1556945164594},{"_id":"themes/next/layout/_partials/post-edit.swig","hash":"06dac109504812b63766a80ede9ddacbd42d227d","modified":1556945164595},{"_id":"themes/next/layout/_third-party/baidu-push.swig","hash":"4ccf2abbfd070874265b0436a3eff21f7c998dfb","modified":1556945164608},{"_id":"themes/next/layout/_third-party/bookmark.swig","hash":"10b61a8bac671e375916a4d234c120117098a78f","modified":1556945164609},{"_id":"themes/next/layout/_third-party/chatra.swig","hash":"eefb68b69b4b0ed558ee0324ccd711990059b20d","modified":1556945164609},{"_id":"themes/next/layout/_third-party/copy-code.swig","hash":"9be7c2c9cef63006866d1232c5289901e46be7ed","modified":1556945164613},{"_id":"themes/next/layout/_third-party/mermaid.swig","hash":"d6e6ddda836bd9e2e8d9767a910c7d3280080e81","modified":1556945164614},{"_id":"themes/next/layout/_third-party/pdf.swig","hash":"810a9b2a6059f46c4a2ddb178f1eaa4c5e23750b","modified":1556945164615},{"_id":"themes/next/layout/_third-party/pangu.swig","hash":"c28f9dc96ab735daeb7f599f86470aa5a83c03cf","modified":1556945164615},{"_id":"themes/next/layout/_third-party/rating.swig","hash":"cbe40cb67dad15ade967b0f396c1a95b6871f76a","modified":1556945164616},{"_id":"themes/next/layout/_third-party/needsharebutton.swig","hash":"2c4a66be4677d3e4dec3f169ac8a769098dad1fe","modified":1556945164615},{"_id":"themes/next/layout/_third-party/quicklink.swig","hash":"5db80e8d7ea3f29e998320f79508f7e14342a33c","modified":1556945164616},{"_id":"themes/next/layout/_third-party/schedule.swig","hash":"2398e5cd0cb466953b6e7a42c2b2caddebf3c348","modified":1556945164616},{"_id":"themes/next/layout/_third-party/tidio.swig","hash":"912368c41de675f458b267a49a99ae3e7e420ebb","modified":1556945164618},{"_id":"themes/next/layout/_scripts/commons.swig","hash":"50be1762f60222379a8bef5e42ab1a0f3872b7ff","modified":1556945164599},{"_id":"themes/next/layout/_scripts/exturl.swig","hash":"61ae10d41f67ece004a025077fdb28724af05090","modified":1556945164600},{"_id":"themes/next/layout/_scripts/next-boot.swig","hash":"012e3ece672cc3b13d5e032139f328d3426d7d65","modified":1556945164600},{"_id":"themes/next/layout/_scripts/noscript.swig","hash":"edaff4766e0c05fd5c889d9dd32884d376bef9d9","modified":1556945164600},{"_id":"themes/next/layout/_scripts/scroll-cookie.swig","hash":"ccd13d73429ef91ef5e8b7d9fa43c8188facdf41","modified":1556945164603},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"83470eb401f78f4683907c48ad6760b90730daa3","modified":1556945164603},{"_id":"themes/next/scripts/filters/exturl.js","hash":"79ad823ca803cb00e0bfc648aa6c9d59711e0519","modified":1556945164621},{"_id":"themes/next/scripts/helpers/engine.js","hash":"60eb1554456d9d0e5afc4a2d16f1580a0aa02da8","modified":1556945164622},{"_id":"themes/next/scripts/helpers/next-url.js","hash":"799a042bbf497a4c7a2981aa2014ff28fa1bb382","modified":1556945164622},{"_id":"themes/next/scripts/tags/button.js","hash":"f3b4f7ae7e58072bbf410d950a99a0b53cbc866d","modified":1556945164624},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"f13430d9d1c9773b390787c2f046bb1f12a79878","modified":1556945164624},{"_id":"themes/next/scripts/tags/exturl.js","hash":"d605918cf819887e9555212dbe12da97fd887a0b","modified":1556945164625},{"_id":"themes/next/scripts/tags/full-image.js","hash":"fcb41c1c81560ed49dc4024654388a28ee7d32b0","modified":1556945164625},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"598220fa92ff3540dcab74f633ba41523daa8364","modified":1556945164625},{"_id":"themes/next/scripts/tags/include-raw.js","hash":"5db59d56f4f4082382bf1c16722e6c383892b0c5","modified":1556945164626},{"_id":"themes/next/scripts/tags/label.js","hash":"fc5b267d903facb7a35001792db28b801cccb1f8","modified":1556945164626},{"_id":"themes/next/scripts/tags/mermaid.js","hash":"983c6c4adea86160ecc0ba2204bc312aa338121d","modified":1556945164626},{"_id":"themes/next/scripts/tags/note.js","hash":"0a02bb4c15aec41f6d5f1271cdb5c65889e265d9","modified":1556945164627},{"_id":"themes/next/scripts/tags/pdf.js","hash":"f780cc72bff91d2720626e7af69eed25e9c12a29","modified":1556945164627},{"_id":"themes/next/scripts/tags/tabs.js","hash":"00ca6340d4fe0ccdae7525373e4729117775bbfa","modified":1556945164627},{"_id":"themes/next/scripts/tags/video.js","hash":"e5ff4c44faee604dd3ea9db6b222828c4750c227","modified":1556945164628},{"_id":"themes/next/source/css/main.styl","hash":"e010ec8ac73268a0f137204c89e0080ab8d59b3d","modified":1556945164672},{"_id":"themes/next/source/js/algolia-search.js","hash":"1f7f10c579e7703d0f6acb8b73f3d78a07d0c623","modified":1556945164680},{"_id":"themes/next/source/js/affix.js","hash":"a2aab233d99297435a5274bf512c3c753fe08e80","modified":1556945164680},{"_id":"themes/next/source/js/exturl.js","hash":"54825acc8de4793feac415be227b965428f4e97d","modified":1556945164681},{"_id":"themes/next/source/js/js.cookie.js","hash":"e0afce539f1fb81d59e3c6f0a68d736e2fb45d93","modified":1556945164681},{"_id":"themes/next/source/js/motion.js","hash":"a16bc0b701646bf6653484675f4d5dc0f892d184","modified":1556945164681},{"_id":"themes/next/source/js/next-boot.js","hash":"e0615efab5f81ba0fd39c0527eac31144deac7ce","modified":1556945164682},{"_id":"themes/next/source/js/post-details.js","hash":"0dde5e6d4547587662a3256317a9d5d1db507692","modified":1556945164682},{"_id":"themes/next/source/js/scroll-cookie.js","hash":"d07b3776708d4ae79ed2037c4c7391d5c9b06b19","modified":1556945164684},{"_id":"themes/next/source/js/scrollspy.js","hash":"fa3c92968bcdbcb8d95a1729f7659d9753cbd077","modified":1556945164684},{"_id":"themes/next/source/js/utils.js","hash":"81913c5f75d0949443833cf4269ad63bd7f9be6f","modified":1556945164685},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1556945164673},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1556945164674},{"_id":"themes/next/source/images/avatar.gif","hash":"18c53e15eb0c84b139995f9334ed8522b40aeaf6","modified":1556945164674},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1556945164674},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1556945164675},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1556945164675},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1556945164676},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1556945164676},{"_id":"themes/next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1556945164676},{"_id":"themes/next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1556945164677},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1556945164677},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1556945164677},{"_id":"themes/next/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1556945164678},{"_id":"themes/next/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1556945164678},{"_id":"themes/next/source/images/logo.svg","hash":"d29cacbae1bdc4bbccb542107ee0524fe55ad6de","modified":1556945164678},{"_id":"themes/next/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1556945164679},{"_id":"themes/next/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1556945164679},{"_id":"themes/next/source/images/searchicon.png","hash":"025d64ba0160a3a2257dd2b3032b5f7c9dd9b82b","modified":1556945164679},{"_id":"themes/next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1556945164659},{"_id":"themes/next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1556945164659},{"_id":"themes/next/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1556945164660},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1556945164671},{"_id":"themes/next/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1556945164672},{"_id":"themes/next/.git/refs/heads/master","hash":"d591ec996e3ef9ea7b8660103296d85235048ca2","modified":1556945164530},{"_id":"themes/next/layout/_macro/menu/menu-badge.swig","hash":"65c5e585982dae7ae1542cada71858b4ea1f73d6","modified":1556945164587},{"_id":"themes/next/layout/_macro/menu/menu-item.swig","hash":"fb33f499022cd02722f834fcef1a0e193362cfde","modified":1556945164587},{"_id":"themes/next/layout/_partials/head/external-fonts.swig","hash":"fc6bafc8c633afadc538c5afa5620ea2a1cdcb84","modified":1556945164591},{"_id":"themes/next/layout/_partials/head/head-unique.swig","hash":"02bb5748e8540b024e7f4008a9e640890b45280f","modified":1556945164591},{"_id":"themes/next/layout/_partials/head/head.swig","hash":"36eae78a4d7160a1c5e59ca3f7333f00b43d359b","modified":1556945164591},{"_id":"themes/next/layout/_partials/header/brand.swig","hash":"648bf7eda66629592cb915c4004534b3913cbc22","modified":1556945164592},{"_id":"themes/next/layout/_partials/header/index.swig","hash":"2082f5077551123e695e8afec471c9c44b436acb","modified":1556945164592},{"_id":"themes/next/layout/_partials/header/menu.swig","hash":"71af31fea5913fd30c233e555ef13cf2c9768f72","modified":1556945164593},{"_id":"themes/next/layout/_partials/header/sub-menu.swig","hash":"5adc60100e129c1d0307bdcaa0c7b8e8375a6ea4","modified":1556945164593},{"_id":"themes/next/layout/_partials/page/page-header.swig","hash":"2940df694fff28e8bf71b6546b4162f1e38227db","modified":1556945164594},{"_id":"themes/next/layout/_partials/page/breadcrumb.swig","hash":"0fa4fadb39467b01cede49f21b22e86b1a2da805","modified":1556945164593},{"_id":"themes/next/layout/_partials/post/post-copyright.swig","hash":"3615db591dd910fb9fa96542734c7ec0ef05019c","modified":1556945164595},{"_id":"themes/next/layout/_partials/post/post-related.swig","hash":"eea95b785c9c36d28e1839619793f66e89773bee","modified":1556945164596},{"_id":"themes/next/layout/_partials/post/wechat-subscriber.swig","hash":"ef11b5be5bfb2f0affe82cf521c002b37fef9819","modified":1556945164596},{"_id":"themes/next/layout/_partials/search/index.swig","hash":"7d1693416a5dc098f4723a53da2e2d1fc2d6e075","modified":1556945164597},{"_id":"themes/next/layout/_partials/post/reward.swig","hash":"d44f025eb93c99ddf90202d8293ccf80689a00c7","modified":1556945164596},{"_id":"themes/next/layout/_partials/search/algolia-search.swig","hash":"ba698f49dd3a868c95b240d802f5b1b24ff287e4","modified":1556945164597},{"_id":"themes/next/layout/_partials/search/swiftype.swig","hash":"a5587bd1f60d35e58618576cec45e662aa44ea1f","modified":1556945164598},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"957701729b85fb0c5bfcf2fb99c19d54582f91ed","modified":1556945164597},{"_id":"themes/next/layout/_partials/share/add-this.swig","hash":"15b542f5b06b7532234af367340b9ed9fcebb0ac","modified":1556945164598},{"_id":"themes/next/layout/_third-party/analytics/analytics-with-widget.swig","hash":"a5723950c343d220270bfd27bd30050eda6c3fb3","modified":1556945164604},{"_id":"themes/next/layout/_partials/share/baidushare.swig","hash":"6f181cc188ecbe5e607fd989756e470d4cb9765d","modified":1556945164599},{"_id":"themes/next/layout/_partials/share/likely.swig","hash":"b45e934d24d76ec6b6a790e92bdb3d56186b0e2a","modified":1556945164599},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.swig","hash":"591b2ccd9713ccb922b9fcf5e278b6de9c5ec30b","modified":1556945164604},{"_id":"themes/next/layout/_third-party/analytics/application-insights.swig","hash":"798d67e4a736613ab899eabe6529091bbcda7850","modified":1556945164604},{"_id":"themes/next/layout/_third-party/analytics/cnzz-analytics.swig","hash":"08cd47ef8572121b7811342d3c9a84a338a18191","modified":1556945164605},{"_id":"themes/next/layout/_third-party/analytics/busuanzi-counter.swig","hash":"8eadb929c9e50e58502ccad2dc2657746f8c592a","modified":1556945164605},{"_id":"themes/next/layout/_third-party/analytics/facebook-sdk.swig","hash":"050ea01f25cfe492be9bb77b409644d623fdf2dc","modified":1556945164606},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.swig","hash":"d422beaf35a5d2646feaa098bc3e5adf691c7565","modified":1556945164606},{"_id":"themes/next/layout/_third-party/analytics/firestore.swig","hash":"fae69a0e1a1d42f7bb44e594a29857d94594698b","modified":1556945164606},{"_id":"themes/next/layout/_third-party/analytics/growingio.swig","hash":"4a966b7ffe2d80ff1b3dd0fd14b355766dc5c70f","modified":1556945164607},{"_id":"themes/next/layout/_third-party/analytics/index.swig","hash":"438c6f5e6665d72f4ea7ee206011d669246f6102","modified":1556945164607},{"_id":"themes/next/layout/_third-party/analytics/tencent-analytics.swig","hash":"f240a50cd9b627620d9a374a29cf95f0c5e99d7c","modified":1556945164608},{"_id":"themes/next/layout/_third-party/analytics/tencent-mta.swig","hash":"92e04a2b9e0c3df594bc22235d1894e5ad458dfc","modified":1556945164608},{"_id":"themes/next/layout/_third-party/analytics/lean-analytics.swig","hash":"c754f699c90f6278b9159eff1855c17bc713ee96","modified":1556945164607},{"_id":"themes/next/layout/_third-party/analytics/vkontakte-api.swig","hash":"0dd5b315d1da55dbfc10f51a1f8952f72eba2720","modified":1556945164608},{"_id":"themes/next/layout/_third-party/comments/changyan.swig","hash":"3533167c4295637b91d90f3bae7c651cd128bb6e","modified":1556945164610},{"_id":"themes/next/layout/_third-party/comments/disqusjs.swig","hash":"c77a2e7ef5f449a445fb4d36b055721fba4a81af","modified":1556945164610},{"_id":"themes/next/layout/_third-party/comments/disqus.swig","hash":"3cfeafefc672d9a7704650ebfb2f9d8668b38d9a","modified":1556945164610},{"_id":"themes/next/layout/_third-party/comments/gitalk.swig","hash":"e8f91c571ceb4b80aafebc4d36b89fb41b1ae040","modified":1556945164611},{"_id":"themes/next/layout/_third-party/comments/livere.swig","hash":"5856d5f701e51dfae1fd6fb486cefde67effd555","modified":1556945164612},{"_id":"themes/next/layout/_third-party/comments/index.swig","hash":"2cbaae65a020bbb0e9265364488aff8bf84fa48d","modified":1556945164611},{"_id":"themes/next/layout/_third-party/math/index.swig","hash":"a7e304b05a44279d3e4f611908d7faef9dc14d7c","modified":1556945164613},{"_id":"themes/next/layout/_third-party/comments/valine.swig","hash":"4a908b613518878b9b69576c5dba4a5185f552ab","modified":1556945164612},{"_id":"themes/next/layout/_third-party/comments/gitment.swig","hash":"388efc86af7f19c05ad0e26720cd24ee012d20b9","modified":1556945164611},{"_id":"themes/next/layout/_third-party/math/katex.swig","hash":"c2cb2f384bc30d31cdccf9794a729c03e687b45c","modified":1556945164614},{"_id":"themes/next/layout/_third-party/math/mathjax.swig","hash":"601774d8672577aefbcefac82c94b01f0338da31","modified":1556945164614},{"_id":"themes/next/layout/_third-party/search/index.swig","hash":"ea94aa85034c6d1b6bb865aecea55c73f8a14501","modified":1556945164617},{"_id":"themes/next/layout/_third-party/search/algolia-search.swig","hash":"0a13dfd2de52a96901039098c6fc7b515edfc50b","modified":1556945164617},{"_id":"themes/next/layout/_third-party/search/localsearch.swig","hash":"b3eaab6a269aa3fcbafe24fd06f0c9206dc12716","modified":1556945164617},{"_id":"themes/next/layout/_scripts/pages/post-details.swig","hash":"5b05f165547391bf231e52f56f3d925efc09bc44","modified":1556945164601},{"_id":"themes/next/layout/_scripts/schemes/gemini.swig","hash":"ffc8e8836714ea79abeb77b75859634615652877","modified":1556945164601},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"108b157fbd1ac3baaf19ae87234fa8728ab79556","modified":1556945164602},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"0097e45e7b671f8006b8b2d3c4f95cacc76a983c","modified":1556945164602},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"e42604fbb17648484e5f12afe230d826de089388","modified":1556945164602},{"_id":"themes/next/source/css/_custom/custom.styl","hash":"328d9a9696cc2ccf59c67d3c26000d569f46344c","modified":1556945164658},{"_id":"themes/next/source/css/_mixins/Gemini.styl","hash":"2aa5b7166a85a8aa34b17792ae4f58a5a96df6cc","modified":1556945164658},{"_id":"themes/next/source/css/_mixins/Pisces.styl","hash":"2e8fb29aa92325df39054b5450757858c6cebc41","modified":1556945164659},{"_id":"themes/next/source/css/_mixins/base.styl","hash":"2036bbb73afd43251982ce824f06c6e88d35a2ef","modified":1556945164659},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"be087dcc060e8179f7e7f60ab4feb65817bd3d9f","modified":1556945164671},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"a8aa41625b94cf17a7f473ed10dcbe683b1db705","modified":1556945164670},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"fc15e277d1504532a09b7b1bd31f900ad95ec4b8","modified":1556945164671},{"_id":"themes/next/source/css/_variables/base.styl","hash":"640f25a63770af5566ccc9cec79c40a4f1c0b29e","modified":1556945164671},{"_id":"themes/next/source/js/schemes/muse.js","hash":"e9bfa6b343b67625f58757efce46ccdaac8f308c","modified":1556945164683},{"_id":"themes/next/source/js/schemes/pisces.js","hash":"9eb63cba0327d3d11b6cbfcbe40b88e97a8378a3","modified":1556945164683},{"_id":"themes/next/source/lib/font-awesome/.bower.json","hash":"a2aaaf12378db56bd10596ba3daae30950eac051","modified":1556945164686},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1556945164687},{"_id":"themes/next/source/lib/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1556945164686},{"_id":"themes/next/source/lib/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1556945164687},{"_id":"themes/next/source/lib/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1556945164687},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1556945164698},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1556945164698},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1556945164699},{"_id":"themes/next/source/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1556945164695},{"_id":"themes/next/.git/logs/refs/heads/master","hash":"2510dc7796c565d2bfc2f60edccf9d86d5611faa","modified":1556945164531},{"_id":"themes/next/.git/refs/remotes/origin/HEAD","hash":"d9427cda09aba1cdde5c69c2b13c905bddb0bc51","modified":1556945164527},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"fe5ff961b86004a306778c7d33a85b32e5e00e48","modified":1556945164629},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"c8b3225396cb444d8baeb94bac78e5216b992a81","modified":1556945164629},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"9d71f34fa13a41b8c8cd2fbdf3fdea608385277c","modified":1556945164630},{"_id":"themes/next/source/css/_common/components/comments.styl","hash":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1556945164630},{"_id":"themes/next/source/css/_common/components/buttons.styl","hash":"b98c65006e2546fbf3870c16fbbcbc009dbaab15","modified":1556945164630},{"_id":"themes/next/source/css/_common/components/pagination.styl","hash":"ce826aedf42b9eca424a044452f5d193866726a6","modified":1556945164638},{"_id":"themes/next/source/css/_common/components/scrollbar.styl","hash":"d7b8bcf2a6031296c84bb4f4ecfb037af01d2d82","modified":1556945164644},{"_id":"themes/next/source/css/_common/components/rainbow.styl","hash":"ce2aae8f3ed8ceac3a2417e0481044cf69c788aa","modified":1556945164644},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"6d900b4159eeb869196a619602578bf4d83a117b","modified":1556945164656},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"7e51ea64611ab5d678c112b4688d4db4fd2737e2","modified":1556945164655},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"a280a583b7615e939aaddbf778f5c108ef8a2a6c","modified":1556945164657},{"_id":"themes/next/source/css/_common/scaffolding/helpers.styl","hash":"8e0740a9ad349ce5555122325da872923135a698","modified":1556945164656},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"7ffde343bdf10add1f052f3c4308a15180eb4404","modified":1556945164657},{"_id":"themes/next/source/css/_common/scaffolding/mobile.styl","hash":"9a190ef2f49bdbf69604b48ad1dc7197895ee9b6","modified":1556945164656},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"33456264a74d1bba38264d14713544d67d003733","modified":1556945164657},{"_id":"themes/next/source/css/_schemes/Mist/_base.styl","hash":"0bef9f0dc134215bc4d0984ba3a16a1a0b6f87ec","modified":1556945164661},{"_id":"themes/next/source/css/_schemes/Mist/_logo.styl","hash":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1556945164662},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"24230e46fc9fb7b8551f97bb36e9bc1f7423098e","modified":1556945164661},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"9a2d298dbdcbfd758518fd74b63897bc80ce15a5","modified":1556945164660},{"_id":"themes/next/source/css/_schemes/Mist/_search.styl","hash":"7359880e8d85312861fe0871f58b662e627dae0c","modified":1556945164663},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"fa33213aceed7bf4bf25437ca9c1a00f7734ae65","modified":1556945164662},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"75d2d92af070eb10273558b2436972d3f12b361c","modified":1556945164662},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"a96e46a6ae86c423f932bc2bc78b9f7453e4e4e5","modified":1556945164663},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"6565b4a309325596768d0d32e022c80ef23066cb","modified":1556945164666},{"_id":"themes/next/source/css/_schemes/Muse/_logo.styl","hash":"fc160583f742c94316a0fee05c18468033173534","modified":1556945164666},{"_id":"themes/next/source/css/_schemes/Muse/_search.styl","hash":"7359880e8d85312861fe0871f58b662e627dae0c","modified":1556945164667},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"1edf4e69d0ec0dc9cefed6c35d3e803e0da4093d","modified":1556945164666},{"_id":"themes/next/source/css/_schemes/Pisces/_brand.styl","hash":"57044a6d19eb418c1c3d28787e82c69efa9e0ca6","modified":1556945164668},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"a0e2030a606c934fb2c5c7373aaae04a1caac4c5","modified":1556945164667},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"75737591682a2bafa71db4c03fb79e970ac0e7aa","modified":1556945164668},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"b6dac5bbf20f090cf4b67d156f030d7170dfb39c","modified":1556945164669},{"_id":"themes/next/source/css/_schemes/Pisces/_sub-menu.styl","hash":"b5b936dddb7b4de4720cd1e8428b30a2f06d63fb","modified":1556945164669},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"232aedbd44243b3b80c4503c947060d3269c1afc","modified":1556945164670},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"6400c98a9fd2b9a8502269f33355bd7ab3ff793b","modified":1556945164669},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1556945164688},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1556945164689},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1556945164690},{"_id":"themes/next/.git/objects/pack/pack-92349ff733280d690f710eef333fd7dff65e00a1.idx","hash":"a9131fa42f728e36ef1816ea8eeeba5538aba9c2","modified":1556945164478},{"_id":"themes/next/source/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1556945164697},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1556945164693},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1556945164694},{"_id":"themes/next/.git/logs/refs/remotes/origin/HEAD","hash":"2510dc7796c565d2bfc2f60edccf9d86d5611faa","modified":1556945164527},{"_id":"themes/next/source/css/_common/components/footer/footer.styl","hash":"4cfeec9434a72d5efc6ca225d3445d084d4590f7","modified":1556945164631},{"_id":"themes/next/source/css/_common/components/header/header.styl","hash":"6c4990d375b640ee4551e62c48c1cbe4c3d62212","modified":1556945164632},{"_id":"themes/next/source/css/_common/components/header/github-banner.styl","hash":"ca97f0b6990eef947039faede80c56d9c4381ee1","modified":1556945164632},{"_id":"themes/next/source/css/_common/components/header/menu.styl","hash":"a410ed529afd46ddf4a96ecf0de6599488716887","modified":1556945164633},{"_id":"themes/next/source/css/_common/components/header/headerband.styl","hash":"d27448f199fc2f9980b601bc22b87f08b5d64dd1","modified":1556945164632},{"_id":"themes/next/source/css/_common/components/header/site-nav.styl","hash":"cc6ee18f47f2e1e06df6fa0eadb37079e580fd11","modified":1556945164633},{"_id":"themes/next/source/css/_common/components/highlight/diff.styl","hash":"71d8d1cc22a2a7627a6db7240f0c4902a14f9bea","modified":1556945164634},{"_id":"themes/next/source/css/_common/components/header/site-meta.styl","hash":"c0d9e18a9210fdcaf33e488518b3b288eb58c0a1","modified":1556945164633},{"_id":"themes/next/source/css/_common/components/pages/archive.styl","hash":"6904fd7ea6455e008d9884558b68254608af9a3c","modified":1556945164635},{"_id":"themes/next/source/css/_common/components/highlight/theme.styl","hash":"b76387934fb6bb75212b23c1a194486892cc495e","modified":1556945164635},{"_id":"themes/next/source/css/_common/components/pages/breadcrumb.styl","hash":"2d142c6f39853916256ad8fc79eb6b85f4001ae8","modified":1556945164635},{"_id":"themes/next/source/css/_common/components/highlight/highlight.styl","hash":"e9dd8de7d98f1478ac7d351624fffd3d8738c905","modified":1556945164634},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"4eff5b252d7b614e500fc7d52c97ce325e57d3ab","modified":1556945164636},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"f1d52954b9a5d1ca8e224382349f525e598dd923","modified":1556945164636},{"_id":"themes/next/source/css/_common/components/pages/post-detail.styl","hash":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1556945164636},{"_id":"themes/next/source/css/_common/components/pages/tag-cloud.styl","hash":"61ca40856e5cacd48e0fa9728fde4605c7dd4c94","modified":1556945164637},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"80addb9b725e329915c05c27b9fadaf56457a9b3","modified":1556945164637},{"_id":"themes/next/source/css/_common/components/post/post-button.styl","hash":"e72a89e0f421444453e149ba32c77a64bd8e44e8","modified":1556945164638},{"_id":"themes/next/source/css/_common/components/post/post-copyright.styl","hash":"2356226157e8068b0e9bbe2f7d0f74e1ab49199b","modified":1556945164639},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"c961d37190d9bec58a36306c7e716c4e72c4582f","modified":1556945164639},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"6a75bb1f2435f4e895cbbb5abbddf6e8f7257804","modified":1556945164638},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"0bf899fab331add63f0c8ead31ca3a3db2ad74d9","modified":1556945164640},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"496f931e3a7e313ba8088fb91bb20789cace72c9","modified":1556945164641},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"1385862a5c0bd845015d165aadbd1a6add7b72d7","modified":1556945164639},{"_id":"themes/next/source/css/_common/components/post/post-meta.styl","hash":"b082d07b13a3d55b4c032fd351dfa9a4fd74edec","modified":1556945164640},{"_id":"themes/next/source/css/_common/components/post/post-reading_progress.styl","hash":"3f33bb862c2aa993f54987fbb345da067b79b112","modified":1556945164641},{"_id":"themes/next/source/css/_common/components/post/post-rtl.styl","hash":"017074ef58166e2d69c53bb7590a0e7a8947a1ed","modified":1556945164642},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"a352ae5b1f8857393bf770d2e638bf15f0c9585d","modified":1556945164642},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"5440013a081201ca791582db98159dce93ea9e75","modified":1556945164641},{"_id":"themes/next/source/css/_common/components/post/post-type.styl","hash":"d5c8ffed7f2c701052b7a53abaf5ef437374ea72","modified":1556945164643},{"_id":"themes/next/source/css/_common/components/post/post-title.styl","hash":"8e058c99dd7d41f0bd34c7c28b6ac9fbb17dcb5e","modified":1556945164642},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"a6c24393dffbdd94dd5c01cdbec5e180b0bfbbbd","modified":1556945164643},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"a3170630d8e085889a4bdc20eb7f09c5a0479c47","modified":1556945164643},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"9224b566cd2632f64c1a964e2c786cee93b93286","modified":1556945164645},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"cc83816614f21c7e1d8d3f867d547ff7c658cec4","modified":1556945164645},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-button.styl","hash":"517d541a80d59ad99a3f648be74891e0c7bc72a8","modified":1556945164646},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"707527c9950a7459355c8abcf4751c0964de0bc1","modified":1556945164645},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-dimmer.styl","hash":"c2d9c3b6fbfa65544e6b5a55d3cb2149df04a8a9","modified":1556945164646},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"9a3bfc878ca797946815bed23cd6f92b24a16358","modified":1556945164646},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"c01609176929590f8f347075a9a12b661acd661e","modified":1556945164647},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"8a24b56524a388fbabd408ffc8ba9b56eb9e01ce","modified":1556945164647},{"_id":"themes/next/source/css/_common/components/sidebar/site-state.styl","hash":"967fb3a3c6c851b34ec5df2d945dc266ed63d146","modified":1556945164648},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar.styl","hash":"8e5c884fb950937afa350c608545455c87aa6129","modified":1556945164648},{"_id":"themes/next/source/css/_common/components/tags/full-image.styl","hash":"6ec8ea7b11a146777b6b8da0f71f0cc1dbd129df","modified":1556945164649},{"_id":"themes/next/source/css/_common/components/tags/blockquote-center.styl","hash":"58ec00eebe68d0eebd2eea435c710063877447df","modified":1556945164648},{"_id":"themes/next/source/css/_common/components/tags/group-pictures.styl","hash":"4851b981020c5cbc354a1af9b831a2dcb3cf9d39","modified":1556945164649},{"_id":"themes/next/source/css/_common/components/tags/label.styl","hash":"d7501ae01fc45fa15b00d1bc5233b9fffa20a3c9","modified":1556945164649},{"_id":"themes/next/source/css/_common/components/tags/tags.styl","hash":"cbc0be5a3285b469858ec9ead48e2ea90bd47ae1","modified":1556945164651},{"_id":"themes/next/source/css/_common/components/tags/pdf.styl","hash":"da8d34729fb6eb0fcb8ee81e67d2be3c02bc1bc4","modified":1556945164650},{"_id":"themes/next/source/css/_common/components/tags/tabs.styl","hash":"fcda60fecff1479adaf6521cf629cda2506337a8","modified":1556945164651},{"_id":"themes/next/source/css/_common/components/third-party/gitalk.styl","hash":"ac7753d536341aa824d7bce0332735e838916995","modified":1556945164652},{"_id":"themes/next/source/css/_common/components/tags/note.styl","hash":"21b32840d8b3a14b10770153114778304ba6d1b0","modified":1556945164650},{"_id":"themes/next/source/css/_common/components/third-party/algolia-search.styl","hash":"fc58498d4f5081fcf6218e9e18c5bf2328275bef","modified":1556945164651},{"_id":"themes/next/source/css/_common/components/third-party/gitment.styl","hash":"f1d9ee1f86a179741f2478f8c70ca11ab578810e","modified":1556945164652},{"_id":"themes/next/source/css/_common/components/third-party/copy-code.styl","hash":"688ca3eccc26727d050ad098b32b40934719588a","modified":1556945164652},{"_id":"themes/next/source/css/_common/components/third-party/han.styl","hash":"7059e24235b7c57a07f3f8abaa06b0bd6a7eda2f","modified":1556945164653},{"_id":"themes/next/source/css/_common/components/third-party/math.styl","hash":"ef66c0a08e4243a25e41408d70ca66682b8dcea1","modified":1556945164654},{"_id":"themes/next/source/css/_common/components/third-party/localsearch.styl","hash":"9fac89c8146eb2675721a26f528d7d0f8be7debe","modified":1556945164653},{"_id":"themes/next/source/css/_common/components/third-party/needsharebutton.styl","hash":"61466e3e5459960b5802a267751a0c8018918b0b","modified":1556945164654},{"_id":"themes/next/source/css/_common/components/third-party/related-posts.styl","hash":"3ae3f3c276d444862033fd3434c632ad0d2f84e6","modified":1556945164654},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"03c4fa9573fddd930552784cf484fd2ee7825323","modified":1556945164654},{"_id":"themes/next/source/css/_schemes/Mist/outline/outline.styl","hash":"5dc4859c66305f871e56cba78f64bfe3bf1b5f01","modified":1556945164664},{"_id":"themes/next/source/css/_schemes/Mist/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1556945164664},{"_id":"themes/next/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1556945164667},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1556945164692},{"_id":"themes/next/.git/objects/pack/pack-92349ff733280d690f710eef333fd7dff65e00a1.pack","hash":"1414bfa9f2eead4de9d8496f4283ac6f13a11035","modified":1556945164479},{"_id":"themes/cafe/.bowerrc","hash":"09b4947b6c6f8e300f4927b96a487f16f02d702a","modified":1572083947088},{"_id":"themes/cafe/.gitignore","hash":"63963cef8fc919257215ff980c3c34b7b0951754","modified":1572083947088},{"_id":"themes/cafe/README.md","hash":"7a338b1c256c07955989882333d82dc5349680de","modified":1572083947089},{"_id":"themes/cafe/README_en.md","hash":"a346042e7d7d4205bae48e86c894969d08485be6","modified":1572083947089},{"_id":"themes/cafe/_config.yml","hash":"61141292ff97ceb34327ea3066b4247cd6526023","modified":1572083947090},{"_id":"themes/cafe/bower.json","hash":"06dc924ce808e3363bb31eddc023433ea588a30d","modified":1572083947127},{"_id":"themes/cafe/cafe-qrcode.png","hash":"4fef2c889376a208a49aa92c582b147e7e005d23","modified":1572083947127},{"_id":"themes/cafe/package.json","hash":"81290c217cc42ded73ddf637c865b664a4aed53c","modified":1572083947164},{"_id":"themes/cafe/webpack.config.js","hash":"ad9a245e554affab9d5fc46c753c1978bdd4e640","modified":1572083947223},{"_id":"themes/cafe/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1572083947061},{"_id":"themes/cafe/.git/config","hash":"014c619e4e6b6f112d7155175bc2fc354362c42e","modified":1572083947070},{"_id":"themes/cafe/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1572083927716},{"_id":"themes/cafe/.git/index","hash":"39bf6d453964989b507c294c460a10a56f5df7d2","modified":1572083947225},{"_id":"themes/cafe/.git/packed-refs","hash":"0708400921340a87eedd4f8551bf9b511d75896f","modified":1572083947049},{"_id":"themes/cafe/assets/duoshuo_comment.png","hash":"33402149f82b66ff4ed405f44beb06eb0172b6de","modified":1572083947092},{"_id":"themes/cafe/assets/share.png","hash":"823926d9cb8985ceb93a119ef138f9638a8ead1a","modified":1572083947126},{"_id":"themes/cafe/languages/default.yml","hash":"fa29b6eaff7c2adb38586748e35487294323ed7d","modified":1572083947128},{"_id":"themes/cafe/languages/en.yml","hash":"1fe9eaf256639fea43c30790129276a5d557db36","modified":1572083947128},{"_id":"themes/cafe/languages/nl.yml","hash":"eac2a6928ea9bf65c44a5cb7c620b1103f066558","modified":1572083947129},{"_id":"themes/cafe/languages/no.yml","hash":"b3d1684075aa7178f59cb1ac6e9cb5f7664b797b","modified":1572083947129},{"_id":"themes/cafe/languages/ru.yml","hash":"1db37462baa63725618bf45a1357b960df89c20d","modified":1572083947130},{"_id":"themes/cafe/languages/zh-CN.yml","hash":"00bd1677cd9ad8b3581ec54260ac7096c32049a3","modified":1572083947130},{"_id":"themes/cafe/languages/zh-TW.yml","hash":"de2bb429c3c75ce89321b233a04e0237466dbf49","modified":1572083947131},{"_id":"themes/cafe/layout/archive.ejs","hash":"11912b8e50dafbe9b0a65df0beaeab64fde90abe","modified":1572083947157},{"_id":"themes/cafe/layout/category.ejs","hash":"f46e99e5b68c2ee67bdab068b1da4029bc09847d","modified":1572083947158},{"_id":"themes/cafe/layout/index.ejs","hash":"aa1b4456907bdb43e629be3931547e2d29ac58c8","modified":1572083947158},{"_id":"themes/cafe/layout/layout.ejs","hash":"38f0162183c1714924063ecab4ba3d64d98090a9","modified":1572083947159},{"_id":"themes/cafe/layout/page.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1572083947159},{"_id":"themes/cafe/layout/post.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1572083947163},{"_id":"themes/cafe/layout/tag.ejs","hash":"4349f382b07603f9d2c03dd4df70ddea9b9a035c","modified":1572083947163},{"_id":"themes/cafe/scripts/extend.generator.js","hash":"adf14a21221a8b9667f6ea1d1f6ad6fb28eb5d74","modified":1572083947165},{"_id":"themes/cafe/scripts/fancybox.js","hash":"dd6c9e7cf9019a001eef26d58357e768584107cd","modified":1572083947165},{"_id":"themes/cafe/source/favicon.ico","hash":"96b9a549337c2bec483c2879eeafa4d1f8748fed","modified":1572083947217},{"_id":"themes/cafe/layout/_scripts/index.ejs","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1572083947145},{"_id":"themes/cafe/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1572083927717},{"_id":"themes/cafe/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1572083927719},{"_id":"themes/cafe/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1572083927720},{"_id":"themes/cafe/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1572083927721},{"_id":"themes/cafe/.git/hooks/pre-commit.sample","hash":"36aed8976dcc08b5076844f0ec645b18bc37758f","modified":1572083927722},{"_id":"themes/cafe/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1572083927724},{"_id":"themes/cafe/.git/hooks/pre-rebase.sample","hash":"5885a56ab4fca8075a05a562d005e922cde9853b","modified":1572083927725},{"_id":"themes/cafe/.git/hooks/prepare-commit-msg.sample","hash":"2b6275eda365cad50d167fe3a387c9bc9fedd54f","modified":1572083927727},{"_id":"themes/cafe/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1572083927728},{"_id":"themes/cafe/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1572083927730},{"_id":"themes/cafe/.git/logs/HEAD","hash":"a6c60ca327559d8f6e15416a2c0e74a5ea45cb58","modified":1572083947067},{"_id":"themes/cafe/layout/_partial/after-footer.ejs","hash":"7cb13c479a5eff78d96a90ab2ca7dc4d31907ca8","modified":1572083947133},{"_id":"themes/cafe/layout/_partial/archive-post.ejs","hash":"d4c33584464f238acc5c3bdb4698d7399f9638a8","modified":1572083947133},{"_id":"themes/cafe/layout/_partial/archive.ejs","hash":"fbf0ab448b94fa2064ef809601d51eaa4f497236","modified":1572083947134},{"_id":"themes/cafe/layout/_partial/article.ejs","hash":"0dca4c13e9702bef3a40abb4948fccc6812958d8","modified":1572083947135},{"_id":"themes/cafe/layout/_partial/comments.ejs","hash":"84b80c47ce52bdf103dda0f2559df4a6223b5183","modified":1572083947135},{"_id":"themes/cafe/layout/_partial/footer.ejs","hash":"a1627a239dc8c4c8864ad611d0b7d53dede33e1d","modified":1572083947136},{"_id":"themes/cafe/layout/_partial/google-analytics.ejs","hash":"1ccc627d7697e68fddc367c73ac09920457e5b35","modified":1572083947136},{"_id":"themes/cafe/layout/_partial/header.ejs","hash":"28d3e43eb3fd6dcdc0d273aaa063bd200be58e4c","modified":1572083947138},{"_id":"themes/cafe/layout/_partial/head.ejs","hash":"20b6b18d1e0d6ec14ba558208fe7f36ec2dff0e9","modified":1572083947137},{"_id":"themes/cafe/layout/_partial/mobile-nav.ejs","hash":"347cf1befd2ea637c24bd5901929d8e36e359e75","modified":1572083947138},{"_id":"themes/cafe/layout/_partial/random_posts.ejs","hash":"40e651a0b85eaafc6351bee2c776c9dc53562a77","modified":1572083947144},{"_id":"themes/cafe/layout/_partial/sidebar.ejs","hash":"7dad154b4d825845c739d0105b7e3773d0cf8822","modified":1572083947144},{"_id":"themes/cafe/layout/_partial/widget.ejs","hash":"da7939823193ada87f2f873c7ed3213430000645","modified":1572083947145},{"_id":"themes/cafe/layout/_third-part/index.ejs","hash":"a44b02c9fdeb63e130dc789a3fd7c9d4a413b370","modified":1572083947151},{"_id":"themes/cafe/layout/_widget/archive.ejs","hash":"16b4f2c9e92c61c9b0ba4355f331ef43a1da69f0","modified":1572083947152},{"_id":"themes/cafe/layout/_widget/category.ejs","hash":"d2a14d884080efddf2c4f3b0829d33b4fba46595","modified":1572083947153},{"_id":"themes/cafe/layout/_widget/friendly_link.ejs","hash":"bf3f3542894fc952819821233a071735c74012af","modified":1572083947153},{"_id":"themes/cafe/layout/_widget/hot_comment_posts.ejs","hash":"85e643a3b3df886f84488c6fac1a81bb8abf9091","modified":1572083947153},{"_id":"themes/cafe/layout/_widget/lastest_comments.ejs","hash":"170a773c94b99f653d3cb1fb968fb9715b78a88d","modified":1572083947154},{"_id":"themes/cafe/layout/_widget/post_content.ejs","hash":"94bfe5713747e2f91d036549460220aa7d3b6a5b","modified":1572083947154},{"_id":"themes/cafe/layout/_widget/recent_posts.ejs","hash":"35ad60dbcdf5ba099a6cd7d61b4addb64023ceeb","modified":1572083947155},{"_id":"themes/cafe/layout/_widget/social.ejs","hash":"23e3d73d52a1a9759b8c7800641e96022e2cb84f","modified":1572083947155},{"_id":"themes/cafe/layout/_widget/tag.ejs","hash":"51c3bcba8815677fc09919857205e48038fb0fef","modified":1572083947156},{"_id":"themes/cafe/layout/_widget/tagcloud.ejs","hash":"28b18597ff7132c0c2b22b89a1e1fd4f3c31292c","modified":1572083947156},{"_id":"themes/cafe/layout/_widget/wechat.ejs","hash":"200f8e54879b7116e45f82c9a8118ef7df2417e6","modified":1572083947157},{"_id":"themes/cafe/layout/partials/back2top.ejs","hash":"7962c3bd00150d577c0a16c695557aa3690e394e","modified":1572083947160},{"_id":"themes/cafe/layout/partials/hot-comment-posts.ejs","hash":"2829226af9640dbb98e49e4349460baf7ec1f77b","modified":1572083947161},{"_id":"themes/cafe/layout/partials/lastest-comments.ejs","hash":"a49dc7faa2316783b836a8b227ff677bf43f5c7d","modified":1572083947161},{"_id":"themes/cafe/layout/partials/recent-posts.ejs","hash":"72f76ca49eb9640054a32725ef462e8085e1ca43","modified":1572083947162},{"_id":"themes/cafe/layout/partials/pagination.ejs","hash":"7c4780ee5b9dad0a46c5caf422965bdcb1dc3664","modified":1572083947162},{"_id":"themes/cafe/source/_data/themes.yml","hash":"51a446e543e5ab821905351baa1edbfdc59826ab","modified":1572083947167},{"_id":"themes/cafe/source/css/_extend.styl","hash":"cf7f7bf06ade097d841019e901c64ea5fcbf622f","modified":1572083947168},{"_id":"themes/cafe/source/css/_variables.styl","hash":"1f4d6146611009bd78e981b5be6fdf84197a35f8","modified":1572083947180},{"_id":"themes/cafe/source/css/style.styl","hash":"2ef9f14cb66a8be749ca1d95242396994b64e889","modified":1572083947204},{"_id":"themes/cafe/source/fancybox/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1572083947207},{"_id":"themes/cafe/source/fancybox/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1572083947208},{"_id":"themes/cafe/source/fancybox/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1572083947208},{"_id":"themes/cafe/source/fancybox/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1572083947209},{"_id":"themes/cafe/source/fancybox/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1572083947209},{"_id":"themes/cafe/source/fancybox/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1572083947210},{"_id":"themes/cafe/source/fancybox/jquery.fancybox.css","hash":"2e54d51d21e68ebc4bb870f6e57d3bfb660d4f9c","modified":1572083947214},{"_id":"themes/cafe/source/fancybox/jquery.fancybox.js","hash":"58193c802f307ec9bc9e586c0e8a13ebef45d2f8","modified":1572083947215},{"_id":"themes/cafe/source/fancybox/jquery.fancybox.pack.js","hash":"2da892a02778236b64076e5e8802ef0566e1d9e8","modified":1572083947216},{"_id":"themes/cafe/source/images/fly-to-top.png","hash":"f189038da3c68a8012e924185a1faee98bde3003","modified":1572083947217},{"_id":"themes/cafe/source/js/elevator.js","hash":"e97932b797d4315fe5586d7538db513f18169956","modified":1572083947220},{"_id":"themes/cafe/source/js/is.js","hash":"7e5820c0d5c688eb257ca436f583cb1762f986d4","modified":1572083947221},{"_id":"themes/cafe/source/js/script.js","hash":"4f8175622792da79b3b1fded60f5e15aa0bb067b","modified":1572083947221},{"_id":"themes/cafe/source/duoshuo/embed.js","hash":"f63d86822d86d2154b065d12303c4a889c40664d","modified":1572083947206},{"_id":"themes/cafe/source/jquery/jquery.min.js","hash":"745ab5d6e434cf8d321779da3c527b6d301e2b50","modified":1572083947219},{"_id":"themes/cafe/.git/refs/heads/master","hash":"ee5fcaedadc36a3fc117d11645d9f896d0295bd1","modified":1572083947064},{"_id":"themes/cafe/layout/_partial/post/category.ejs","hash":"16128d2422645e18d1b6882d4c4df17d895bd76e","modified":1572083947139},{"_id":"themes/cafe/layout/_partial/post/date.ejs","hash":"947f513f7a85fbcf085624e46dc2ae6de8185eec","modified":1572083947140},{"_id":"themes/cafe/layout/_partial/post/duoshuo.ejs","hash":"467563b555d584b7b9de85a543445ff35c3157f9","modified":1572083947141},{"_id":"themes/cafe/layout/_partial/post/gallery.ejs","hash":"b0bf3f5d923c261ca2b5fabab513f1ec2708c8ca","modified":1572083947141},{"_id":"themes/cafe/layout/_partial/post/nav.ejs","hash":"cbb3819ce512bd24db8bad41b8617d46eba82fdc","modified":1572083947142},{"_id":"themes/cafe/layout/_partial/post/tag.ejs","hash":"694b5101bcc44c9f9c1cc62e5ad2fdfb4b7c7a07","modified":1572083947142},{"_id":"themes/cafe/layout/_partial/post/title.ejs","hash":"d4a460a35e2112d0c7414fd5e19b3a16093f1caf","modified":1572083947143},{"_id":"themes/cafe/layout/_third-part/comments/changyan.ejs","hash":"1c94583c27c972e9e5161a453d96c5bb377bf21e","modified":1572083947147},{"_id":"themes/cafe/layout/_third-part/comments/disqus.ejs","hash":"3bd41bc585b46d7e14f4abfe1fd130950e88e1e4","modified":1572083947148},{"_id":"themes/cafe/layout/_third-part/comments/duoshuo.ejs","hash":"50a681fe3a30e6c42b91fd9beea8ea23f8328cee","modified":1572083947148},{"_id":"themes/cafe/layout/_third-part/comments/gentie.ejs","hash":"eeaee1a1c958c6c4b1fb066b9e1b7cada9a9471d","modified":1572083947149},{"_id":"themes/cafe/layout/_third-part/comments/gitment.ejs","hash":"25c71114ff0ede012d2dcb72cfb4e821f1744634","modified":1572083947149},{"_id":"themes/cafe/layout/_third-part/comments/index.ejs","hash":"9a358fa1d7c965a054e2fb4fc0ed32d0472518bc","modified":1572083947150},{"_id":"themes/cafe/layout/_third-part/comments/youyan.ejs","hash":"40a49f44f934711d2f37e23827d60822305e1f2d","modified":1572083947150},{"_id":"themes/cafe/layout/_third-part/mathjax/index.ejs","hash":"c4c3995ef543c1295dc9a619582b98b2857d0ca1","modified":1572083947152},{"_id":"themes/cafe/source/css/_partial/article.styl","hash":"37ce987f08ba6bc6af42d838536bc90f07ad48fa","modified":1572083947170},{"_id":"themes/cafe/source/css/_partial/archive.styl","hash":"77197dd5240eb0a4d77daf7bd977858ae83eda68","modified":1572083947169},{"_id":"themes/cafe/source/css/_partial/comment.styl","hash":"d43ee49803bfe4d718fcf69921169b68f2cd994f","modified":1572083947170},{"_id":"themes/cafe/source/css/_partial/custom.styl","hash":"f162ddfa65c268d79425e8c143688481f559ad2c","modified":1572083947171},{"_id":"themes/cafe/source/css/_partial/duoshuo.styl","hash":"6c9ac4fae2a2d8afedd63f5a8c95b1942cbd59b0","modified":1572083947171},{"_id":"themes/cafe/source/css/_partial/footer.styl","hash":"27a0d5b8bd34319fdb4d066859753c9dac0bdf26","modified":1572083947172},{"_id":"themes/cafe/source/css/_partial/header.styl","hash":"ea3d77cfcc7244a737eea2bf1017e0c6abe69be3","modified":1572083947173},{"_id":"themes/cafe/source/css/_partial/highlight.styl","hash":"acaf6574b14afcac8e54b4f868f514e4339be509","modified":1572083947173},{"_id":"themes/cafe/source/css/_partial/mobile.styl","hash":"680c7b809b62cd3ad294e822793fbd0b1a32cc33","modified":1572083947174},{"_id":"themes/cafe/source/css/_partial/other.styl","hash":"cc89dc51b9a6fb12a4d38b7c591e022ab767fcc1","modified":1572083947175},{"_id":"themes/cafe/source/css/_partial/random-post.styl","hash":"4fd4efb828bdcd01d3c3047ca2c5983eeabb9a43","modified":1572083947176},{"_id":"themes/cafe/source/css/_partial/sidebar-aside.styl","hash":"935e66df775d2f855f15587d9e3891f1ed54bc27","modified":1572083947176},{"_id":"themes/cafe/source/css/_partial/sidebar-bottom.styl","hash":"4132e25ba9680c4b911a01abc75f501cda3fa4f1","modified":1572083947177},{"_id":"themes/cafe/source/css/_partial/sidebar.styl","hash":"6180892f6fc4d152bbf74664bbdaa7c87cdc6ba2","modified":1572083947177},{"_id":"themes/cafe/source/css/_partial/social.styl","hash":"814e011e94b0f2e4f7583d58c6ca8a745009f2e4","modified":1572083947178},{"_id":"themes/cafe/source/css/_util/grid.styl","hash":"1aa883ab432d9e4139c89dcbd40ae2bd1528d029","modified":1572083947179},{"_id":"themes/cafe/source/css/_util/mixin.styl","hash":"429bad87fc156eacf226c5e35b0eafc277f2504b","modified":1572083947180},{"_id":"themes/cafe/source/fancybox/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1572083947211},{"_id":"themes/cafe/source/fancybox/helpers/jquery.fancybox-buttons.css","hash":"6394c48092085788a8c0ef72670b0652006231a1","modified":1572083947212},{"_id":"themes/cafe/source/fancybox/helpers/jquery.fancybox-buttons.js","hash":"4c9c395d705d22af7da06870d18f434e2a2eeaf9","modified":1572083947212},{"_id":"themes/cafe/source/fancybox/helpers/jquery.fancybox-media.js","hash":"e14c32cc6823b81b2f758512f13ed8eb9ef2b454","modified":1572083947213},{"_id":"themes/cafe/source/fancybox/helpers/jquery.fancybox-thumbs.css","hash":"b88b589f5f1aa1b3d87cc7eef34c281ff749b1ae","modified":1572083947213},{"_id":"themes/cafe/source/fancybox/helpers/jquery.fancybox-thumbs.js","hash":"83cdfea43632b613771691a11f56f99d85fb6dbd","modified":1572083947214},{"_id":"themes/cafe/source/themes/screenshots/Cafe.png","hash":"6f639068117b8d44005730864cc0b05a11b28d73","modified":1572083947223},{"_id":"themes/cafe/.git/objects/pack/pack-ad84050cebd9ba6df16bca29d4b1bb200ff6e56e.idx","hash":"83819fbbade756a05b79e6ec1556eed92c9eea26","modified":1572083946952},{"_id":"themes/cafe/source/css/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1572083947198},{"_id":"themes/cafe/source/css/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1572083947199},{"_id":"themes/cafe/.git/logs/refs/heads/master","hash":"a6c60ca327559d8f6e15416a2c0e74a5ea45cb58","modified":1572083947066},{"_id":"themes/cafe/.git/refs/remotes/origin/HEAD","hash":"d9427cda09aba1cdde5c69c2b13c905bddb0bc51","modified":1572083947058},{"_id":"themes/cafe/source/css/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1572083947184},{"_id":"themes/cafe/source/css/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1572083947188},{"_id":"themes/cafe/source/css/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1572083947197},{"_id":"themes/cafe/source/css/images/banner.jpg","hash":"f44aa591089fcb3ec79770a1e102fd3289a7c6a6","modified":1572083947203},{"_id":"themes/cafe/.git/logs/refs/remotes/origin/HEAD","hash":"a6c60ca327559d8f6e15416a2c0e74a5ea45cb58","modified":1572083947058},{"_id":"themes/cafe/source/css/fonts/fontawesome-webfont.svg","hash":"b5483b11f8ba213e733b5b8af9927a04fec996f6","modified":1572083947193},{"_id":"themes/cafe/assets/pc-display.gif","hash":"fb84eb2ba958b1e02ad5e178a6f367a561cd9252","modified":1572083947126},{"_id":"themes/cafe/assets/mobie-display.gif","hash":"d20f7aa46d9bf618ba1ebaf9b6bda71b030f0ce9","modified":1572083947118},{"_id":"themes/cafe/.git/objects/pack/pack-ad84050cebd9ba6df16bca29d4b1bb200ff6e56e.pack","hash":"f0307ba763379d03d8a1f47cda0e5481f3511e48","modified":1572083946945}],"Category":[{"name":"使用技巧总结记录","_id":"ck27dih1s0004mskp4sxdzq80"},{"name":"Tools","_id":"ck27dih240009mskpae6wa7gy"},{"name":"服务器","_id":"ck27dih2d000hmskpwzld4efq"},{"name":"Lesson-Learned","_id":"ck27dih2h000mmskpxdx4ns7g"}],"Data":[],"Page":[{"title":"关于我","date":"2019-05-04T14:07:28.000Z","_content":"","source":"about/index.md","raw":"---\ntitle: 关于我\ndate: 2019-05-04 22:07:28\n---\n","updated":"2019-05-04T14:09:53.430Z","path":"about/index.html","comments":1,"layout":"page","_id":"ck27dih1g0001mskpjywxr2ak","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"文章标签","date":"2019-05-04T06:40:23.000Z","type":"tags","comments":0,"_content":"","source":"tags/index.md","raw":"---\ntitle: 文章标签\ndate: 2019-05-04 14:40:23\ntype: \"tags\"\ncomments: false\n---\n","updated":"2019-05-04T06:42:33.497Z","path":"tags/index.html","layout":"page","_id":"ck27dih1o0003mskper5lv1tz","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"分类汇总","date":"2019-05-04T06:19:33.000Z","type":"categories","comments":0,"_content":"","source":"categories/index.md","raw":"---\ntitle: 分类汇总\ndate: 2019-05-04 14:19:33\ntype: \"categories\"\ncomments: false\n---\n","updated":"2019-05-04T06:41:59.090Z","path":"categories/index.html","layout":"page","_id":"ck27diheo000wmskpf047ss16","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""}],"Post":[{"title":"Hexo使用方法记录","date":"2019-05-04T06:15:23.000Z","toc_number":false,"_content":"\n\n\n利用Hexo和GitHub Page构建个人博客网站\n\n<!-- more -->\n\n\n\n## 1. 创建项目\n\n```bash\n$ npm install hexo-cli -g\n$ hexo init blog\n$ cd blog\n$ npm install\n$ hexo server\n```\n\n## 2. 设置主题风格\n\n### 2-1. 设置主题步骤\n\n* 1. 下载主题\n* 2. 将下载好的主题文件夹，粘贴到站点目录的themes下。\n* 3. 更改**站点配置文件**_config.yml 的theme字段，为主题文件夹的名称：\n\n```yml\n# Extensions\n## Plugins: https://hexo.io/plugins/\n## Themes: https://hexo.io/themes/\ntheme: next\n```\n\n注意在 Hexo 中有两份主要的配置文件，其名称都是 _config.yml\n\n* 站点配置文件，位于站点根目录下，主要包含 Hexo 本身的配置\n\n* 主题配置文件，位于主题目录下，主要用于配置主题相关的选项\n\n### 2-2. 设置主题语言\n\n* 检查\\themes\\next\\languages文件夹下语言的yml文件，如中文对应的是zh-CN.yml，英文对应的是en.yml\n* 将站点配置文件中language设置为对应的值, 如简体中文设置为language: zh-CN\n\n### 2-3. 设置主题风格\n\n修改**主题配置文件**中scheme项，目前 NexT 支持三种 Scheme，他们是：\n\n- Muse - 默认 Scheme，这是 NexT 最初的版本，黑白主调，大量留白\n- Mist - Muse 的紧凑版本，整洁有序的单栏外观\n- Pisces - 双栏 Scheme，小家碧玉似的清新\n\n```yml\n# ---------------------------------------------------------------\n# Scheme Settings\n# ---------------------------------------------------------------\n\n# Schemes\n# scheme: Muse\n#scheme: Mist\n#scheme: Pisces\nscheme: Gemini\n```\n### 2-4. 设置菜单-menu\n\n#### 2-4-1. 增加菜单项\n\n修改**主题配置**文件中menu项，菜单配置包括三个部分，第一是菜单项（名称和链接），第二是菜单项的显示文本，第三是菜单项对应的图标。 NexT 使用的是Font Awesome提供的图标\n\n```yml\n# ---------------------------------------------------------------\n# Menu Settings\n# ---------------------------------------------------------------\n\n# When running the site in a subdirectory (e.g. domain.tld/blog), remove the leading slash from link value (/archives -> archives).\n# Usage: `Key: /link/ || icon`\n# Key is the name of menu item. If the translation for this item is available, the translated text will be loaded, otherwise the Key name will be used. Key is case-senstive.\n# Value before `||` delimeter is the target link.\n# Value after `||` delimeter is the name of FontAwesome icon. If icon (with or without delimeter) is not specified, question icon will be loaded.\n# External url should start with http:// or https://\nmenu:\n  首页: / || home\n  归档: /archives/ || archive\n  分类: /categories/ || th\n  标签: /tags/ || tags\n  关于: /about/ || user\n```\n\n#### 2-4-2. categories页面创建\n\n\n* 1. 新建一个页面，命名为categories\n\n```javascript\nhexo new page categories\n```\n\n这时在source目录下会生成一个名为categories的文件夹, 在该文件夹下有一个名为index.md的文件\n\n* 2. 编辑categories文件夹下的index.md\n\n将页面的type设置为 categories ，主题将自动为这个页面显示所有分类\n\n```javascript\n---\ntitle: 分类\ndate: 2019-02-15 22:10:42\ntype: \"categories\"\ncomments: false\n---\n\n```\n\n注意：如果有启用多说 或者 Disqus 评论，默认页面也会带有评论。需要关闭的话，请添加字段 comments 并将值设置为 false\n\n* 3. 在菜单中添加链接, 编辑主题的 _config.yml\n\n在文章中加入`category: \"博客操作\"`即可自动添加到分类。如下所示\n\n```javascript\n---\ntitle: 个人博客操作笔记\nauthor: Hyman Hu\ncategory: \"博客操作\"\ntags: \"Hexo\"\n---\n```\n\n### 2-5. 设置侧栏-sidebar\n\n修改**主题配置**文件中sidebar项\n\n另：\n有时候写文章, 我们会习惯性地加上编号, 有时候又不想加上编号, 这个时候就需要自定义是否显示编号了。\n只要在不需要加编号的文章的front-matter加上 toc_number: false即可\n\n```yml\n# Table Of Contents in the Sidebar\ntoc:\n  enable: true\n  # Automatically add list number to toc.\n  number: true\n  # If true, all words will placed on next lines if header width longer then sidebar width.\n  wrap: false\n  # If true, all level of TOC in a post will be displayed, rather than the activated part of it.\n  expand_all: false\n  # Maximum heading depth of generated toc. You can set it in one post through `toc_max_depth` in Front-matter.\n  max_depth: 6\n```\n\n### 2-6. 设置头像\n\n修改**主题配置**文件中avatar项\n\n### 2-7. 其他\n\n* 1. 增加字数统计及阅读时长\n\n```shell\n# 安装插件\nnpm install hexo-symbols-count-time --save\n```\n\n修改**站点配置**文件(没有则新增)\n\n```yml\n# 增加字数和时间\nsymbols_count_time:\n #文章内是否显示\n  symbols: true\n  time: true\n # 网页底部是否显示\n  total_symbols: true\n  total_time: true\n  exclude_codeblock: false\n```\n\n修改**主题配置**文件\n\n```yml\n# Post wordcount display settings\n# Dependencies: https://github.com/theme-next/hexo-symbols-count-time\nsymbols_count_time:\n  separated_meta: true\n  #文章中的显示是否显示文字（本文字数|阅读时长）\n  item_text_post: true\n  #网页底部的显示是否显示文字（站点总字数|站点阅读时长） \n  item_text_total: false\n  # Average Word Length (chars count in word)\n  awl: 4\n  # Words Per Minute\n  wpm: 275\n  suffix: mins.\n```\n\n\n\n* 2. 网页底部信息隐藏，只需要把 主题配置文件的相关数据改为false就行\n\n```yml\nfooter:\n  # Specify the date when the site was setup. If not defined, current year will be used.\n  #since: 2015\n\n  # Icon between year and copyright info.\n  icon:\n    # Icon name in fontawesome, see: https://fontawesome.com/v4.7.0/icons/\n    # `heart` is recommended with animation in red (#ff0000).\n    name: user\n    # If you want to animate the icon, set it to true.\n    animated: false\n    # Change the color of icon, using Hex Code.\n    color: \"#808080\"\n\n  # If not defined, `author` from Hexo main config will be used.\n  copyright:\n\n  powered:\n    # Hexo link (Powered by Hexo).\n    enable: false\n    # Version info of Hexo after Hexo link (vX.X.X).\n    version: false\n\n  theme:\n    # Theme & scheme info link (Theme - NexT.scheme).\n    enable: false\n    # Version info of NexT after scheme info (vX.X.X).\n    version: false\n\n  # Beian icp information for Chinese users. In China, every legal website should have a beian icp in website footer.\n  # http://www.beian.miit.gov.cn\n  beian:\n    enable: false\n    icp:\n\n  # Any custom text can be defined here.\n  #custom_text: Hosted by <a href=\"https://pages.coding.me\" class=\"theme-link\" rel=\"noopener\" target=\"_blank\">Coding Pages</a>\n```\n\n* 3. 增加更新时间\n\n修改**主题配置**文件\n\n```yml\n# Post meta display settings\npost_meta:\n  item_text: true\n  created_at: true\n  updated_at:\n    enable: true\n    another_day: true\n  categories: true\n```\n\n写文章的时候可以直接在文章开头设置更新时间updated: 2019-05-04 12:00:00(注意格式)。没有这参数的话将会显示md文件的修改日期\n\n* 4.  增加阅读次数\n\n修改**主题配置文件**\n\n```yml\n# Show Views / Visitors of the website / page with busuanzi.\n# Get more information on http://ibruce.info/2015/04/04/busuanzi\nbusuanzi_count:\n  enable: true\n  total_visitors: true\n  total_visitors_icon: user\n  total_views: true\n  total_views_icon: eye\n  post_views: true\n  post_views_icon: eye\n```\n\n* 主页只显示摘要，点击查看更多才能看全文\n\n```xml\n摘要\n<!-- more -->\n正文\n```\n\n\n\n\n\n\n## 3. 基本操作\n\n### 3-1. 新建文章\n\n``` bash\n$ hexo new \"My New Post\"\n$ hexo n <title>\n```\n\n### 3-2. 启动服务\n``` bash\n$ hexo server\n$ hexo s\n```\n\n### 3-3. 生成静态文件\n``` bash\n$ hexo generate\n$ hexo g\n```\n\n### 3-4. 部署到服务器\n``` bash\n$ hexo deploy\n$ hexo d\n```\n\n### 3-5. 其他命令\n\n``` bash\n# 清除缓存文件 (db.json) 和已生成的静态文件 (public)\n$ hexo clean\n\n# 列出网站资料\n$ hexo list <type>\n\n# 显示hexo版本\n$ hexo version\n\n# 显示草稿\n$ hexo draft\n```\n\n\n\n## 4. 官方文档\n\n### 4-1. 写作\n\n```javascript\nhexo new [layout] <title>\n```\n\n* 1. 布局\n文章布局layout，默认post，可以通过修改_config.yml中的`default_layout`来指定默认布局\nHexo有三种默认布局: post(source/_posts_), page(source), draft(source/_draft_)。 自定义的布局，存储到_post文件夹中\n\n* 2. 文件名\nHexo 默认以标题做为文件名称。可修改**站点配置文件**_config.yml中`new_post_name`修改文件名，如：`:year-:month-:day-:title.md`\n\n* 3. 草稿\n发布草稿命令\n```javascript\nhexo publish [layout] <title>\n```\n\n* 4. 模板\n使用模板命令\n```javascript\nhexo new photo <title>\n```\n在执行这行指令时，Hexo 会尝试在 scaffolds 文件夹中寻找 photo.md\n\n* 5. 文章头文件格式\n\n| 参数 | 描述 | 默认值 |\n| :---: | :---: | :---: |\n| layout | 布局 | post |\n| title | 标题 |  |\n| date | 建立日期 | 文件建立日期 |\n| updated | 更新日期 | 文件更新日期 |\n| comments | 开启文章评论功能 | true |\n| tags | 标签 |  |\n| category | 分类 |  |\n| permalink | 覆盖文章网址 |  |\n\n注：分类具有顺序性和层次性；而标签没有顺序和层次。\n\n```bash\ncategories:\n- Diary\n- Life\n```\n会使分类Life成为Diary的子分类，而不是并列分类。因此，有必要为您的文章选择尽可能准确的分类。\n\n### 4-2. [插入引用](https://hexo.io/zh-cn/docs/tag-plugins)\n\n* 1. 引用块\n\n语法：\n```bash\n{% blockquote [author[, source]] [link] [source_link_title] %}\ncontent\n{% endblockquote %}\n```\n* 2. 代码块\n\n语法：\n```bash\n{% codeblock [title] [lang:language] [url] [link text] %}\ncode snippet\n{% endcodeblock %}\n```\n\n另一种形式的代码块，不同的是它使用三个反引号来包裹。\n\n```bash\n​``` [language] [title] [url] [link text] code snippet \n```\n\n\n\n\n\n\n### 4-3. 插入图片\n\n* 1. 设置站点配置_config.yml\n\n```bash\npost_asset_folder: true\n```\n\n* 2. 安装插件\n```bash\nnpm install hexo-asset-image -- save\n```\n\n下次新建文章时，除了生成.md文件外还生成一个同名文件\n添加图片时使用markdown语法, 注意path只是文件的title，如果自定义了文件名，文件名前面的日期不需要写入\n```bash\n![image](path)\n```\n\n## 5. 博客源码提交到Github\n\n将博客原文放在hexo分支上，博客静态文件放在master分支上\n\n1.新建Blog项目，并在github上创建分支,如hexo\n\n2.github上修改项目的默认分支为hexo\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190504112516.png)\n\n3.clone项目到本地目录下\n```bash\ngit clone https://github.com/hyman213/Blog.git\n```\n\n4.执行git命令, 将文科原文保存到分支hexo上\n\n```bash\ngit remote add origin https://github.com/hyman213/Blog.git\ngit add .\ngit commit -m \"init commit\"\ngit push origin hexo\n```\n5.配置hexo deploy配置，提交到master分支\n\n```bash\ndeploy:\n  type: git\n  repository: git@github.com:hyman213/Blog.git\n  branch: master\n```\n\n静态文件发布命令\n```bash\n$ hexo clean\n$ hexo g\n$ hexo d\n```\n\n今后博客的维护更新：\n\n1. 新增文章, hexo new \"article title\"\n2. 文章编辑完成后，利用github提交源码到github hexo分支\n3. 执行hexo clean、hexo g、hexo d，将博客页面上传到github master分支, 即可更新博客\n\n## 6. 注意点\n\n* 1. Setting / GitHubPages\n     ![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190504225102.png)\n\n* 2. Blog项目不是根目录，而是作为github.io的子目录。在站点配置文件中需要设置\n\n```shell\n# URL\n## If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'\nurl: http://yoursite.com\nroot: /Blog/\npermalink: :year/:month/:day/:title/\npermalink_defaults:\n```\n\n参考：\n\n* https://www.simon96.online/2018/10/12/hexo-tutorial/\n* https://www.cnblogs.com/xingyunblog/p/9685548.html\n\n","source":"_posts/20190504-Hexo使用方法记录.md","raw":"---\ntitle: Hexo使用方法记录\ndate: 2019-05-04 14:15:23\ntags: Hexo博客\ntoc_number: false\ncategory: 使用技巧总结记录\n---\n\n\n\n利用Hexo和GitHub Page构建个人博客网站\n\n<!-- more -->\n\n\n\n## 1. 创建项目\n\n```bash\n$ npm install hexo-cli -g\n$ hexo init blog\n$ cd blog\n$ npm install\n$ hexo server\n```\n\n## 2. 设置主题风格\n\n### 2-1. 设置主题步骤\n\n* 1. 下载主题\n* 2. 将下载好的主题文件夹，粘贴到站点目录的themes下。\n* 3. 更改**站点配置文件**_config.yml 的theme字段，为主题文件夹的名称：\n\n```yml\n# Extensions\n## Plugins: https://hexo.io/plugins/\n## Themes: https://hexo.io/themes/\ntheme: next\n```\n\n注意在 Hexo 中有两份主要的配置文件，其名称都是 _config.yml\n\n* 站点配置文件，位于站点根目录下，主要包含 Hexo 本身的配置\n\n* 主题配置文件，位于主题目录下，主要用于配置主题相关的选项\n\n### 2-2. 设置主题语言\n\n* 检查\\themes\\next\\languages文件夹下语言的yml文件，如中文对应的是zh-CN.yml，英文对应的是en.yml\n* 将站点配置文件中language设置为对应的值, 如简体中文设置为language: zh-CN\n\n### 2-3. 设置主题风格\n\n修改**主题配置文件**中scheme项，目前 NexT 支持三种 Scheme，他们是：\n\n- Muse - 默认 Scheme，这是 NexT 最初的版本，黑白主调，大量留白\n- Mist - Muse 的紧凑版本，整洁有序的单栏外观\n- Pisces - 双栏 Scheme，小家碧玉似的清新\n\n```yml\n# ---------------------------------------------------------------\n# Scheme Settings\n# ---------------------------------------------------------------\n\n# Schemes\n# scheme: Muse\n#scheme: Mist\n#scheme: Pisces\nscheme: Gemini\n```\n### 2-4. 设置菜单-menu\n\n#### 2-4-1. 增加菜单项\n\n修改**主题配置**文件中menu项，菜单配置包括三个部分，第一是菜单项（名称和链接），第二是菜单项的显示文本，第三是菜单项对应的图标。 NexT 使用的是Font Awesome提供的图标\n\n```yml\n# ---------------------------------------------------------------\n# Menu Settings\n# ---------------------------------------------------------------\n\n# When running the site in a subdirectory (e.g. domain.tld/blog), remove the leading slash from link value (/archives -> archives).\n# Usage: `Key: /link/ || icon`\n# Key is the name of menu item. If the translation for this item is available, the translated text will be loaded, otherwise the Key name will be used. Key is case-senstive.\n# Value before `||` delimeter is the target link.\n# Value after `||` delimeter is the name of FontAwesome icon. If icon (with or without delimeter) is not specified, question icon will be loaded.\n# External url should start with http:// or https://\nmenu:\n  首页: / || home\n  归档: /archives/ || archive\n  分类: /categories/ || th\n  标签: /tags/ || tags\n  关于: /about/ || user\n```\n\n#### 2-4-2. categories页面创建\n\n\n* 1. 新建一个页面，命名为categories\n\n```javascript\nhexo new page categories\n```\n\n这时在source目录下会生成一个名为categories的文件夹, 在该文件夹下有一个名为index.md的文件\n\n* 2. 编辑categories文件夹下的index.md\n\n将页面的type设置为 categories ，主题将自动为这个页面显示所有分类\n\n```javascript\n---\ntitle: 分类\ndate: 2019-02-15 22:10:42\ntype: \"categories\"\ncomments: false\n---\n\n```\n\n注意：如果有启用多说 或者 Disqus 评论，默认页面也会带有评论。需要关闭的话，请添加字段 comments 并将值设置为 false\n\n* 3. 在菜单中添加链接, 编辑主题的 _config.yml\n\n在文章中加入`category: \"博客操作\"`即可自动添加到分类。如下所示\n\n```javascript\n---\ntitle: 个人博客操作笔记\nauthor: Hyman Hu\ncategory: \"博客操作\"\ntags: \"Hexo\"\n---\n```\n\n### 2-5. 设置侧栏-sidebar\n\n修改**主题配置**文件中sidebar项\n\n另：\n有时候写文章, 我们会习惯性地加上编号, 有时候又不想加上编号, 这个时候就需要自定义是否显示编号了。\n只要在不需要加编号的文章的front-matter加上 toc_number: false即可\n\n```yml\n# Table Of Contents in the Sidebar\ntoc:\n  enable: true\n  # Automatically add list number to toc.\n  number: true\n  # If true, all words will placed on next lines if header width longer then sidebar width.\n  wrap: false\n  # If true, all level of TOC in a post will be displayed, rather than the activated part of it.\n  expand_all: false\n  # Maximum heading depth of generated toc. You can set it in one post through `toc_max_depth` in Front-matter.\n  max_depth: 6\n```\n\n### 2-6. 设置头像\n\n修改**主题配置**文件中avatar项\n\n### 2-7. 其他\n\n* 1. 增加字数统计及阅读时长\n\n```shell\n# 安装插件\nnpm install hexo-symbols-count-time --save\n```\n\n修改**站点配置**文件(没有则新增)\n\n```yml\n# 增加字数和时间\nsymbols_count_time:\n #文章内是否显示\n  symbols: true\n  time: true\n # 网页底部是否显示\n  total_symbols: true\n  total_time: true\n  exclude_codeblock: false\n```\n\n修改**主题配置**文件\n\n```yml\n# Post wordcount display settings\n# Dependencies: https://github.com/theme-next/hexo-symbols-count-time\nsymbols_count_time:\n  separated_meta: true\n  #文章中的显示是否显示文字（本文字数|阅读时长）\n  item_text_post: true\n  #网页底部的显示是否显示文字（站点总字数|站点阅读时长） \n  item_text_total: false\n  # Average Word Length (chars count in word)\n  awl: 4\n  # Words Per Minute\n  wpm: 275\n  suffix: mins.\n```\n\n\n\n* 2. 网页底部信息隐藏，只需要把 主题配置文件的相关数据改为false就行\n\n```yml\nfooter:\n  # Specify the date when the site was setup. If not defined, current year will be used.\n  #since: 2015\n\n  # Icon between year and copyright info.\n  icon:\n    # Icon name in fontawesome, see: https://fontawesome.com/v4.7.0/icons/\n    # `heart` is recommended with animation in red (#ff0000).\n    name: user\n    # If you want to animate the icon, set it to true.\n    animated: false\n    # Change the color of icon, using Hex Code.\n    color: \"#808080\"\n\n  # If not defined, `author` from Hexo main config will be used.\n  copyright:\n\n  powered:\n    # Hexo link (Powered by Hexo).\n    enable: false\n    # Version info of Hexo after Hexo link (vX.X.X).\n    version: false\n\n  theme:\n    # Theme & scheme info link (Theme - NexT.scheme).\n    enable: false\n    # Version info of NexT after scheme info (vX.X.X).\n    version: false\n\n  # Beian icp information for Chinese users. In China, every legal website should have a beian icp in website footer.\n  # http://www.beian.miit.gov.cn\n  beian:\n    enable: false\n    icp:\n\n  # Any custom text can be defined here.\n  #custom_text: Hosted by <a href=\"https://pages.coding.me\" class=\"theme-link\" rel=\"noopener\" target=\"_blank\">Coding Pages</a>\n```\n\n* 3. 增加更新时间\n\n修改**主题配置**文件\n\n```yml\n# Post meta display settings\npost_meta:\n  item_text: true\n  created_at: true\n  updated_at:\n    enable: true\n    another_day: true\n  categories: true\n```\n\n写文章的时候可以直接在文章开头设置更新时间updated: 2019-05-04 12:00:00(注意格式)。没有这参数的话将会显示md文件的修改日期\n\n* 4.  增加阅读次数\n\n修改**主题配置文件**\n\n```yml\n# Show Views / Visitors of the website / page with busuanzi.\n# Get more information on http://ibruce.info/2015/04/04/busuanzi\nbusuanzi_count:\n  enable: true\n  total_visitors: true\n  total_visitors_icon: user\n  total_views: true\n  total_views_icon: eye\n  post_views: true\n  post_views_icon: eye\n```\n\n* 主页只显示摘要，点击查看更多才能看全文\n\n```xml\n摘要\n<!-- more -->\n正文\n```\n\n\n\n\n\n\n## 3. 基本操作\n\n### 3-1. 新建文章\n\n``` bash\n$ hexo new \"My New Post\"\n$ hexo n <title>\n```\n\n### 3-2. 启动服务\n``` bash\n$ hexo server\n$ hexo s\n```\n\n### 3-3. 生成静态文件\n``` bash\n$ hexo generate\n$ hexo g\n```\n\n### 3-4. 部署到服务器\n``` bash\n$ hexo deploy\n$ hexo d\n```\n\n### 3-5. 其他命令\n\n``` bash\n# 清除缓存文件 (db.json) 和已生成的静态文件 (public)\n$ hexo clean\n\n# 列出网站资料\n$ hexo list <type>\n\n# 显示hexo版本\n$ hexo version\n\n# 显示草稿\n$ hexo draft\n```\n\n\n\n## 4. 官方文档\n\n### 4-1. 写作\n\n```javascript\nhexo new [layout] <title>\n```\n\n* 1. 布局\n文章布局layout，默认post，可以通过修改_config.yml中的`default_layout`来指定默认布局\nHexo有三种默认布局: post(source/_posts_), page(source), draft(source/_draft_)。 自定义的布局，存储到_post文件夹中\n\n* 2. 文件名\nHexo 默认以标题做为文件名称。可修改**站点配置文件**_config.yml中`new_post_name`修改文件名，如：`:year-:month-:day-:title.md`\n\n* 3. 草稿\n发布草稿命令\n```javascript\nhexo publish [layout] <title>\n```\n\n* 4. 模板\n使用模板命令\n```javascript\nhexo new photo <title>\n```\n在执行这行指令时，Hexo 会尝试在 scaffolds 文件夹中寻找 photo.md\n\n* 5. 文章头文件格式\n\n| 参数 | 描述 | 默认值 |\n| :---: | :---: | :---: |\n| layout | 布局 | post |\n| title | 标题 |  |\n| date | 建立日期 | 文件建立日期 |\n| updated | 更新日期 | 文件更新日期 |\n| comments | 开启文章评论功能 | true |\n| tags | 标签 |  |\n| category | 分类 |  |\n| permalink | 覆盖文章网址 |  |\n\n注：分类具有顺序性和层次性；而标签没有顺序和层次。\n\n```bash\ncategories:\n- Diary\n- Life\n```\n会使分类Life成为Diary的子分类，而不是并列分类。因此，有必要为您的文章选择尽可能准确的分类。\n\n### 4-2. [插入引用](https://hexo.io/zh-cn/docs/tag-plugins)\n\n* 1. 引用块\n\n语法：\n```bash\n{% blockquote [author[, source]] [link] [source_link_title] %}\ncontent\n{% endblockquote %}\n```\n* 2. 代码块\n\n语法：\n```bash\n{% codeblock [title] [lang:language] [url] [link text] %}\ncode snippet\n{% endcodeblock %}\n```\n\n另一种形式的代码块，不同的是它使用三个反引号来包裹。\n\n```bash\n​``` [language] [title] [url] [link text] code snippet \n```\n\n\n\n\n\n\n### 4-3. 插入图片\n\n* 1. 设置站点配置_config.yml\n\n```bash\npost_asset_folder: true\n```\n\n* 2. 安装插件\n```bash\nnpm install hexo-asset-image -- save\n```\n\n下次新建文章时，除了生成.md文件外还生成一个同名文件\n添加图片时使用markdown语法, 注意path只是文件的title，如果自定义了文件名，文件名前面的日期不需要写入\n```bash\n![image](path)\n```\n\n## 5. 博客源码提交到Github\n\n将博客原文放在hexo分支上，博客静态文件放在master分支上\n\n1.新建Blog项目，并在github上创建分支,如hexo\n\n2.github上修改项目的默认分支为hexo\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190504112516.png)\n\n3.clone项目到本地目录下\n```bash\ngit clone https://github.com/hyman213/Blog.git\n```\n\n4.执行git命令, 将文科原文保存到分支hexo上\n\n```bash\ngit remote add origin https://github.com/hyman213/Blog.git\ngit add .\ngit commit -m \"init commit\"\ngit push origin hexo\n```\n5.配置hexo deploy配置，提交到master分支\n\n```bash\ndeploy:\n  type: git\n  repository: git@github.com:hyman213/Blog.git\n  branch: master\n```\n\n静态文件发布命令\n```bash\n$ hexo clean\n$ hexo g\n$ hexo d\n```\n\n今后博客的维护更新：\n\n1. 新增文章, hexo new \"article title\"\n2. 文章编辑完成后，利用github提交源码到github hexo分支\n3. 执行hexo clean、hexo g、hexo d，将博客页面上传到github master分支, 即可更新博客\n\n## 6. 注意点\n\n* 1. Setting / GitHubPages\n     ![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190504225102.png)\n\n* 2. Blog项目不是根目录，而是作为github.io的子目录。在站点配置文件中需要设置\n\n```shell\n# URL\n## If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'\nurl: http://yoursite.com\nroot: /Blog/\npermalink: :year/:month/:day/:title/\npermalink_defaults:\n```\n\n参考：\n\n* https://www.simon96.online/2018/10/12/hexo-tutorial/\n* https://www.cnblogs.com/xingyunblog/p/9685548.html\n\n","slug":"Hexo使用方法记录","published":1,"updated":"2019-05-07T14:09:10.554Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck27dih180000mskpbk426dyy","content":"<p>利用Hexo和GitHub Page构建个人博客网站</p>\n<a id=\"more\"></a>\n<h2 id=\"1-创建项目\"><a href=\"#1-创建项目\" class=\"headerlink\" title=\"1. 创建项目\"></a>1. 创建项目</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install hexo-cli -g</span><br><span class=\"line\">$ hexo init blog</span><br><span class=\"line\">$ <span class=\"built_in\">cd</span> blog</span><br><span class=\"line\">$ npm install</span><br><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-设置主题风格\"><a href=\"#2-设置主题风格\" class=\"headerlink\" title=\"2. 设置主题风格\"></a>2. 设置主题风格</h2><h3 id=\"2-1-设置主题步骤\"><a href=\"#2-1-设置主题步骤\" class=\"headerlink\" title=\"2-1. 设置主题步骤\"></a>2-1. 设置主题步骤</h3><ul>\n<li><ol>\n<li>下载主题</li>\n</ol>\n</li>\n<li><ol start=\"2\">\n<li>将下载好的主题文件夹，粘贴到站点目录的themes下。</li>\n</ol>\n</li>\n<li><ol start=\"3\">\n<li>更改<strong>站点配置文件</strong>_config.yml 的theme字段，为主题文件夹的名称：</li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Extensions</span></span><br><span class=\"line\"><span class=\"comment\">## Plugins: https://hexo.io/plugins/</span></span><br><span class=\"line\"><span class=\"comment\">## Themes: https://hexo.io/themes/</span></span><br><span class=\"line\"><span class=\"attr\">theme:</span> <span class=\"string\">next</span></span><br></pre></td></tr></table></figure>\n<p>注意在 Hexo 中有两份主要的配置文件，其名称都是 _config.yml</p>\n<ul>\n<li><p>站点配置文件，位于站点根目录下，主要包含 Hexo 本身的配置</p>\n</li>\n<li><p>主题配置文件，位于主题目录下，主要用于配置主题相关的选项</p>\n</li>\n</ul>\n<h3 id=\"2-2-设置主题语言\"><a href=\"#2-2-设置主题语言\" class=\"headerlink\" title=\"2-2. 设置主题语言\"></a>2-2. 设置主题语言</h3><ul>\n<li>检查\\themes\\next\\languages文件夹下语言的yml文件，如中文对应的是zh-CN.yml，英文对应的是en.yml</li>\n<li>将站点配置文件中language设置为对应的值, 如简体中文设置为language: zh-CN</li>\n</ul>\n<h3 id=\"2-3-设置主题风格\"><a href=\"#2-3-设置主题风格\" class=\"headerlink\" title=\"2-3. 设置主题风格\"></a>2-3. 设置主题风格</h3><p>修改<strong>主题配置文件</strong>中scheme项，目前 NexT 支持三种 Scheme，他们是：</p>\n<ul>\n<li>Muse - 默认 Scheme，这是 NexT 最初的版本，黑白主调，大量留白</li>\n<li>Mist - Muse 的紧凑版本，整洁有序的单栏外观</li>\n<li>Pisces - 双栏 Scheme，小家碧玉似的清新</li>\n</ul>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\"># Scheme Settings</span></span><br><span class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Schemes</span></span><br><span class=\"line\"><span class=\"comment\"># scheme: Muse</span></span><br><span class=\"line\"><span class=\"comment\">#scheme: Mist</span></span><br><span class=\"line\"><span class=\"comment\">#scheme: Pisces</span></span><br><span class=\"line\"><span class=\"attr\">scheme:</span> <span class=\"string\">Gemini</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"2-4-设置菜单-menu\"><a href=\"#2-4-设置菜单-menu\" class=\"headerlink\" title=\"2-4. 设置菜单-menu\"></a>2-4. 设置菜单-menu</h3><h4 id=\"2-4-1-增加菜单项\"><a href=\"#2-4-1-增加菜单项\" class=\"headerlink\" title=\"2-4-1. 增加菜单项\"></a>2-4-1. 增加菜单项</h4><p>修改<strong>主题配置</strong>文件中menu项，菜单配置包括三个部分，第一是菜单项（名称和链接），第二是菜单项的显示文本，第三是菜单项对应的图标。 NexT 使用的是Font Awesome提供的图标</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\"># Menu Settings</span></span><br><span class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># When running the site in a subdirectory (e.g. domain.tld/blog), remove the leading slash from link value (/archives -&gt; archives).</span></span><br><span class=\"line\"><span class=\"comment\"># Usage: `Key: /link/ || icon`</span></span><br><span class=\"line\"><span class=\"comment\"># Key is the name of menu item. If the translation for this item is available, the translated text will be loaded, otherwise the Key name will be used. Key is case-senstive.</span></span><br><span class=\"line\"><span class=\"comment\"># Value before `||` delimeter is the target link.</span></span><br><span class=\"line\"><span class=\"comment\"># Value after `||` delimeter is the name of FontAwesome icon. If icon (with or without delimeter) is not specified, question icon will be loaded.</span></span><br><span class=\"line\"><span class=\"comment\"># External url should start with http:// or https://</span></span><br><span class=\"line\"><span class=\"attr\">menu:</span></span><br><span class=\"line\">  <span class=\"string\">首页:</span> <span class=\"string\">/</span> <span class=\"string\">||</span> <span class=\"string\">home</span></span><br><span class=\"line\">  <span class=\"string\">归档:</span> <span class=\"string\">/archives/</span> <span class=\"string\">||</span> <span class=\"string\">archive</span></span><br><span class=\"line\">  <span class=\"string\">分类:</span> <span class=\"string\">/categories/</span> <span class=\"string\">||</span> <span class=\"string\">th</span></span><br><span class=\"line\">  <span class=\"string\">标签:</span> <span class=\"string\">/tags/</span> <span class=\"string\">||</span> <span class=\"string\">tags</span></span><br><span class=\"line\">  <span class=\"string\">关于:</span> <span class=\"string\">/about/</span> <span class=\"string\">||</span> <span class=\"string\">user</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"2-4-2-categories页面创建\"><a href=\"#2-4-2-categories页面创建\" class=\"headerlink\" title=\"2-4-2. categories页面创建\"></a>2-4-2. categories页面创建</h4><ul>\n<li><ol>\n<li>新建一个页面，命名为categories</li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo <span class=\"keyword\">new</span> page categories</span><br></pre></td></tr></table></figure>\n<p>这时在source目录下会生成一个名为categories的文件夹, 在该文件夹下有一个名为index.md的文件</p>\n<ul>\n<li><ol start=\"2\">\n<li>编辑categories文件夹下的index.md</li>\n</ol>\n</li>\n</ul>\n<p>将页面的type设置为 categories ，主题将自动为这个页面显示所有分类</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\">title: 分类</span><br><span class=\"line\">date: <span class=\"number\">2019</span><span class=\"number\">-02</span><span class=\"number\">-15</span> <span class=\"number\">22</span>:<span class=\"number\">10</span>:<span class=\"number\">42</span></span><br><span class=\"line\">type: <span class=\"string\">\"categories\"</span></span><br><span class=\"line\">comments: <span class=\"literal\">false</span></span><br><span class=\"line\">---</span><br></pre></td></tr></table></figure>\n<p>注意：如果有启用多说 或者 Disqus 评论，默认页面也会带有评论。需要关闭的话，请添加字段 comments 并将值设置为 false</p>\n<ul>\n<li><ol start=\"3\">\n<li>在菜单中添加链接, 编辑主题的 _config.yml</li>\n</ol>\n</li>\n</ul>\n<p>在文章中加入<code>category: &quot;博客操作&quot;</code>即可自动添加到分类。如下所示</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\">title: 个人博客操作笔记</span><br><span class=\"line\">author: Hyman Hu</span><br><span class=\"line\">category: <span class=\"string\">\"博客操作\"</span></span><br><span class=\"line\">tags: <span class=\"string\">\"Hexo\"</span></span><br><span class=\"line\">---</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-5-设置侧栏-sidebar\"><a href=\"#2-5-设置侧栏-sidebar\" class=\"headerlink\" title=\"2-5. 设置侧栏-sidebar\"></a>2-5. 设置侧栏-sidebar</h3><p>修改<strong>主题配置</strong>文件中sidebar项</p>\n<p>另：<br>有时候写文章, 我们会习惯性地加上编号, 有时候又不想加上编号, 这个时候就需要自定义是否显示编号了。<br>只要在不需要加编号的文章的front-matter加上 toc_number: false即可</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Table Of Contents in the Sidebar</span></span><br><span class=\"line\"><span class=\"attr\">toc:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"comment\"># Automatically add list number to toc.</span></span><br><span class=\"line\"><span class=\"attr\">  number:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"comment\"># If true, all words will placed on next lines if header width longer then sidebar width.</span></span><br><span class=\"line\"><span class=\"attr\">  wrap:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">  <span class=\"comment\"># If true, all level of TOC in a post will be displayed, rather than the activated part of it.</span></span><br><span class=\"line\"><span class=\"attr\">  expand_all:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">  <span class=\"comment\"># Maximum heading depth of generated toc. You can set it in one post through `toc_max_depth` in Front-matter.</span></span><br><span class=\"line\"><span class=\"attr\">  max_depth:</span> <span class=\"number\">6</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"2-6-设置头像\"><a href=\"#2-6-设置头像\" class=\"headerlink\" title=\"2-6. 设置头像\"></a>2-6. 设置头像</h3><p>修改<strong>主题配置</strong>文件中avatar项</p>\n<h3 id=\"2-7-其他\"><a href=\"#2-7-其他\" class=\"headerlink\" title=\"2-7. 其他\"></a>2-7. 其他</h3><ul>\n<li><ol>\n<li>增加字数统计及阅读时长</li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 安装插件</span></span><br><span class=\"line\">npm install hexo-symbols-count-time --save</span><br></pre></td></tr></table></figure>\n<p>修改<strong>站点配置</strong>文件(没有则新增)</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 增加字数和时间</span></span><br><span class=\"line\"><span class=\"attr\">symbols_count_time:</span></span><br><span class=\"line\"> <span class=\"comment\">#文章内是否显示</span></span><br><span class=\"line\"><span class=\"attr\">  symbols:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  time:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"> <span class=\"comment\"># 网页底部是否显示</span></span><br><span class=\"line\"><span class=\"attr\">  total_symbols:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  total_time:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  exclude_codeblock:</span> <span class=\"literal\">false</span></span><br></pre></td></tr></table></figure>\n<p>修改<strong>主题配置</strong>文件</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Post wordcount display settings</span></span><br><span class=\"line\"><span class=\"comment\"># Dependencies: https://github.com/theme-next/hexo-symbols-count-time</span></span><br><span class=\"line\"><span class=\"attr\">symbols_count_time:</span></span><br><span class=\"line\"><span class=\"attr\">  separated_meta:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"comment\">#文章中的显示是否显示文字（本文字数|阅读时长）</span></span><br><span class=\"line\"><span class=\"attr\">  item_text_post:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"comment\">#网页底部的显示是否显示文字（站点总字数|站点阅读时长） </span></span><br><span class=\"line\"><span class=\"attr\">  item_text_total:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">  <span class=\"comment\"># Average Word Length (chars count in word)</span></span><br><span class=\"line\"><span class=\"attr\">  awl:</span> <span class=\"number\">4</span></span><br><span class=\"line\">  <span class=\"comment\"># Words Per Minute</span></span><br><span class=\"line\"><span class=\"attr\">  wpm:</span> <span class=\"number\">275</span></span><br><span class=\"line\"><span class=\"attr\">  suffix:</span> <span class=\"string\">mins.</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li><ol start=\"2\">\n<li>网页底部信息隐藏，只需要把 主题配置文件的相关数据改为false就行</li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">footer:</span></span><br><span class=\"line\">  <span class=\"comment\"># Specify the date when the site was setup. If not defined, current year will be used.</span></span><br><span class=\"line\">  <span class=\"comment\">#since: 2015</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># Icon between year and copyright info.</span></span><br><span class=\"line\"><span class=\"attr\">  icon:</span></span><br><span class=\"line\">    <span class=\"comment\"># Icon name in fontawesome, see: https://fontawesome.com/v4.7.0/icons/</span></span><br><span class=\"line\">    <span class=\"comment\"># `heart` is recommended with animation in red (#ff0000).</span></span><br><span class=\"line\"><span class=\"attr\">    name:</span> <span class=\"string\">user</span></span><br><span class=\"line\">    <span class=\"comment\"># If you want to animate the icon, set it to true.</span></span><br><span class=\"line\"><span class=\"attr\">    animated:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">    <span class=\"comment\"># Change the color of icon, using Hex Code.</span></span><br><span class=\"line\"><span class=\"attr\">    color:</span> <span class=\"string\">\"#808080\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># If not defined, `author` from Hexo main config will be used.</span></span><br><span class=\"line\"><span class=\"attr\">  copyright:</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">  powered:</span></span><br><span class=\"line\">    <span class=\"comment\"># Hexo link (Powered by Hexo).</span></span><br><span class=\"line\"><span class=\"attr\">    enable:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">    <span class=\"comment\"># Version info of Hexo after Hexo link (vX.X.X).</span></span><br><span class=\"line\"><span class=\"attr\">    version:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">  theme:</span></span><br><span class=\"line\">    <span class=\"comment\"># Theme &amp; scheme info link (Theme - NexT.scheme).</span></span><br><span class=\"line\"><span class=\"attr\">    enable:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">    <span class=\"comment\"># Version info of NexT after scheme info (vX.X.X).</span></span><br><span class=\"line\"><span class=\"attr\">    version:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># Beian icp information for Chinese users. In China, every legal website should have a beian icp in website footer.</span></span><br><span class=\"line\">  <span class=\"comment\"># http://www.beian.miit.gov.cn</span></span><br><span class=\"line\"><span class=\"attr\">  beian:</span></span><br><span class=\"line\"><span class=\"attr\">    enable:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">    icp:</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># Any custom text can be defined here.</span></span><br><span class=\"line\">  <span class=\"comment\">#custom_text: Hosted by &lt;a href=\"https://pages.coding.me\" class=\"theme-link\" rel=\"noopener\" target=\"_blank\"&gt;Coding Pages&lt;/a&gt;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li><ol start=\"3\">\n<li>增加更新时间</li>\n</ol>\n</li>\n</ul>\n<p>修改<strong>主题配置</strong>文件</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Post meta display settings</span></span><br><span class=\"line\"><span class=\"attr\">post_meta:</span></span><br><span class=\"line\"><span class=\"attr\">  item_text:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  created_at:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  updated_at:</span></span><br><span class=\"line\"><span class=\"attr\">    enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">    another_day:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  categories:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n<p>写文章的时候可以直接在文章开头设置更新时间updated: 2019-05-04 12:00:00(注意格式)。没有这参数的话将会显示md文件的修改日期</p>\n<ul>\n<li><ol start=\"4\">\n<li>增加阅读次数</li>\n</ol>\n</li>\n</ul>\n<p>修改<strong>主题配置文件</strong></p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Show Views / Visitors of the website / page with busuanzi.</span></span><br><span class=\"line\"><span class=\"comment\"># Get more information on http://ibruce.info/2015/04/04/busuanzi</span></span><br><span class=\"line\"><span class=\"attr\">busuanzi_count:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  total_visitors:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  total_visitors_icon:</span> <span class=\"string\">user</span></span><br><span class=\"line\"><span class=\"attr\">  total_views:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  total_views_icon:</span> <span class=\"string\">eye</span></span><br><span class=\"line\"><span class=\"attr\">  post_views:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  post_views_icon:</span> <span class=\"string\">eye</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>主页只显示摘要，点击查看更多才能看全文</li>\n</ul>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">摘要</span><br><span class=\"line\"><span class=\"comment\">&lt;!-- more --&gt;</span></span><br><span class=\"line\">正文</span><br></pre></td></tr></table></figure>\n<h2 id=\"3-基本操作\"><a href=\"#3-基本操作\" class=\"headerlink\" title=\"3. 基本操作\"></a>3. 基本操作</h2><h3 id=\"3-1-新建文章\"><a href=\"#3-1-新建文章\" class=\"headerlink\" title=\"3-1. 新建文章\"></a>3-1. 新建文章</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></span><br><span class=\"line\">$ hexo n &lt;title&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-2-启动服务\"><a href=\"#3-2-启动服务\" class=\"headerlink\" title=\"3-2. 启动服务\"></a>3-2. 启动服务</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br><span class=\"line\">$ hexo s</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-3-生成静态文件\"><a href=\"#3-3-生成静态文件\" class=\"headerlink\" title=\"3-3. 生成静态文件\"></a>3-3. 生成静态文件</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br><span class=\"line\">$ hexo g</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-4-部署到服务器\"><a href=\"#3-4-部署到服务器\" class=\"headerlink\" title=\"3-4. 部署到服务器\"></a>3-4. 部署到服务器</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br><span class=\"line\">$ hexo d</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-5-其他命令\"><a href=\"#3-5-其他命令\" class=\"headerlink\" title=\"3-5. 其他命令\"></a>3-5. 其他命令</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 清除缓存文件 (db.json) 和已生成的静态文件 (public)</span></span><br><span class=\"line\">$ hexo clean</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 列出网站资料</span></span><br><span class=\"line\">$ hexo list &lt;<span class=\"built_in\">type</span>&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 显示hexo版本</span></span><br><span class=\"line\">$ hexo version</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 显示草稿</span></span><br><span class=\"line\">$ hexo draft</span><br></pre></td></tr></table></figure>\n<h2 id=\"4-官方文档\"><a href=\"#4-官方文档\" class=\"headerlink\" title=\"4. 官方文档\"></a>4. 官方文档</h2><h3 id=\"4-1-写作\"><a href=\"#4-1-写作\" class=\"headerlink\" title=\"4-1. 写作\"></a>4-1. 写作</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo <span class=\"keyword\">new</span> [layout] &lt;title&gt;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><ol>\n<li>布局<br>文章布局layout，默认post，可以通过修改_config.yml中的<code>default_layout</code>来指定默认布局<br>Hexo有三种默认布局: post(source/<em>posts</em>), page(source), draft(source/<em>draft</em>)。 自定义的布局，存储到_post文件夹中</li>\n</ol>\n</li>\n<li><ol start=\"2\">\n<li>文件名<br>Hexo 默认以标题做为文件名称。可修改<strong>站点配置文件</strong>_config.yml中<code>new_post_name</code>修改文件名，如：<code>:year-:month-:day-:title.md</code></li>\n</ol>\n</li>\n<li><ol start=\"3\">\n<li>草稿<br>发布草稿命令<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo publish [layout] &lt;title&gt;</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n</li>\n<li><ol start=\"4\">\n<li>模板<br>使用模板命令<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo <span class=\"keyword\">new</span> photo &lt;title&gt;</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n</li>\n</ul>\n<p>在执行这行指令时，Hexo 会尝试在 scaffolds 文件夹中寻找 photo.md</p>\n<ul>\n<li><ol start=\"5\">\n<li>文章头文件格式</li>\n</ol>\n</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">参数</th>\n<th style=\"text-align:center\">描述</th>\n<th style=\"text-align:center\">默认值</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">layout</td>\n<td style=\"text-align:center\">布局</td>\n<td style=\"text-align:center\">post</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">title</td>\n<td style=\"text-align:center\">标题</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">date</td>\n<td style=\"text-align:center\">建立日期</td>\n<td style=\"text-align:center\">文件建立日期</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">updated</td>\n<td style=\"text-align:center\">更新日期</td>\n<td style=\"text-align:center\">文件更新日期</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">comments</td>\n<td style=\"text-align:center\">开启文章评论功能</td>\n<td style=\"text-align:center\">true</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">tags</td>\n<td style=\"text-align:center\">标签</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">category</td>\n<td style=\"text-align:center\">分类</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">permalink</td>\n<td style=\"text-align:center\">覆盖文章网址</td>\n</tr>\n</tbody>\n</table>\n<p>注：分类具有顺序性和层次性；而标签没有顺序和层次。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">categories:</span><br><span class=\"line\">- Diary</span><br><span class=\"line\">- Life</span><br></pre></td></tr></table></figure>\n<p>会使分类Life成为Diary的子分类，而不是并列分类。因此，有必要为您的文章选择尽可能准确的分类。</p>\n<h3 id=\"4-2-插入引用\"><a href=\"#4-2-插入引用\" class=\"headerlink\" title=\"4-2. 插入引用\"></a>4-2. <a href=\"https://hexo.io/zh-cn/docs/tag-plugins\" target=\"_blank\" rel=\"noopener\">插入引用</a></h3><ul>\n<li><ol>\n<li>引用块</li>\n</ol>\n</li>\n</ul>\n<p>语法：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% blockquote [author[, <span class=\"built_in\">source</span>]] [link] [source_link_title] %&#125;</span><br><span class=\"line\">content</span><br><span class=\"line\">&#123;% endblockquote %&#125;</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><ol start=\"2\">\n<li>代码块</li>\n</ol>\n</li>\n</ul>\n<p>语法：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% codeblock [title] [lang:language] [url] [link text] %&#125;</span><br><span class=\"line\">code snippet</span><br><span class=\"line\">&#123;% endcodeblock %&#125;</span><br></pre></td></tr></table></figure></p>\n<p>另一种形式的代码块，不同的是它使用三个反引号来包裹。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">​``` [language] [title] [url] [link text] code snippet</span><br></pre></td></tr></table></figure>\n<h3 id=\"4-3-插入图片\"><a href=\"#4-3-插入图片\" class=\"headerlink\" title=\"4-3. 插入图片\"></a>4-3. 插入图片</h3><ul>\n<li><ol>\n<li>设置站点配置_config.yml</li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">post_asset_folder: <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li><ol start=\"2\">\n<li>安装插件<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install hexo-asset-image -- save</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n</li>\n</ul>\n<p>下次新建文章时，除了生成.md文件外还生成一个同名文件<br>添加图片时使用markdown语法, 注意path只是文件的title，如果自定义了文件名，文件名前面的日期不需要写入<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">![image](path)</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"5-博客源码提交到Github\"><a href=\"#5-博客源码提交到Github\" class=\"headerlink\" title=\"5. 博客源码提交到Github\"></a>5. 博客源码提交到Github</h2><p>将博客原文放在hexo分支上，博客静态文件放在master分支上</p>\n<p>1.新建Blog项目，并在github上创建分支,如hexo</p>\n<p>2.github上修改项目的默认分支为hexo</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190504112516.png\" alt></p>\n<p>3.clone项目到本地目录下<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/hyman213/Blog.git</span><br></pre></td></tr></table></figure></p>\n<p>4.执行git命令, 将文科原文保存到分支hexo上</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git remote add origin https://github.com/hyman213/Blog.git</span><br><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m <span class=\"string\">\"init commit\"</span></span><br><span class=\"line\">git push origin hexo</span><br></pre></td></tr></table></figure>\n<p>5.配置hexo deploy配置，提交到master分支</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">deploy:</span><br><span class=\"line\">  <span class=\"built_in\">type</span>: git</span><br><span class=\"line\">  repository: git@github.com:hyman213/Blog.git</span><br><span class=\"line\">  branch: master</span><br></pre></td></tr></table></figure>\n<p>静态文件发布命令<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo clean</span><br><span class=\"line\">$ hexo g</span><br><span class=\"line\">$ hexo d</span><br></pre></td></tr></table></figure></p>\n<p>今后博客的维护更新：</p>\n<ol>\n<li>新增文章, hexo new “article title”</li>\n<li>文章编辑完成后，利用github提交源码到github hexo分支</li>\n<li>执行hexo clean、hexo g、hexo d，将博客页面上传到github master分支, 即可更新博客</li>\n</ol>\n<h2 id=\"6-注意点\"><a href=\"#6-注意点\" class=\"headerlink\" title=\"6. 注意点\"></a>6. 注意点</h2><ul>\n<li><ol>\n<li>Setting / GitHubPages<br><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190504225102.png\" alt></li>\n</ol>\n</li>\n<li><ol start=\"2\">\n<li>Blog项目不是根目录，而是作为github.io的子目录。在站点配置文件中需要设置</li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> URL</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\"># If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'</span></span></span><br><span class=\"line\">url: http://yoursite.com</span><br><span class=\"line\">root: /Blog/</span><br><span class=\"line\">permalink: :year/:month/:day/:title/</span><br><span class=\"line\">permalink_defaults:</span><br></pre></td></tr></table></figure>\n<p>参考：</p>\n<ul>\n<li><a href=\"https://www.simon96.online/2018/10/12/hexo-tutorial/\" target=\"_blank\" rel=\"noopener\">https://www.simon96.online/2018/10/12/hexo-tutorial/</a></li>\n<li><a href=\"https://www.cnblogs.com/xingyunblog/p/9685548.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/xingyunblog/p/9685548.html</a></li>\n</ul>\n","site":{"data":{}},"length":7870,"excerpt":"<p>利用Hexo和GitHub Page构建个人博客网站</p>","more":"<h2 id=\"1-创建项目\"><a href=\"#1-创建项目\" class=\"headerlink\" title=\"1. 创建项目\"></a>1. 创建项目</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install hexo-cli -g</span><br><span class=\"line\">$ hexo init blog</span><br><span class=\"line\">$ <span class=\"built_in\">cd</span> blog</span><br><span class=\"line\">$ npm install</span><br><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-设置主题风格\"><a href=\"#2-设置主题风格\" class=\"headerlink\" title=\"2. 设置主题风格\"></a>2. 设置主题风格</h2><h3 id=\"2-1-设置主题步骤\"><a href=\"#2-1-设置主题步骤\" class=\"headerlink\" title=\"2-1. 设置主题步骤\"></a>2-1. 设置主题步骤</h3><ul>\n<li><ol>\n<li>下载主题</li>\n</ol>\n</li>\n<li><ol start=\"2\">\n<li>将下载好的主题文件夹，粘贴到站点目录的themes下。</li>\n</ol>\n</li>\n<li><ol start=\"3\">\n<li>更改<strong>站点配置文件</strong>_config.yml 的theme字段，为主题文件夹的名称：</li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Extensions</span></span><br><span class=\"line\"><span class=\"comment\">## Plugins: https://hexo.io/plugins/</span></span><br><span class=\"line\"><span class=\"comment\">## Themes: https://hexo.io/themes/</span></span><br><span class=\"line\"><span class=\"attr\">theme:</span> <span class=\"string\">next</span></span><br></pre></td></tr></table></figure>\n<p>注意在 Hexo 中有两份主要的配置文件，其名称都是 _config.yml</p>\n<ul>\n<li><p>站点配置文件，位于站点根目录下，主要包含 Hexo 本身的配置</p>\n</li>\n<li><p>主题配置文件，位于主题目录下，主要用于配置主题相关的选项</p>\n</li>\n</ul>\n<h3 id=\"2-2-设置主题语言\"><a href=\"#2-2-设置主题语言\" class=\"headerlink\" title=\"2-2. 设置主题语言\"></a>2-2. 设置主题语言</h3><ul>\n<li>检查\\themes\\next\\languages文件夹下语言的yml文件，如中文对应的是zh-CN.yml，英文对应的是en.yml</li>\n<li>将站点配置文件中language设置为对应的值, 如简体中文设置为language: zh-CN</li>\n</ul>\n<h3 id=\"2-3-设置主题风格\"><a href=\"#2-3-设置主题风格\" class=\"headerlink\" title=\"2-3. 设置主题风格\"></a>2-3. 设置主题风格</h3><p>修改<strong>主题配置文件</strong>中scheme项，目前 NexT 支持三种 Scheme，他们是：</p>\n<ul>\n<li>Muse - 默认 Scheme，这是 NexT 最初的版本，黑白主调，大量留白</li>\n<li>Mist - Muse 的紧凑版本，整洁有序的单栏外观</li>\n<li>Pisces - 双栏 Scheme，小家碧玉似的清新</li>\n</ul>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\"># Scheme Settings</span></span><br><span class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Schemes</span></span><br><span class=\"line\"><span class=\"comment\"># scheme: Muse</span></span><br><span class=\"line\"><span class=\"comment\">#scheme: Mist</span></span><br><span class=\"line\"><span class=\"comment\">#scheme: Pisces</span></span><br><span class=\"line\"><span class=\"attr\">scheme:</span> <span class=\"string\">Gemini</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"2-4-设置菜单-menu\"><a href=\"#2-4-设置菜单-menu\" class=\"headerlink\" title=\"2-4. 设置菜单-menu\"></a>2-4. 设置菜单-menu</h3><h4 id=\"2-4-1-增加菜单项\"><a href=\"#2-4-1-增加菜单项\" class=\"headerlink\" title=\"2-4-1. 增加菜单项\"></a>2-4-1. 增加菜单项</h4><p>修改<strong>主题配置</strong>文件中menu项，菜单配置包括三个部分，第一是菜单项（名称和链接），第二是菜单项的显示文本，第三是菜单项对应的图标。 NexT 使用的是Font Awesome提供的图标</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\"># Menu Settings</span></span><br><span class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># When running the site in a subdirectory (e.g. domain.tld/blog), remove the leading slash from link value (/archives -&gt; archives).</span></span><br><span class=\"line\"><span class=\"comment\"># Usage: `Key: /link/ || icon`</span></span><br><span class=\"line\"><span class=\"comment\"># Key is the name of menu item. If the translation for this item is available, the translated text will be loaded, otherwise the Key name will be used. Key is case-senstive.</span></span><br><span class=\"line\"><span class=\"comment\"># Value before `||` delimeter is the target link.</span></span><br><span class=\"line\"><span class=\"comment\"># Value after `||` delimeter is the name of FontAwesome icon. If icon (with or without delimeter) is not specified, question icon will be loaded.</span></span><br><span class=\"line\"><span class=\"comment\"># External url should start with http:// or https://</span></span><br><span class=\"line\"><span class=\"attr\">menu:</span></span><br><span class=\"line\">  <span class=\"string\">首页:</span> <span class=\"string\">/</span> <span class=\"string\">||</span> <span class=\"string\">home</span></span><br><span class=\"line\">  <span class=\"string\">归档:</span> <span class=\"string\">/archives/</span> <span class=\"string\">||</span> <span class=\"string\">archive</span></span><br><span class=\"line\">  <span class=\"string\">分类:</span> <span class=\"string\">/categories/</span> <span class=\"string\">||</span> <span class=\"string\">th</span></span><br><span class=\"line\">  <span class=\"string\">标签:</span> <span class=\"string\">/tags/</span> <span class=\"string\">||</span> <span class=\"string\">tags</span></span><br><span class=\"line\">  <span class=\"string\">关于:</span> <span class=\"string\">/about/</span> <span class=\"string\">||</span> <span class=\"string\">user</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"2-4-2-categories页面创建\"><a href=\"#2-4-2-categories页面创建\" class=\"headerlink\" title=\"2-4-2. categories页面创建\"></a>2-4-2. categories页面创建</h4><ul>\n<li><ol>\n<li>新建一个页面，命名为categories</li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo <span class=\"keyword\">new</span> page categories</span><br></pre></td></tr></table></figure>\n<p>这时在source目录下会生成一个名为categories的文件夹, 在该文件夹下有一个名为index.md的文件</p>\n<ul>\n<li><ol start=\"2\">\n<li>编辑categories文件夹下的index.md</li>\n</ol>\n</li>\n</ul>\n<p>将页面的type设置为 categories ，主题将自动为这个页面显示所有分类</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\">title: 分类</span><br><span class=\"line\">date: <span class=\"number\">2019</span><span class=\"number\">-02</span><span class=\"number\">-15</span> <span class=\"number\">22</span>:<span class=\"number\">10</span>:<span class=\"number\">42</span></span><br><span class=\"line\">type: <span class=\"string\">\"categories\"</span></span><br><span class=\"line\">comments: <span class=\"literal\">false</span></span><br><span class=\"line\">---</span><br></pre></td></tr></table></figure>\n<p>注意：如果有启用多说 或者 Disqus 评论，默认页面也会带有评论。需要关闭的话，请添加字段 comments 并将值设置为 false</p>\n<ul>\n<li><ol start=\"3\">\n<li>在菜单中添加链接, 编辑主题的 _config.yml</li>\n</ol>\n</li>\n</ul>\n<p>在文章中加入<code>category: &quot;博客操作&quot;</code>即可自动添加到分类。如下所示</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\">title: 个人博客操作笔记</span><br><span class=\"line\">author: Hyman Hu</span><br><span class=\"line\">category: <span class=\"string\">\"博客操作\"</span></span><br><span class=\"line\">tags: <span class=\"string\">\"Hexo\"</span></span><br><span class=\"line\">---</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-5-设置侧栏-sidebar\"><a href=\"#2-5-设置侧栏-sidebar\" class=\"headerlink\" title=\"2-5. 设置侧栏-sidebar\"></a>2-5. 设置侧栏-sidebar</h3><p>修改<strong>主题配置</strong>文件中sidebar项</p>\n<p>另：<br>有时候写文章, 我们会习惯性地加上编号, 有时候又不想加上编号, 这个时候就需要自定义是否显示编号了。<br>只要在不需要加编号的文章的front-matter加上 toc_number: false即可</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Table Of Contents in the Sidebar</span></span><br><span class=\"line\"><span class=\"attr\">toc:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"comment\"># Automatically add list number to toc.</span></span><br><span class=\"line\"><span class=\"attr\">  number:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"comment\"># If true, all words will placed on next lines if header width longer then sidebar width.</span></span><br><span class=\"line\"><span class=\"attr\">  wrap:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">  <span class=\"comment\"># If true, all level of TOC in a post will be displayed, rather than the activated part of it.</span></span><br><span class=\"line\"><span class=\"attr\">  expand_all:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">  <span class=\"comment\"># Maximum heading depth of generated toc. You can set it in one post through `toc_max_depth` in Front-matter.</span></span><br><span class=\"line\"><span class=\"attr\">  max_depth:</span> <span class=\"number\">6</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"2-6-设置头像\"><a href=\"#2-6-设置头像\" class=\"headerlink\" title=\"2-6. 设置头像\"></a>2-6. 设置头像</h3><p>修改<strong>主题配置</strong>文件中avatar项</p>\n<h3 id=\"2-7-其他\"><a href=\"#2-7-其他\" class=\"headerlink\" title=\"2-7. 其他\"></a>2-7. 其他</h3><ul>\n<li><ol>\n<li>增加字数统计及阅读时长</li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 安装插件</span></span><br><span class=\"line\">npm install hexo-symbols-count-time --save</span><br></pre></td></tr></table></figure>\n<p>修改<strong>站点配置</strong>文件(没有则新增)</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 增加字数和时间</span></span><br><span class=\"line\"><span class=\"attr\">symbols_count_time:</span></span><br><span class=\"line\"> <span class=\"comment\">#文章内是否显示</span></span><br><span class=\"line\"><span class=\"attr\">  symbols:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  time:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"> <span class=\"comment\"># 网页底部是否显示</span></span><br><span class=\"line\"><span class=\"attr\">  total_symbols:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  total_time:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  exclude_codeblock:</span> <span class=\"literal\">false</span></span><br></pre></td></tr></table></figure>\n<p>修改<strong>主题配置</strong>文件</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Post wordcount display settings</span></span><br><span class=\"line\"><span class=\"comment\"># Dependencies: https://github.com/theme-next/hexo-symbols-count-time</span></span><br><span class=\"line\"><span class=\"attr\">symbols_count_time:</span></span><br><span class=\"line\"><span class=\"attr\">  separated_meta:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"comment\">#文章中的显示是否显示文字（本文字数|阅读时长）</span></span><br><span class=\"line\"><span class=\"attr\">  item_text_post:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"comment\">#网页底部的显示是否显示文字（站点总字数|站点阅读时长） </span></span><br><span class=\"line\"><span class=\"attr\">  item_text_total:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">  <span class=\"comment\"># Average Word Length (chars count in word)</span></span><br><span class=\"line\"><span class=\"attr\">  awl:</span> <span class=\"number\">4</span></span><br><span class=\"line\">  <span class=\"comment\"># Words Per Minute</span></span><br><span class=\"line\"><span class=\"attr\">  wpm:</span> <span class=\"number\">275</span></span><br><span class=\"line\"><span class=\"attr\">  suffix:</span> <span class=\"string\">mins.</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li><ol start=\"2\">\n<li>网页底部信息隐藏，只需要把 主题配置文件的相关数据改为false就行</li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">footer:</span></span><br><span class=\"line\">  <span class=\"comment\"># Specify the date when the site was setup. If not defined, current year will be used.</span></span><br><span class=\"line\">  <span class=\"comment\">#since: 2015</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># Icon between year and copyright info.</span></span><br><span class=\"line\"><span class=\"attr\">  icon:</span></span><br><span class=\"line\">    <span class=\"comment\"># Icon name in fontawesome, see: https://fontawesome.com/v4.7.0/icons/</span></span><br><span class=\"line\">    <span class=\"comment\"># `heart` is recommended with animation in red (#ff0000).</span></span><br><span class=\"line\"><span class=\"attr\">    name:</span> <span class=\"string\">user</span></span><br><span class=\"line\">    <span class=\"comment\"># If you want to animate the icon, set it to true.</span></span><br><span class=\"line\"><span class=\"attr\">    animated:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">    <span class=\"comment\"># Change the color of icon, using Hex Code.</span></span><br><span class=\"line\"><span class=\"attr\">    color:</span> <span class=\"string\">\"#808080\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># If not defined, `author` from Hexo main config will be used.</span></span><br><span class=\"line\"><span class=\"attr\">  copyright:</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">  powered:</span></span><br><span class=\"line\">    <span class=\"comment\"># Hexo link (Powered by Hexo).</span></span><br><span class=\"line\"><span class=\"attr\">    enable:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">    <span class=\"comment\"># Version info of Hexo after Hexo link (vX.X.X).</span></span><br><span class=\"line\"><span class=\"attr\">    version:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">  theme:</span></span><br><span class=\"line\">    <span class=\"comment\"># Theme &amp; scheme info link (Theme - NexT.scheme).</span></span><br><span class=\"line\"><span class=\"attr\">    enable:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">    <span class=\"comment\"># Version info of NexT after scheme info (vX.X.X).</span></span><br><span class=\"line\"><span class=\"attr\">    version:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># Beian icp information for Chinese users. In China, every legal website should have a beian icp in website footer.</span></span><br><span class=\"line\">  <span class=\"comment\"># http://www.beian.miit.gov.cn</span></span><br><span class=\"line\"><span class=\"attr\">  beian:</span></span><br><span class=\"line\"><span class=\"attr\">    enable:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">    icp:</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># Any custom text can be defined here.</span></span><br><span class=\"line\">  <span class=\"comment\">#custom_text: Hosted by &lt;a href=\"https://pages.coding.me\" class=\"theme-link\" rel=\"noopener\" target=\"_blank\"&gt;Coding Pages&lt;/a&gt;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li><ol start=\"3\">\n<li>增加更新时间</li>\n</ol>\n</li>\n</ul>\n<p>修改<strong>主题配置</strong>文件</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Post meta display settings</span></span><br><span class=\"line\"><span class=\"attr\">post_meta:</span></span><br><span class=\"line\"><span class=\"attr\">  item_text:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  created_at:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  updated_at:</span></span><br><span class=\"line\"><span class=\"attr\">    enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">    another_day:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  categories:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n<p>写文章的时候可以直接在文章开头设置更新时间updated: 2019-05-04 12:00:00(注意格式)。没有这参数的话将会显示md文件的修改日期</p>\n<ul>\n<li><ol start=\"4\">\n<li>增加阅读次数</li>\n</ol>\n</li>\n</ul>\n<p>修改<strong>主题配置文件</strong></p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Show Views / Visitors of the website / page with busuanzi.</span></span><br><span class=\"line\"><span class=\"comment\"># Get more information on http://ibruce.info/2015/04/04/busuanzi</span></span><br><span class=\"line\"><span class=\"attr\">busuanzi_count:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  total_visitors:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  total_visitors_icon:</span> <span class=\"string\">user</span></span><br><span class=\"line\"><span class=\"attr\">  total_views:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  total_views_icon:</span> <span class=\"string\">eye</span></span><br><span class=\"line\"><span class=\"attr\">  post_views:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  post_views_icon:</span> <span class=\"string\">eye</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>主页只显示摘要，点击查看更多才能看全文</li>\n</ul>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">摘要</span><br><span class=\"line\"><span class=\"comment\">&lt;!-- more --&gt;</span></span><br><span class=\"line\">正文</span><br></pre></td></tr></table></figure>\n<h2 id=\"3-基本操作\"><a href=\"#3-基本操作\" class=\"headerlink\" title=\"3. 基本操作\"></a>3. 基本操作</h2><h3 id=\"3-1-新建文章\"><a href=\"#3-1-新建文章\" class=\"headerlink\" title=\"3-1. 新建文章\"></a>3-1. 新建文章</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></span><br><span class=\"line\">$ hexo n &lt;title&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-2-启动服务\"><a href=\"#3-2-启动服务\" class=\"headerlink\" title=\"3-2. 启动服务\"></a>3-2. 启动服务</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br><span class=\"line\">$ hexo s</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-3-生成静态文件\"><a href=\"#3-3-生成静态文件\" class=\"headerlink\" title=\"3-3. 生成静态文件\"></a>3-3. 生成静态文件</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br><span class=\"line\">$ hexo g</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-4-部署到服务器\"><a href=\"#3-4-部署到服务器\" class=\"headerlink\" title=\"3-4. 部署到服务器\"></a>3-4. 部署到服务器</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br><span class=\"line\">$ hexo d</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-5-其他命令\"><a href=\"#3-5-其他命令\" class=\"headerlink\" title=\"3-5. 其他命令\"></a>3-5. 其他命令</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 清除缓存文件 (db.json) 和已生成的静态文件 (public)</span></span><br><span class=\"line\">$ hexo clean</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 列出网站资料</span></span><br><span class=\"line\">$ hexo list &lt;<span class=\"built_in\">type</span>&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 显示hexo版本</span></span><br><span class=\"line\">$ hexo version</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 显示草稿</span></span><br><span class=\"line\">$ hexo draft</span><br></pre></td></tr></table></figure>\n<h2 id=\"4-官方文档\"><a href=\"#4-官方文档\" class=\"headerlink\" title=\"4. 官方文档\"></a>4. 官方文档</h2><h3 id=\"4-1-写作\"><a href=\"#4-1-写作\" class=\"headerlink\" title=\"4-1. 写作\"></a>4-1. 写作</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo <span class=\"keyword\">new</span> [layout] &lt;title&gt;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><ol>\n<li>布局<br>文章布局layout，默认post，可以通过修改_config.yml中的<code>default_layout</code>来指定默认布局<br>Hexo有三种默认布局: post(source/<em>posts</em>), page(source), draft(source/<em>draft</em>)。 自定义的布局，存储到_post文件夹中</li>\n</ol>\n</li>\n<li><ol start=\"2\">\n<li>文件名<br>Hexo 默认以标题做为文件名称。可修改<strong>站点配置文件</strong>_config.yml中<code>new_post_name</code>修改文件名，如：<code>:year-:month-:day-:title.md</code></li>\n</ol>\n</li>\n<li><ol start=\"3\">\n<li>草稿<br>发布草稿命令<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo publish [layout] &lt;title&gt;</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n</li>\n<li><ol start=\"4\">\n<li>模板<br>使用模板命令<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo <span class=\"keyword\">new</span> photo &lt;title&gt;</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n</li>\n</ul>\n<p>在执行这行指令时，Hexo 会尝试在 scaffolds 文件夹中寻找 photo.md</p>\n<ul>\n<li><ol start=\"5\">\n<li>文章头文件格式</li>\n</ol>\n</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">参数</th>\n<th style=\"text-align:center\">描述</th>\n<th style=\"text-align:center\">默认值</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">layout</td>\n<td style=\"text-align:center\">布局</td>\n<td style=\"text-align:center\">post</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">title</td>\n<td style=\"text-align:center\">标题</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">date</td>\n<td style=\"text-align:center\">建立日期</td>\n<td style=\"text-align:center\">文件建立日期</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">updated</td>\n<td style=\"text-align:center\">更新日期</td>\n<td style=\"text-align:center\">文件更新日期</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">comments</td>\n<td style=\"text-align:center\">开启文章评论功能</td>\n<td style=\"text-align:center\">true</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">tags</td>\n<td style=\"text-align:center\">标签</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">category</td>\n<td style=\"text-align:center\">分类</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">permalink</td>\n<td style=\"text-align:center\">覆盖文章网址</td>\n</tr>\n</tbody>\n</table>\n<p>注：分类具有顺序性和层次性；而标签没有顺序和层次。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">categories:</span><br><span class=\"line\">- Diary</span><br><span class=\"line\">- Life</span><br></pre></td></tr></table></figure>\n<p>会使分类Life成为Diary的子分类，而不是并列分类。因此，有必要为您的文章选择尽可能准确的分类。</p>\n<h3 id=\"4-2-插入引用\"><a href=\"#4-2-插入引用\" class=\"headerlink\" title=\"4-2. 插入引用\"></a>4-2. <a href=\"https://hexo.io/zh-cn/docs/tag-plugins\" target=\"_blank\" rel=\"noopener\">插入引用</a></h3><ul>\n<li><ol>\n<li>引用块</li>\n</ol>\n</li>\n</ul>\n<p>语法：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% blockquote [author[, <span class=\"built_in\">source</span>]] [link] [source_link_title] %&#125;</span><br><span class=\"line\">content</span><br><span class=\"line\">&#123;% endblockquote %&#125;</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><ol start=\"2\">\n<li>代码块</li>\n</ol>\n</li>\n</ul>\n<p>语法：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% codeblock [title] [lang:language] [url] [link text] %&#125;</span><br><span class=\"line\">code snippet</span><br><span class=\"line\">&#123;% endcodeblock %&#125;</span><br></pre></td></tr></table></figure></p>\n<p>另一种形式的代码块，不同的是它使用三个反引号来包裹。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">​``` [language] [title] [url] [link text] code snippet</span><br></pre></td></tr></table></figure>\n<h3 id=\"4-3-插入图片\"><a href=\"#4-3-插入图片\" class=\"headerlink\" title=\"4-3. 插入图片\"></a>4-3. 插入图片</h3><ul>\n<li><ol>\n<li>设置站点配置_config.yml</li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">post_asset_folder: <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li><ol start=\"2\">\n<li>安装插件<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install hexo-asset-image -- save</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n</li>\n</ul>\n<p>下次新建文章时，除了生成.md文件外还生成一个同名文件<br>添加图片时使用markdown语法, 注意path只是文件的title，如果自定义了文件名，文件名前面的日期不需要写入<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">![image](path)</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"5-博客源码提交到Github\"><a href=\"#5-博客源码提交到Github\" class=\"headerlink\" title=\"5. 博客源码提交到Github\"></a>5. 博客源码提交到Github</h2><p>将博客原文放在hexo分支上，博客静态文件放在master分支上</p>\n<p>1.新建Blog项目，并在github上创建分支,如hexo</p>\n<p>2.github上修改项目的默认分支为hexo</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190504112516.png\" alt></p>\n<p>3.clone项目到本地目录下<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/hyman213/Blog.git</span><br></pre></td></tr></table></figure></p>\n<p>4.执行git命令, 将文科原文保存到分支hexo上</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git remote add origin https://github.com/hyman213/Blog.git</span><br><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m <span class=\"string\">\"init commit\"</span></span><br><span class=\"line\">git push origin hexo</span><br></pre></td></tr></table></figure>\n<p>5.配置hexo deploy配置，提交到master分支</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">deploy:</span><br><span class=\"line\">  <span class=\"built_in\">type</span>: git</span><br><span class=\"line\">  repository: git@github.com:hyman213/Blog.git</span><br><span class=\"line\">  branch: master</span><br></pre></td></tr></table></figure>\n<p>静态文件发布命令<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo clean</span><br><span class=\"line\">$ hexo g</span><br><span class=\"line\">$ hexo d</span><br></pre></td></tr></table></figure></p>\n<p>今后博客的维护更新：</p>\n<ol>\n<li>新增文章, hexo new “article title”</li>\n<li>文章编辑完成后，利用github提交源码到github hexo分支</li>\n<li>执行hexo clean、hexo g、hexo d，将博客页面上传到github master分支, 即可更新博客</li>\n</ol>\n<h2 id=\"6-注意点\"><a href=\"#6-注意点\" class=\"headerlink\" title=\"6. 注意点\"></a>6. 注意点</h2><ul>\n<li><ol>\n<li>Setting / GitHubPages<br><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190504225102.png\" alt></li>\n</ol>\n</li>\n<li><ol start=\"2\">\n<li>Blog项目不是根目录，而是作为github.io的子目录。在站点配置文件中需要设置</li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> URL</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\"># If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'</span></span></span><br><span class=\"line\">url: http://yoursite.com</span><br><span class=\"line\">root: /Blog/</span><br><span class=\"line\">permalink: :year/:month/:day/:title/</span><br><span class=\"line\">permalink_defaults:</span><br></pre></td></tr></table></figure>\n<p>参考：</p>\n<ul>\n<li><a href=\"https://www.simon96.online/2018/10/12/hexo-tutorial/\" target=\"_blank\" rel=\"noopener\">https://www.simon96.online/2018/10/12/hexo-tutorial/</a></li>\n<li><a href=\"https://www.cnblogs.com/xingyunblog/p/9685548.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/xingyunblog/p/9685548.html</a></li>\n</ul>"},{"title":"Git学习笔记","date":"2019-05-07T13:37:56.000Z","toc_number":false,"_content":"\n\n\nGit是分布式版本控制系统，Git中每个人的电脑就是一个完整的版本库，当多人协作时，只需把各自的修改推送给对方。\n\n<!--more-->\n\n## 1. Git是什么\n\nGit是分布式版本控制系统\n官网:[https://git-scm.com/](https://git-scm.com/)\n\n### 1-1. 工作原理 / 流程\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502000850.png)\n\n* Workspace: 工作区\n* Index / Stage: 暂存区\n* Repository: 仓库区（或本地仓库）\n* Remote: 远程仓库\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502002525.png)\n\n### 1-2. SVN与Git的主要区别\n\nSVN-集中式版本控制系统，版本库放在中央服务器。以中央服务器的版本为基准，干活前需要先同步中央服务器得到最新的版本，自己本地的更新也需要推送到中央服务器。\n\nGit是分布式版本控制系统，Git中每个人的电脑就是一个完整的版本库，当多人协作时，只需把各自的修改推送给对方。\n\n## 2. Git安装使用\n\n### 2-1. Git安装\n\n参照Git官网下载安装,安装完成后鼠标右键菜单多了2个选项\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502145216.png)\n\n### 2-2. Git初始化用户信息\n\n设置用户全局配置：\n\n```shell\ngit config --global user.name \"[name]\"\nSets the name you want to attached to your transactions\n\ngit config --global user.email \"[email address]\"\nSets the email you want to attached to your transactions\n\ngit config --global color.ui auto\nEnables helpful colorization of command line output\n```\n\n查看用户信息配置\n\n```shell\ngit config user.name\ngit config user.email\n```\n\n### 2-3. GitHub配置SSH公钥\n\n```shell\nssh-keygen -t rsa -C '[email address using in github]'\n```\n\n* 在Git Bash输入以上命令后，回车后再按三个回车(默认存储位置，密码为空，确认密码)。\n\n* 将上一步生成的公钥路径：C:\\Users\\你的用户名\\\\.ssh。id_rsa是私钥，不能泄露出去，id_rsa.pub是公钥，可以放心地告诉任何人。\n\n* 将生成的公钥(id_rsa.pub)添加到GitHub:选择头像-->Settings-->SSH and GPG keys\n\n### 2-4. [Git GUI Clients](https://git-scm.com/downloads/guis)\n\n* GitHub Desktop\n* TortoiseGit\n* Git Extensions\n* ...\n\n## 3. Git管理代码仓库\n\n### 3-1. 创建版本库\n\nRepository可以理解为一个目录，这个目录里面的所有文件都可以被Git管理起来。\n\n```shell\n$ mkdir testgit\n$ cd testgit/\n$ git init\nInitialized empty Git repository in D:/WorkSpaces/testgit/.git/\n```\n\n执行上面的操作，gittest就成为了一个Git仓库。在testgit目录下自动新增了一个.git文件夹\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502150628.png)\n\n新建readme.txt文件并提交\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502151123.png)\n\n继续修改readme.txt文件后，提交修改\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502152011.png)\n\n发现每次都会有warning: LF will be replaced by CRLF in readme.txt.提示。\n\n原因是不同操作系统中换行符的标识不同\n\n* CRLF->Windows-style\n\n* LF->Unix Style\n\n* CR->Mac Style\n\n可通过如下命令进行转换设置\n\n```shell\ngit config --global core.autocrlf true/false/inout\n```\n\n* true，添加文件到git仓库时，git将其视为文本文件。他将把crlf变成lf\n* false，line-endings将不做转换操作。文本文件保持原来的样子。\n* input，添加文件git仓库石，git把crlf编程lf。当有人Check代码时还是lf方式。因此在window操作系统下，不要使用这个设置\n\n### 3-2 版本回退\n\n继续修改readme.txt文件，新增\"33333333\"并提交\n\n查看修改的历史记录\n\n```shell\ngit log\ngit log --pretty=oneline\ngit reflog\n```\n\ngit log 与git reflog的区别\n\n1) git log: commit 的版本日志 包含提交的版本 操作者 日期 (方便查看commit的版本,但是版本回退后,使用git log 看不到回退版本号之后的版本记录) \n\n2) git reflog: 使用git 命令进行操作的日志  包括当前步骤所在哪个版本(一个commit 产生一个版本, 指定版本回退只能回退到该commit) 以及操作的具体内容\n\n版本回退后,仍然可以看到所有的版本记录 方便查看每个操作步骤所在的版本,可以根据版本号自由前进后退\n\n版本回退操作\n\n```shell\ngit reset --hard HEAD^\ngit reset --hard HEAD^^\ngit reset --hard HEAD~100\ngit reset --hard '版本号'\n```\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502155810.png)\n\n### 3-3. 撤销和删除文件\n\n#### 3-3-1. 撤销修改\n\n```shell\n# 丢弃工作区的修改。--很重要，没有--的话命令就变成创建分支了\ngit checkout -- file\n```\n\n有2种情况：\n\n* 文件修改后，还没有放到暂存区，使用撤销修改就回到和版本库一模一样的状态\n* 另外一种是文件的修改已经放入暂存区了，接着又作了修改，撤销修改就回到添加暂存区后的状态\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502162025.png)\n\n#### 3-3-2. 删除文件\n\n删除文件后再commit到git，如果删除并提交到暂存区后，可执行checkout操作恢复删除的文件\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502162924.png)\n\n\n\n## 4. 远程仓库\n\n### 4-1. 注册GitHub，并在本地创建SSH添加到GitHub \n\n操作参照步骤2-3\n\n### 4-2. 添加远程库\n\n#### 4-2-1. 本地先有仓库，然后关联到远程库\n\n* 1. 在GitHub上创建仓库\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502171256.png)\n\n* 2. 在本地仓库目录下运行命令\n\n```shell\ngit remote add origin https://github.com/hyman213/testgit.git\n# 第一次推送\ngit push -u origin master\n# 之后的推送\ngit push origin master\n```\n\n我们第一次推送master分支时，加上了 –u参数，Git不但会把本地的master分支内容推送的远程新的master分支，还会把本地的master分支和远程的master分支关联起来，在以后的推送或者拉取时就可以简化命令。\n\n\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502171627.png)\n\n此时本地仓库的内容就上传到了远程库\n\n再次修改本地库的readme.txt文件，测试上传更新到远程库\n\n```shell\n$ vi readme.txt\n$ git status\n$ git add readme.txt\n$ git commit -m '增加了55555555和66666666'\n$ git push origin master\n```\n\n刷新GitHub上内容，内容与本地库一致，本地内容成功推送到可远程库\n\n#### 4-2-2. 先有远程仓库\n\n* 1. 在GitHub上创建仓库testgit2\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502172525.png)\n\n* 2. 在本地clone远程库的内容, 注意clone下来内容会在当前路径生成新文件夹testgit2\n\n```shell\n$ git clone https://github.com/hyman213/testgit2.git\n```\n\n* 3. 测试在本地增加readme.txt文件，并上传推送到远程库\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502173248.png)\n\n\n\n## 5. 分支-branch\n\n> 每次提交，Git都把它们串成一条时间线，这条时间线就是一个分支。截止到目前，只有一条时间线，在Git里，这个分支叫主分支，即master分支。HEAD严格来说不是指向提交，而是指向master，master才是指向提交的，所以，HEAD指向的就是当前分支\n\n\n\n用到的命令有\n\n```shell\n# 创建分支dev\ngit branch dev\n# 切换到dev分支\ngit checkout dev\n# 上面两个命令合并\ngit checkout -b dev\n# 查看分支(列出所有分支,当前分支会添加一个星号)\ngit branch\n# 合并分支(将dev分支上的更新合并到当前分支)\ngit merge dev\n# 删除分支\ngit branch -d dev\n```\n\n\n\n### 5-1. 创建分支\n\n\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502223958.png)\n\n切换到dev分支，然后在dev分支上进行修改。\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502225423.png)\n\n切换到master分支，查看readme.txt文件。内容没有修改\n\n### 5-2. 合并/删除分支\n\n将dev分支上的修改合并到master分支上\n\n![1556808994739](C:\\Users\\idobe\\AppData\\Roaming\\Typora\\typora-user-images\\1556808994739.png)\n\n通常合并分支时，git一般使用\"Fast forward\"模式，在这种模式下，删除分支后，会丢掉分支信息，现在我们来使用带参数 –no-ff来禁用”Fast forward”模式\n\n禁用”Fast forward”模式合并分支\n\n```shell\ngit merge --no-ff -m \"merge with mo-ff\" dev\n```\n\n### 5-3. 解决分支冲突\n\n新建分支branch1,在branch1分支和master分支分别修改readme.txt文件并提交。然后将branch1分支的修改合并到master分支。\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502231618.png)\n\n查看冲突并解决冲突后，再次提交文件\n\n![1556810416998](C:\\Users\\idobe\\AppData\\Roaming\\Typora\\typora-user-images\\1556810416998.png)\n\n### 5-4. 分支管理\n\n首先master主分支应该是非常稳定的，也就是用来发布新版本，一般情况下不允许在上面干活，干活一般情况下在新建的dev分支上干活，干完后，比如上要发布，或者说dev分支代码稳定后可以合并到主分支master上来\n\n> bug分支: 在开发中，会经常碰到bug问题，那么有了bug就需要修复，在Git中，分支是很强大的，每个bug都可以通过一个临时分支来修复，修复完成后，合并分支，然后将临时的分支删除掉。\n\n在dev分支修改readme.txt的内容，然后紧急有个bug需要修复, 需要新增分支在master基础上进行修复。需要先将dev分支上的修改隐藏\n\n```shell\n# 将当前分支的修改隐藏\ngit stash\n# 列出隐藏的修改\ngit stash list\n# 恢复隐藏的修改\ngit stash apply\n# 删除stash\ngit stash drop\n# 恢复的同时删除\ngit stash pop\n```\n\n## 6. 多人协作\n\n### 6-1. 查看远程库信息\n\n```shell\ngit remote\n# 详细信息\ngit remote -v\n```\n\n### 6-2. 推送分支\n\n推送分支就是把该分支上所有本地提交到远程库中，推送时，要指定本地分支\n\n```shell\n# 推送master分支\ngit push origin master\n# 推送dev分支\ngit push origin dev\n```\n\n修改dev分支的内容，并将dev分支推送到远程库，结果远程库会新增dev分支\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190503000207.png)\n\n\n\ngitHub上新增分支dev\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190503000251.png)\n\n\n\nmaster分支是主分支，因此要时刻与远程同步。\n\n一些修复bug分支不需要推送到远程去，可以先合并到主分支上，然后把主分支master推送到远程去。\n\n### 6-3. 抓取分支\n\n将远程的origin的dev分支同步到本地\n\n```shell\ngit checkout -b dev origin/dev\n```\n\n现在就可以在dev分支上做开发了，开发完成后把dev分支推送到远程库。\n\n```shell\ngit push origin dev\n```\n\n抓取远程仓库\n\n```shell\ngit pull\n# 指定den分支与远程origin/dev分支的链接\ngit branch --set-upstream-to dev origin/dev\n```\n\n\n\n多人协作工作模式一般是这样的：\n\n- 首先，可以试图用git push origin branch-name推送自己的修改.\n- 如果推送失败，则因为远程分支比你的本地更新早，需要先用git pull试图合并。\n- 如果合并有冲突，则需要解决冲突，并在本地提交。再用git push origin branch-name推送。\n\n\n\n## 7. GitHub-Git Cheat Sheet\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190507214432.png)\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190507214558.png)","source":"_posts/20190507-Git学习笔记.md","raw":"---\ntitle: Git学习笔记\ndate: 2019-05-07 21:37:56\ntags: Git\ncategory: Tools\ntoc_number: false\n---\n\n\n\nGit是分布式版本控制系统，Git中每个人的电脑就是一个完整的版本库，当多人协作时，只需把各自的修改推送给对方。\n\n<!--more-->\n\n## 1. Git是什么\n\nGit是分布式版本控制系统\n官网:[https://git-scm.com/](https://git-scm.com/)\n\n### 1-1. 工作原理 / 流程\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502000850.png)\n\n* Workspace: 工作区\n* Index / Stage: 暂存区\n* Repository: 仓库区（或本地仓库）\n* Remote: 远程仓库\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502002525.png)\n\n### 1-2. SVN与Git的主要区别\n\nSVN-集中式版本控制系统，版本库放在中央服务器。以中央服务器的版本为基准，干活前需要先同步中央服务器得到最新的版本，自己本地的更新也需要推送到中央服务器。\n\nGit是分布式版本控制系统，Git中每个人的电脑就是一个完整的版本库，当多人协作时，只需把各自的修改推送给对方。\n\n## 2. Git安装使用\n\n### 2-1. Git安装\n\n参照Git官网下载安装,安装完成后鼠标右键菜单多了2个选项\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502145216.png)\n\n### 2-2. Git初始化用户信息\n\n设置用户全局配置：\n\n```shell\ngit config --global user.name \"[name]\"\nSets the name you want to attached to your transactions\n\ngit config --global user.email \"[email address]\"\nSets the email you want to attached to your transactions\n\ngit config --global color.ui auto\nEnables helpful colorization of command line output\n```\n\n查看用户信息配置\n\n```shell\ngit config user.name\ngit config user.email\n```\n\n### 2-3. GitHub配置SSH公钥\n\n```shell\nssh-keygen -t rsa -C '[email address using in github]'\n```\n\n* 在Git Bash输入以上命令后，回车后再按三个回车(默认存储位置，密码为空，确认密码)。\n\n* 将上一步生成的公钥路径：C:\\Users\\你的用户名\\\\.ssh。id_rsa是私钥，不能泄露出去，id_rsa.pub是公钥，可以放心地告诉任何人。\n\n* 将生成的公钥(id_rsa.pub)添加到GitHub:选择头像-->Settings-->SSH and GPG keys\n\n### 2-4. [Git GUI Clients](https://git-scm.com/downloads/guis)\n\n* GitHub Desktop\n* TortoiseGit\n* Git Extensions\n* ...\n\n## 3. Git管理代码仓库\n\n### 3-1. 创建版本库\n\nRepository可以理解为一个目录，这个目录里面的所有文件都可以被Git管理起来。\n\n```shell\n$ mkdir testgit\n$ cd testgit/\n$ git init\nInitialized empty Git repository in D:/WorkSpaces/testgit/.git/\n```\n\n执行上面的操作，gittest就成为了一个Git仓库。在testgit目录下自动新增了一个.git文件夹\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502150628.png)\n\n新建readme.txt文件并提交\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502151123.png)\n\n继续修改readme.txt文件后，提交修改\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502152011.png)\n\n发现每次都会有warning: LF will be replaced by CRLF in readme.txt.提示。\n\n原因是不同操作系统中换行符的标识不同\n\n* CRLF->Windows-style\n\n* LF->Unix Style\n\n* CR->Mac Style\n\n可通过如下命令进行转换设置\n\n```shell\ngit config --global core.autocrlf true/false/inout\n```\n\n* true，添加文件到git仓库时，git将其视为文本文件。他将把crlf变成lf\n* false，line-endings将不做转换操作。文本文件保持原来的样子。\n* input，添加文件git仓库石，git把crlf编程lf。当有人Check代码时还是lf方式。因此在window操作系统下，不要使用这个设置\n\n### 3-2 版本回退\n\n继续修改readme.txt文件，新增\"33333333\"并提交\n\n查看修改的历史记录\n\n```shell\ngit log\ngit log --pretty=oneline\ngit reflog\n```\n\ngit log 与git reflog的区别\n\n1) git log: commit 的版本日志 包含提交的版本 操作者 日期 (方便查看commit的版本,但是版本回退后,使用git log 看不到回退版本号之后的版本记录) \n\n2) git reflog: 使用git 命令进行操作的日志  包括当前步骤所在哪个版本(一个commit 产生一个版本, 指定版本回退只能回退到该commit) 以及操作的具体内容\n\n版本回退后,仍然可以看到所有的版本记录 方便查看每个操作步骤所在的版本,可以根据版本号自由前进后退\n\n版本回退操作\n\n```shell\ngit reset --hard HEAD^\ngit reset --hard HEAD^^\ngit reset --hard HEAD~100\ngit reset --hard '版本号'\n```\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502155810.png)\n\n### 3-3. 撤销和删除文件\n\n#### 3-3-1. 撤销修改\n\n```shell\n# 丢弃工作区的修改。--很重要，没有--的话命令就变成创建分支了\ngit checkout -- file\n```\n\n有2种情况：\n\n* 文件修改后，还没有放到暂存区，使用撤销修改就回到和版本库一模一样的状态\n* 另外一种是文件的修改已经放入暂存区了，接着又作了修改，撤销修改就回到添加暂存区后的状态\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502162025.png)\n\n#### 3-3-2. 删除文件\n\n删除文件后再commit到git，如果删除并提交到暂存区后，可执行checkout操作恢复删除的文件\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502162924.png)\n\n\n\n## 4. 远程仓库\n\n### 4-1. 注册GitHub，并在本地创建SSH添加到GitHub \n\n操作参照步骤2-3\n\n### 4-2. 添加远程库\n\n#### 4-2-1. 本地先有仓库，然后关联到远程库\n\n* 1. 在GitHub上创建仓库\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502171256.png)\n\n* 2. 在本地仓库目录下运行命令\n\n```shell\ngit remote add origin https://github.com/hyman213/testgit.git\n# 第一次推送\ngit push -u origin master\n# 之后的推送\ngit push origin master\n```\n\n我们第一次推送master分支时，加上了 –u参数，Git不但会把本地的master分支内容推送的远程新的master分支，还会把本地的master分支和远程的master分支关联起来，在以后的推送或者拉取时就可以简化命令。\n\n\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502171627.png)\n\n此时本地仓库的内容就上传到了远程库\n\n再次修改本地库的readme.txt文件，测试上传更新到远程库\n\n```shell\n$ vi readme.txt\n$ git status\n$ git add readme.txt\n$ git commit -m '增加了55555555和66666666'\n$ git push origin master\n```\n\n刷新GitHub上内容，内容与本地库一致，本地内容成功推送到可远程库\n\n#### 4-2-2. 先有远程仓库\n\n* 1. 在GitHub上创建仓库testgit2\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502172525.png)\n\n* 2. 在本地clone远程库的内容, 注意clone下来内容会在当前路径生成新文件夹testgit2\n\n```shell\n$ git clone https://github.com/hyman213/testgit2.git\n```\n\n* 3. 测试在本地增加readme.txt文件，并上传推送到远程库\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502173248.png)\n\n\n\n## 5. 分支-branch\n\n> 每次提交，Git都把它们串成一条时间线，这条时间线就是一个分支。截止到目前，只有一条时间线，在Git里，这个分支叫主分支，即master分支。HEAD严格来说不是指向提交，而是指向master，master才是指向提交的，所以，HEAD指向的就是当前分支\n\n\n\n用到的命令有\n\n```shell\n# 创建分支dev\ngit branch dev\n# 切换到dev分支\ngit checkout dev\n# 上面两个命令合并\ngit checkout -b dev\n# 查看分支(列出所有分支,当前分支会添加一个星号)\ngit branch\n# 合并分支(将dev分支上的更新合并到当前分支)\ngit merge dev\n# 删除分支\ngit branch -d dev\n```\n\n\n\n### 5-1. 创建分支\n\n\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502223958.png)\n\n切换到dev分支，然后在dev分支上进行修改。\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502225423.png)\n\n切换到master分支，查看readme.txt文件。内容没有修改\n\n### 5-2. 合并/删除分支\n\n将dev分支上的修改合并到master分支上\n\n![1556808994739](C:\\Users\\idobe\\AppData\\Roaming\\Typora\\typora-user-images\\1556808994739.png)\n\n通常合并分支时，git一般使用\"Fast forward\"模式，在这种模式下，删除分支后，会丢掉分支信息，现在我们来使用带参数 –no-ff来禁用”Fast forward”模式\n\n禁用”Fast forward”模式合并分支\n\n```shell\ngit merge --no-ff -m \"merge with mo-ff\" dev\n```\n\n### 5-3. 解决分支冲突\n\n新建分支branch1,在branch1分支和master分支分别修改readme.txt文件并提交。然后将branch1分支的修改合并到master分支。\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502231618.png)\n\n查看冲突并解决冲突后，再次提交文件\n\n![1556810416998](C:\\Users\\idobe\\AppData\\Roaming\\Typora\\typora-user-images\\1556810416998.png)\n\n### 5-4. 分支管理\n\n首先master主分支应该是非常稳定的，也就是用来发布新版本，一般情况下不允许在上面干活，干活一般情况下在新建的dev分支上干活，干完后，比如上要发布，或者说dev分支代码稳定后可以合并到主分支master上来\n\n> bug分支: 在开发中，会经常碰到bug问题，那么有了bug就需要修复，在Git中，分支是很强大的，每个bug都可以通过一个临时分支来修复，修复完成后，合并分支，然后将临时的分支删除掉。\n\n在dev分支修改readme.txt的内容，然后紧急有个bug需要修复, 需要新增分支在master基础上进行修复。需要先将dev分支上的修改隐藏\n\n```shell\n# 将当前分支的修改隐藏\ngit stash\n# 列出隐藏的修改\ngit stash list\n# 恢复隐藏的修改\ngit stash apply\n# 删除stash\ngit stash drop\n# 恢复的同时删除\ngit stash pop\n```\n\n## 6. 多人协作\n\n### 6-1. 查看远程库信息\n\n```shell\ngit remote\n# 详细信息\ngit remote -v\n```\n\n### 6-2. 推送分支\n\n推送分支就是把该分支上所有本地提交到远程库中，推送时，要指定本地分支\n\n```shell\n# 推送master分支\ngit push origin master\n# 推送dev分支\ngit push origin dev\n```\n\n修改dev分支的内容，并将dev分支推送到远程库，结果远程库会新增dev分支\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190503000207.png)\n\n\n\ngitHub上新增分支dev\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190503000251.png)\n\n\n\nmaster分支是主分支，因此要时刻与远程同步。\n\n一些修复bug分支不需要推送到远程去，可以先合并到主分支上，然后把主分支master推送到远程去。\n\n### 6-3. 抓取分支\n\n将远程的origin的dev分支同步到本地\n\n```shell\ngit checkout -b dev origin/dev\n```\n\n现在就可以在dev分支上做开发了，开发完成后把dev分支推送到远程库。\n\n```shell\ngit push origin dev\n```\n\n抓取远程仓库\n\n```shell\ngit pull\n# 指定den分支与远程origin/dev分支的链接\ngit branch --set-upstream-to dev origin/dev\n```\n\n\n\n多人协作工作模式一般是这样的：\n\n- 首先，可以试图用git push origin branch-name推送自己的修改.\n- 如果推送失败，则因为远程分支比你的本地更新早，需要先用git pull试图合并。\n- 如果合并有冲突，则需要解决冲突，并在本地提交。再用git push origin branch-name推送。\n\n\n\n## 7. GitHub-Git Cheat Sheet\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190507214432.png)\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190507214558.png)","slug":"Git学习笔记","published":1,"updated":"2019-05-07T14:09:17.811Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck27dih1k0002mskp58dr3i9v","content":"<p>Git是分布式版本控制系统，Git中每个人的电脑就是一个完整的版本库，当多人协作时，只需把各自的修改推送给对方。</p>\n<a id=\"more\"></a>\n<h2 id=\"1-Git是什么\"><a href=\"#1-Git是什么\" class=\"headerlink\" title=\"1. Git是什么\"></a>1. Git是什么</h2><p>Git是分布式版本控制系统<br>官网:<a href=\"https://git-scm.com/\" target=\"_blank\" rel=\"noopener\">https://git-scm.com/</a></p>\n<h3 id=\"1-1-工作原理-流程\"><a href=\"#1-1-工作原理-流程\" class=\"headerlink\" title=\"1-1. 工作原理 / 流程\"></a>1-1. 工作原理 / 流程</h3><p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502000850.png\" alt></p>\n<ul>\n<li>Workspace: 工作区</li>\n<li>Index / Stage: 暂存区</li>\n<li>Repository: 仓库区（或本地仓库）</li>\n<li>Remote: 远程仓库</li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502002525.png\" alt></p>\n<h3 id=\"1-2-SVN与Git的主要区别\"><a href=\"#1-2-SVN与Git的主要区别\" class=\"headerlink\" title=\"1-2. SVN与Git的主要区别\"></a>1-2. SVN与Git的主要区别</h3><p>SVN-集中式版本控制系统，版本库放在中央服务器。以中央服务器的版本为基准，干活前需要先同步中央服务器得到最新的版本，自己本地的更新也需要推送到中央服务器。</p>\n<p>Git是分布式版本控制系统，Git中每个人的电脑就是一个完整的版本库，当多人协作时，只需把各自的修改推送给对方。</p>\n<h2 id=\"2-Git安装使用\"><a href=\"#2-Git安装使用\" class=\"headerlink\" title=\"2. Git安装使用\"></a>2. Git安装使用</h2><h3 id=\"2-1-Git安装\"><a href=\"#2-1-Git安装\" class=\"headerlink\" title=\"2-1. Git安装\"></a>2-1. Git安装</h3><p>参照Git官网下载安装,安装完成后鼠标右键菜单多了2个选项</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502145216.png\" alt></p>\n<h3 id=\"2-2-Git初始化用户信息\"><a href=\"#2-2-Git初始化用户信息\" class=\"headerlink\" title=\"2-2. Git初始化用户信息\"></a>2-2. Git初始化用户信息</h3><p>设置用户全局配置：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config --global user.name \"[name]\"</span><br><span class=\"line\">Sets the name you want to attached to your transactions</span><br><span class=\"line\"></span><br><span class=\"line\">git config --global user.email \"[email address]\"</span><br><span class=\"line\">Sets the email you want to attached to your transactions</span><br><span class=\"line\"></span><br><span class=\"line\">git config --global color.ui auto</span><br><span class=\"line\">Enables helpful colorization of command line output</span><br></pre></td></tr></table></figure>\n<p>查看用户信息配置</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config user.name</span><br><span class=\"line\">git config user.email</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-3-GitHub配置SSH公钥\"><a href=\"#2-3-GitHub配置SSH公钥\" class=\"headerlink\" title=\"2-3. GitHub配置SSH公钥\"></a>2-3. GitHub配置SSH公钥</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -C '[email address using in github]'</span><br></pre></td></tr></table></figure>\n<ul>\n<li><p>在Git Bash输入以上命令后，回车后再按三个回车(默认存储位置，密码为空，确认密码)。</p>\n</li>\n<li><p>将上一步生成的公钥路径：C:\\Users\\你的用户名\\.ssh。id_rsa是私钥，不能泄露出去，id_rsa.pub是公钥，可以放心地告诉任何人。</p>\n</li>\n<li><p>将生成的公钥(id_rsa.pub)添加到GitHub:选择头像–&gt;Settings–&gt;SSH and GPG keys</p>\n</li>\n</ul>\n<h3 id=\"2-4-Git-GUI-Clients\"><a href=\"#2-4-Git-GUI-Clients\" class=\"headerlink\" title=\"2-4. Git GUI Clients\"></a>2-4. <a href=\"https://git-scm.com/downloads/guis\" target=\"_blank\" rel=\"noopener\">Git GUI Clients</a></h3><ul>\n<li>GitHub Desktop</li>\n<li>TortoiseGit</li>\n<li>Git Extensions</li>\n<li>…</li>\n</ul>\n<h2 id=\"3-Git管理代码仓库\"><a href=\"#3-Git管理代码仓库\" class=\"headerlink\" title=\"3. Git管理代码仓库\"></a>3. Git管理代码仓库</h2><h3 id=\"3-1-创建版本库\"><a href=\"#3-1-创建版本库\" class=\"headerlink\" title=\"3-1. 创建版本库\"></a>3-1. 创建版本库</h3><p>Repository可以理解为一个目录，这个目录里面的所有文件都可以被Git管理起来。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> mkdir testgit</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> <span class=\"built_in\">cd</span> testgit/</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> git init</span></span><br><span class=\"line\">Initialized empty Git repository in D:/WorkSpaces/testgit/.git/</span><br></pre></td></tr></table></figure>\n<p>执行上面的操作，gittest就成为了一个Git仓库。在testgit目录下自动新增了一个.git文件夹</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502150628.png\" alt></p>\n<p>新建readme.txt文件并提交</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502151123.png\" alt></p>\n<p>继续修改readme.txt文件后，提交修改</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502152011.png\" alt></p>\n<p>发现每次都会有warning: LF will be replaced by CRLF in readme.txt.提示。</p>\n<p>原因是不同操作系统中换行符的标识不同</p>\n<ul>\n<li><p>CRLF-&gt;Windows-style</p>\n</li>\n<li><p>LF-&gt;Unix Style</p>\n</li>\n<li><p>CR-&gt;Mac Style</p>\n</li>\n</ul>\n<p>可通过如下命令进行转换设置</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config --global core.autocrlf true/false/inout</span><br></pre></td></tr></table></figure>\n<ul>\n<li>true，添加文件到git仓库时，git将其视为文本文件。他将把crlf变成lf</li>\n<li>false，line-endings将不做转换操作。文本文件保持原来的样子。</li>\n<li>input，添加文件git仓库石，git把crlf编程lf。当有人Check代码时还是lf方式。因此在window操作系统下，不要使用这个设置</li>\n</ul>\n<h3 id=\"3-2-版本回退\"><a href=\"#3-2-版本回退\" class=\"headerlink\" title=\"3-2 版本回退\"></a>3-2 版本回退</h3><p>继续修改readme.txt文件，新增”33333333”并提交</p>\n<p>查看修改的历史记录</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git log</span><br><span class=\"line\">git log --pretty=oneline</span><br><span class=\"line\">git reflog</span><br></pre></td></tr></table></figure>\n<p>git log 与git reflog的区别</p>\n<p>1) git log: commit 的版本日志 包含提交的版本 操作者 日期 (方便查看commit的版本,但是版本回退后,使用git log 看不到回退版本号之后的版本记录) </p>\n<p>2) git reflog: 使用git 命令进行操作的日志  包括当前步骤所在哪个版本(一个commit 产生一个版本, 指定版本回退只能回退到该commit) 以及操作的具体内容</p>\n<p>版本回退后,仍然可以看到所有的版本记录 方便查看每个操作步骤所在的版本,可以根据版本号自由前进后退</p>\n<p>版本回退操作</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git reset --hard HEAD^</span><br><span class=\"line\">git reset --hard HEAD^^</span><br><span class=\"line\">git reset --hard HEAD~100</span><br><span class=\"line\">git reset --hard '版本号'</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502155810.png\" alt></p>\n<h3 id=\"3-3-撤销和删除文件\"><a href=\"#3-3-撤销和删除文件\" class=\"headerlink\" title=\"3-3. 撤销和删除文件\"></a>3-3. 撤销和删除文件</h3><h4 id=\"3-3-1-撤销修改\"><a href=\"#3-3-1-撤销修改\" class=\"headerlink\" title=\"3-3-1. 撤销修改\"></a>3-3-1. 撤销修改</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 丢弃工作区的修改。--很重要，没有--的话命令就变成创建分支了</span></span><br><span class=\"line\">git checkout -- file</span><br></pre></td></tr></table></figure>\n<p>有2种情况：</p>\n<ul>\n<li>文件修改后，还没有放到暂存区，使用撤销修改就回到和版本库一模一样的状态</li>\n<li>另外一种是文件的修改已经放入暂存区了，接着又作了修改，撤销修改就回到添加暂存区后的状态</li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502162025.png\" alt></p>\n<h4 id=\"3-3-2-删除文件\"><a href=\"#3-3-2-删除文件\" class=\"headerlink\" title=\"3-3-2. 删除文件\"></a>3-3-2. 删除文件</h4><p>删除文件后再commit到git，如果删除并提交到暂存区后，可执行checkout操作恢复删除的文件</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502162924.png\" alt></p>\n<h2 id=\"4-远程仓库\"><a href=\"#4-远程仓库\" class=\"headerlink\" title=\"4. 远程仓库\"></a>4. 远程仓库</h2><h3 id=\"4-1-注册GitHub，并在本地创建SSH添加到GitHub\"><a href=\"#4-1-注册GitHub，并在本地创建SSH添加到GitHub\" class=\"headerlink\" title=\"4-1. 注册GitHub，并在本地创建SSH添加到GitHub\"></a>4-1. 注册GitHub，并在本地创建SSH添加到GitHub</h3><p>操作参照步骤2-3</p>\n<h3 id=\"4-2-添加远程库\"><a href=\"#4-2-添加远程库\" class=\"headerlink\" title=\"4-2. 添加远程库\"></a>4-2. 添加远程库</h3><h4 id=\"4-2-1-本地先有仓库，然后关联到远程库\"><a href=\"#4-2-1-本地先有仓库，然后关联到远程库\" class=\"headerlink\" title=\"4-2-1. 本地先有仓库，然后关联到远程库\"></a>4-2-1. 本地先有仓库，然后关联到远程库</h4><ul>\n<li><ol>\n<li>在GitHub上创建仓库</li>\n</ol>\n</li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502171256.png\" alt></p>\n<ul>\n<li><ol start=\"2\">\n<li>在本地仓库目录下运行命令</li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git remote add origin https://github.com/hyman213/testgit.git</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 第一次推送</span></span><br><span class=\"line\">git push -u origin master</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 之后的推送</span></span><br><span class=\"line\">git push origin master</span><br></pre></td></tr></table></figure>\n<p>我们第一次推送master分支时，加上了 –u参数，Git不但会把本地的master分支内容推送的远程新的master分支，还会把本地的master分支和远程的master分支关联起来，在以后的推送或者拉取时就可以简化命令。</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502171627.png\" alt></p>\n<p>此时本地仓库的内容就上传到了远程库</p>\n<p>再次修改本地库的readme.txt文件，测试上传更新到远程库</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> vi readme.txt</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> git status</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> git add readme.txt</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> git commit -m <span class=\"string\">'增加了55555555和66666666'</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> git push origin master</span></span><br></pre></td></tr></table></figure>\n<p>刷新GitHub上内容，内容与本地库一致，本地内容成功推送到可远程库</p>\n<h4 id=\"4-2-2-先有远程仓库\"><a href=\"#4-2-2-先有远程仓库\" class=\"headerlink\" title=\"4-2-2. 先有远程仓库\"></a>4-2-2. 先有远程仓库</h4><ul>\n<li><ol>\n<li>在GitHub上创建仓库testgit2</li>\n</ol>\n</li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502172525.png\" alt></p>\n<ul>\n<li><ol start=\"2\">\n<li>在本地clone远程库的内容, 注意clone下来内容会在当前路径生成新文件夹testgit2</li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> git <span class=\"built_in\">clone</span> https://github.com/hyman213/testgit2.git</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li><ol start=\"3\">\n<li>测试在本地增加readme.txt文件，并上传推送到远程库</li>\n</ol>\n</li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502173248.png\" alt></p>\n<h2 id=\"5-分支-branch\"><a href=\"#5-分支-branch\" class=\"headerlink\" title=\"5. 分支-branch\"></a>5. 分支-branch</h2><blockquote>\n<p>每次提交，Git都把它们串成一条时间线，这条时间线就是一个分支。截止到目前，只有一条时间线，在Git里，这个分支叫主分支，即master分支。HEAD严格来说不是指向提交，而是指向master，master才是指向提交的，所以，HEAD指向的就是当前分支</p>\n</blockquote>\n<p>用到的命令有</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 创建分支dev</span></span><br><span class=\"line\">git branch dev</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 切换到dev分支</span></span><br><span class=\"line\">git checkout dev</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 上面两个命令合并</span></span><br><span class=\"line\">git checkout -b dev</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 查看分支(列出所有分支,当前分支会添加一个星号)</span></span><br><span class=\"line\">git branch</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 合并分支(将dev分支上的更新合并到当前分支)</span></span><br><span class=\"line\">git merge dev</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 删除分支</span></span><br><span class=\"line\">git branch -d dev</span><br></pre></td></tr></table></figure>\n<h3 id=\"5-1-创建分支\"><a href=\"#5-1-创建分支\" class=\"headerlink\" title=\"5-1. 创建分支\"></a>5-1. 创建分支</h3><p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502223958.png\" alt></p>\n<p>切换到dev分支，然后在dev分支上进行修改。</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502225423.png\" alt></p>\n<p>切换到master分支，查看readme.txt文件。内容没有修改</p>\n<h3 id=\"5-2-合并-删除分支\"><a href=\"#5-2-合并-删除分支\" class=\"headerlink\" title=\"5-2. 合并/删除分支\"></a>5-2. 合并/删除分支</h3><p>将dev分支上的修改合并到master分支上</p>\n<p><img src=\"C:\\Users\\idobe\\AppData\\Roaming\\Typora\\typora-user-images\\1556808994739.png\" alt=\"1556808994739\"></p>\n<p>通常合并分支时，git一般使用”Fast forward”模式，在这种模式下，删除分支后，会丢掉分支信息，现在我们来使用带参数 –no-ff来禁用”Fast forward”模式</p>\n<p>禁用”Fast forward”模式合并分支</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git merge --no-ff -m \"merge with mo-ff\" dev</span><br></pre></td></tr></table></figure>\n<h3 id=\"5-3-解决分支冲突\"><a href=\"#5-3-解决分支冲突\" class=\"headerlink\" title=\"5-3. 解决分支冲突\"></a>5-3. 解决分支冲突</h3><p>新建分支branch1,在branch1分支和master分支分别修改readme.txt文件并提交。然后将branch1分支的修改合并到master分支。</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502231618.png\" alt></p>\n<p>查看冲突并解决冲突后，再次提交文件</p>\n<p><img src=\"C:\\Users\\idobe\\AppData\\Roaming\\Typora\\typora-user-images\\1556810416998.png\" alt=\"1556810416998\"></p>\n<h3 id=\"5-4-分支管理\"><a href=\"#5-4-分支管理\" class=\"headerlink\" title=\"5-4. 分支管理\"></a>5-4. 分支管理</h3><p>首先master主分支应该是非常稳定的，也就是用来发布新版本，一般情况下不允许在上面干活，干活一般情况下在新建的dev分支上干活，干完后，比如上要发布，或者说dev分支代码稳定后可以合并到主分支master上来</p>\n<blockquote>\n<p>bug分支: 在开发中，会经常碰到bug问题，那么有了bug就需要修复，在Git中，分支是很强大的，每个bug都可以通过一个临时分支来修复，修复完成后，合并分支，然后将临时的分支删除掉。</p>\n</blockquote>\n<p>在dev分支修改readme.txt的内容，然后紧急有个bug需要修复, 需要新增分支在master基础上进行修复。需要先将dev分支上的修改隐藏</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 将当前分支的修改隐藏</span></span><br><span class=\"line\">git stash</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 列出隐藏的修改</span></span><br><span class=\"line\">git stash list</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 恢复隐藏的修改</span></span><br><span class=\"line\">git stash apply</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 删除stash</span></span><br><span class=\"line\">git stash drop</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 恢复的同时删除</span></span><br><span class=\"line\">git stash pop</span><br></pre></td></tr></table></figure>\n<h2 id=\"6-多人协作\"><a href=\"#6-多人协作\" class=\"headerlink\" title=\"6. 多人协作\"></a>6. 多人协作</h2><h3 id=\"6-1-查看远程库信息\"><a href=\"#6-1-查看远程库信息\" class=\"headerlink\" title=\"6-1. 查看远程库信息\"></a>6-1. 查看远程库信息</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git remote</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 详细信息</span></span><br><span class=\"line\">git remote -v</span><br></pre></td></tr></table></figure>\n<h3 id=\"6-2-推送分支\"><a href=\"#6-2-推送分支\" class=\"headerlink\" title=\"6-2. 推送分支\"></a>6-2. 推送分支</h3><p>推送分支就是把该分支上所有本地提交到远程库中，推送时，要指定本地分支</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 推送master分支</span></span><br><span class=\"line\">git push origin master</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 推送dev分支</span></span><br><span class=\"line\">git push origin dev</span><br></pre></td></tr></table></figure>\n<p>修改dev分支的内容，并将dev分支推送到远程库，结果远程库会新增dev分支</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190503000207.png\" alt></p>\n<p>gitHub上新增分支dev</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190503000251.png\" alt></p>\n<p>master分支是主分支，因此要时刻与远程同步。</p>\n<p>一些修复bug分支不需要推送到远程去，可以先合并到主分支上，然后把主分支master推送到远程去。</p>\n<h3 id=\"6-3-抓取分支\"><a href=\"#6-3-抓取分支\" class=\"headerlink\" title=\"6-3. 抓取分支\"></a>6-3. 抓取分支</h3><p>将远程的origin的dev分支同步到本地</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git checkout -b dev origin/dev</span><br></pre></td></tr></table></figure>\n<p>现在就可以在dev分支上做开发了，开发完成后把dev分支推送到远程库。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git push origin dev</span><br></pre></td></tr></table></figure>\n<p>抓取远程仓库</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git pull</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 指定den分支与远程origin/dev分支的链接</span></span><br><span class=\"line\">git branch --set-upstream-to dev origin/dev</span><br></pre></td></tr></table></figure>\n<p>多人协作工作模式一般是这样的：</p>\n<ul>\n<li>首先，可以试图用git push origin branch-name推送自己的修改.</li>\n<li>如果推送失败，则因为远程分支比你的本地更新早，需要先用git pull试图合并。</li>\n<li>如果合并有冲突，则需要解决冲突，并在本地提交。再用git push origin branch-name推送。</li>\n</ul>\n<h2 id=\"7-GitHub-Git-Cheat-Sheet\"><a href=\"#7-GitHub-Git-Cheat-Sheet\" class=\"headerlink\" title=\"7. GitHub-Git Cheat Sheet\"></a>7. GitHub-Git Cheat Sheet</h2><p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190507214432.png\" alt></p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190507214558.png\" alt></p>\n","site":{"data":{}},"length":4899,"excerpt":"<p>Git是分布式版本控制系统，Git中每个人的电脑就是一个完整的版本库，当多人协作时，只需把各自的修改推送给对方。</p>","more":"<h2 id=\"1-Git是什么\"><a href=\"#1-Git是什么\" class=\"headerlink\" title=\"1. Git是什么\"></a>1. Git是什么</h2><p>Git是分布式版本控制系统<br>官网:<a href=\"https://git-scm.com/\" target=\"_blank\" rel=\"noopener\">https://git-scm.com/</a></p>\n<h3 id=\"1-1-工作原理-流程\"><a href=\"#1-1-工作原理-流程\" class=\"headerlink\" title=\"1-1. 工作原理 / 流程\"></a>1-1. 工作原理 / 流程</h3><p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502000850.png\" alt></p>\n<ul>\n<li>Workspace: 工作区</li>\n<li>Index / Stage: 暂存区</li>\n<li>Repository: 仓库区（或本地仓库）</li>\n<li>Remote: 远程仓库</li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502002525.png\" alt></p>\n<h3 id=\"1-2-SVN与Git的主要区别\"><a href=\"#1-2-SVN与Git的主要区别\" class=\"headerlink\" title=\"1-2. SVN与Git的主要区别\"></a>1-2. SVN与Git的主要区别</h3><p>SVN-集中式版本控制系统，版本库放在中央服务器。以中央服务器的版本为基准，干活前需要先同步中央服务器得到最新的版本，自己本地的更新也需要推送到中央服务器。</p>\n<p>Git是分布式版本控制系统，Git中每个人的电脑就是一个完整的版本库，当多人协作时，只需把各自的修改推送给对方。</p>\n<h2 id=\"2-Git安装使用\"><a href=\"#2-Git安装使用\" class=\"headerlink\" title=\"2. Git安装使用\"></a>2. Git安装使用</h2><h3 id=\"2-1-Git安装\"><a href=\"#2-1-Git安装\" class=\"headerlink\" title=\"2-1. Git安装\"></a>2-1. Git安装</h3><p>参照Git官网下载安装,安装完成后鼠标右键菜单多了2个选项</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502145216.png\" alt></p>\n<h3 id=\"2-2-Git初始化用户信息\"><a href=\"#2-2-Git初始化用户信息\" class=\"headerlink\" title=\"2-2. Git初始化用户信息\"></a>2-2. Git初始化用户信息</h3><p>设置用户全局配置：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config --global user.name \"[name]\"</span><br><span class=\"line\">Sets the name you want to attached to your transactions</span><br><span class=\"line\"></span><br><span class=\"line\">git config --global user.email \"[email address]\"</span><br><span class=\"line\">Sets the email you want to attached to your transactions</span><br><span class=\"line\"></span><br><span class=\"line\">git config --global color.ui auto</span><br><span class=\"line\">Enables helpful colorization of command line output</span><br></pre></td></tr></table></figure>\n<p>查看用户信息配置</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config user.name</span><br><span class=\"line\">git config user.email</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-3-GitHub配置SSH公钥\"><a href=\"#2-3-GitHub配置SSH公钥\" class=\"headerlink\" title=\"2-3. GitHub配置SSH公钥\"></a>2-3. GitHub配置SSH公钥</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -C '[email address using in github]'</span><br></pre></td></tr></table></figure>\n<ul>\n<li><p>在Git Bash输入以上命令后，回车后再按三个回车(默认存储位置，密码为空，确认密码)。</p>\n</li>\n<li><p>将上一步生成的公钥路径：C:\\Users\\你的用户名\\.ssh。id_rsa是私钥，不能泄露出去，id_rsa.pub是公钥，可以放心地告诉任何人。</p>\n</li>\n<li><p>将生成的公钥(id_rsa.pub)添加到GitHub:选择头像–&gt;Settings–&gt;SSH and GPG keys</p>\n</li>\n</ul>\n<h3 id=\"2-4-Git-GUI-Clients\"><a href=\"#2-4-Git-GUI-Clients\" class=\"headerlink\" title=\"2-4. Git GUI Clients\"></a>2-4. <a href=\"https://git-scm.com/downloads/guis\" target=\"_blank\" rel=\"noopener\">Git GUI Clients</a></h3><ul>\n<li>GitHub Desktop</li>\n<li>TortoiseGit</li>\n<li>Git Extensions</li>\n<li>…</li>\n</ul>\n<h2 id=\"3-Git管理代码仓库\"><a href=\"#3-Git管理代码仓库\" class=\"headerlink\" title=\"3. Git管理代码仓库\"></a>3. Git管理代码仓库</h2><h3 id=\"3-1-创建版本库\"><a href=\"#3-1-创建版本库\" class=\"headerlink\" title=\"3-1. 创建版本库\"></a>3-1. 创建版本库</h3><p>Repository可以理解为一个目录，这个目录里面的所有文件都可以被Git管理起来。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> mkdir testgit</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> <span class=\"built_in\">cd</span> testgit/</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> git init</span></span><br><span class=\"line\">Initialized empty Git repository in D:/WorkSpaces/testgit/.git/</span><br></pre></td></tr></table></figure>\n<p>执行上面的操作，gittest就成为了一个Git仓库。在testgit目录下自动新增了一个.git文件夹</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502150628.png\" alt></p>\n<p>新建readme.txt文件并提交</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502151123.png\" alt></p>\n<p>继续修改readme.txt文件后，提交修改</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502152011.png\" alt></p>\n<p>发现每次都会有warning: LF will be replaced by CRLF in readme.txt.提示。</p>\n<p>原因是不同操作系统中换行符的标识不同</p>\n<ul>\n<li><p>CRLF-&gt;Windows-style</p>\n</li>\n<li><p>LF-&gt;Unix Style</p>\n</li>\n<li><p>CR-&gt;Mac Style</p>\n</li>\n</ul>\n<p>可通过如下命令进行转换设置</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config --global core.autocrlf true/false/inout</span><br></pre></td></tr></table></figure>\n<ul>\n<li>true，添加文件到git仓库时，git将其视为文本文件。他将把crlf变成lf</li>\n<li>false，line-endings将不做转换操作。文本文件保持原来的样子。</li>\n<li>input，添加文件git仓库石，git把crlf编程lf。当有人Check代码时还是lf方式。因此在window操作系统下，不要使用这个设置</li>\n</ul>\n<h3 id=\"3-2-版本回退\"><a href=\"#3-2-版本回退\" class=\"headerlink\" title=\"3-2 版本回退\"></a>3-2 版本回退</h3><p>继续修改readme.txt文件，新增”33333333”并提交</p>\n<p>查看修改的历史记录</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git log</span><br><span class=\"line\">git log --pretty=oneline</span><br><span class=\"line\">git reflog</span><br></pre></td></tr></table></figure>\n<p>git log 与git reflog的区别</p>\n<p>1) git log: commit 的版本日志 包含提交的版本 操作者 日期 (方便查看commit的版本,但是版本回退后,使用git log 看不到回退版本号之后的版本记录) </p>\n<p>2) git reflog: 使用git 命令进行操作的日志  包括当前步骤所在哪个版本(一个commit 产生一个版本, 指定版本回退只能回退到该commit) 以及操作的具体内容</p>\n<p>版本回退后,仍然可以看到所有的版本记录 方便查看每个操作步骤所在的版本,可以根据版本号自由前进后退</p>\n<p>版本回退操作</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git reset --hard HEAD^</span><br><span class=\"line\">git reset --hard HEAD^^</span><br><span class=\"line\">git reset --hard HEAD~100</span><br><span class=\"line\">git reset --hard '版本号'</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502155810.png\" alt></p>\n<h3 id=\"3-3-撤销和删除文件\"><a href=\"#3-3-撤销和删除文件\" class=\"headerlink\" title=\"3-3. 撤销和删除文件\"></a>3-3. 撤销和删除文件</h3><h4 id=\"3-3-1-撤销修改\"><a href=\"#3-3-1-撤销修改\" class=\"headerlink\" title=\"3-3-1. 撤销修改\"></a>3-3-1. 撤销修改</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 丢弃工作区的修改。--很重要，没有--的话命令就变成创建分支了</span></span><br><span class=\"line\">git checkout -- file</span><br></pre></td></tr></table></figure>\n<p>有2种情况：</p>\n<ul>\n<li>文件修改后，还没有放到暂存区，使用撤销修改就回到和版本库一模一样的状态</li>\n<li>另外一种是文件的修改已经放入暂存区了，接着又作了修改，撤销修改就回到添加暂存区后的状态</li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502162025.png\" alt></p>\n<h4 id=\"3-3-2-删除文件\"><a href=\"#3-3-2-删除文件\" class=\"headerlink\" title=\"3-3-2. 删除文件\"></a>3-3-2. 删除文件</h4><p>删除文件后再commit到git，如果删除并提交到暂存区后，可执行checkout操作恢复删除的文件</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502162924.png\" alt></p>\n<h2 id=\"4-远程仓库\"><a href=\"#4-远程仓库\" class=\"headerlink\" title=\"4. 远程仓库\"></a>4. 远程仓库</h2><h3 id=\"4-1-注册GitHub，并在本地创建SSH添加到GitHub\"><a href=\"#4-1-注册GitHub，并在本地创建SSH添加到GitHub\" class=\"headerlink\" title=\"4-1. 注册GitHub，并在本地创建SSH添加到GitHub\"></a>4-1. 注册GitHub，并在本地创建SSH添加到GitHub</h3><p>操作参照步骤2-3</p>\n<h3 id=\"4-2-添加远程库\"><a href=\"#4-2-添加远程库\" class=\"headerlink\" title=\"4-2. 添加远程库\"></a>4-2. 添加远程库</h3><h4 id=\"4-2-1-本地先有仓库，然后关联到远程库\"><a href=\"#4-2-1-本地先有仓库，然后关联到远程库\" class=\"headerlink\" title=\"4-2-1. 本地先有仓库，然后关联到远程库\"></a>4-2-1. 本地先有仓库，然后关联到远程库</h4><ul>\n<li><ol>\n<li>在GitHub上创建仓库</li>\n</ol>\n</li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502171256.png\" alt></p>\n<ul>\n<li><ol start=\"2\">\n<li>在本地仓库目录下运行命令</li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git remote add origin https://github.com/hyman213/testgit.git</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 第一次推送</span></span><br><span class=\"line\">git push -u origin master</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 之后的推送</span></span><br><span class=\"line\">git push origin master</span><br></pre></td></tr></table></figure>\n<p>我们第一次推送master分支时，加上了 –u参数，Git不但会把本地的master分支内容推送的远程新的master分支，还会把本地的master分支和远程的master分支关联起来，在以后的推送或者拉取时就可以简化命令。</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502171627.png\" alt></p>\n<p>此时本地仓库的内容就上传到了远程库</p>\n<p>再次修改本地库的readme.txt文件，测试上传更新到远程库</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> vi readme.txt</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> git status</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> git add readme.txt</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> git commit -m <span class=\"string\">'增加了55555555和66666666'</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> git push origin master</span></span><br></pre></td></tr></table></figure>\n<p>刷新GitHub上内容，内容与本地库一致，本地内容成功推送到可远程库</p>\n<h4 id=\"4-2-2-先有远程仓库\"><a href=\"#4-2-2-先有远程仓库\" class=\"headerlink\" title=\"4-2-2. 先有远程仓库\"></a>4-2-2. 先有远程仓库</h4><ul>\n<li><ol>\n<li>在GitHub上创建仓库testgit2</li>\n</ol>\n</li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502172525.png\" alt></p>\n<ul>\n<li><ol start=\"2\">\n<li>在本地clone远程库的内容, 注意clone下来内容会在当前路径生成新文件夹testgit2</li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> git <span class=\"built_in\">clone</span> https://github.com/hyman213/testgit2.git</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li><ol start=\"3\">\n<li>测试在本地增加readme.txt文件，并上传推送到远程库</li>\n</ol>\n</li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502173248.png\" alt></p>\n<h2 id=\"5-分支-branch\"><a href=\"#5-分支-branch\" class=\"headerlink\" title=\"5. 分支-branch\"></a>5. 分支-branch</h2><blockquote>\n<p>每次提交，Git都把它们串成一条时间线，这条时间线就是一个分支。截止到目前，只有一条时间线，在Git里，这个分支叫主分支，即master分支。HEAD严格来说不是指向提交，而是指向master，master才是指向提交的，所以，HEAD指向的就是当前分支</p>\n</blockquote>\n<p>用到的命令有</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 创建分支dev</span></span><br><span class=\"line\">git branch dev</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 切换到dev分支</span></span><br><span class=\"line\">git checkout dev</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 上面两个命令合并</span></span><br><span class=\"line\">git checkout -b dev</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 查看分支(列出所有分支,当前分支会添加一个星号)</span></span><br><span class=\"line\">git branch</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 合并分支(将dev分支上的更新合并到当前分支)</span></span><br><span class=\"line\">git merge dev</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 删除分支</span></span><br><span class=\"line\">git branch -d dev</span><br></pre></td></tr></table></figure>\n<h3 id=\"5-1-创建分支\"><a href=\"#5-1-创建分支\" class=\"headerlink\" title=\"5-1. 创建分支\"></a>5-1. 创建分支</h3><p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502223958.png\" alt></p>\n<p>切换到dev分支，然后在dev分支上进行修改。</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502225423.png\" alt></p>\n<p>切换到master分支，查看readme.txt文件。内容没有修改</p>\n<h3 id=\"5-2-合并-删除分支\"><a href=\"#5-2-合并-删除分支\" class=\"headerlink\" title=\"5-2. 合并/删除分支\"></a>5-2. 合并/删除分支</h3><p>将dev分支上的修改合并到master分支上</p>\n<p><img src=\"C:\\Users\\idobe\\AppData\\Roaming\\Typora\\typora-user-images\\1556808994739.png\" alt=\"1556808994739\"></p>\n<p>通常合并分支时，git一般使用”Fast forward”模式，在这种模式下，删除分支后，会丢掉分支信息，现在我们来使用带参数 –no-ff来禁用”Fast forward”模式</p>\n<p>禁用”Fast forward”模式合并分支</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git merge --no-ff -m \"merge with mo-ff\" dev</span><br></pre></td></tr></table></figure>\n<h3 id=\"5-3-解决分支冲突\"><a href=\"#5-3-解决分支冲突\" class=\"headerlink\" title=\"5-3. 解决分支冲突\"></a>5-3. 解决分支冲突</h3><p>新建分支branch1,在branch1分支和master分支分别修改readme.txt文件并提交。然后将branch1分支的修改合并到master分支。</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190502231618.png\" alt></p>\n<p>查看冲突并解决冲突后，再次提交文件</p>\n<p><img src=\"C:\\Users\\idobe\\AppData\\Roaming\\Typora\\typora-user-images\\1556810416998.png\" alt=\"1556810416998\"></p>\n<h3 id=\"5-4-分支管理\"><a href=\"#5-4-分支管理\" class=\"headerlink\" title=\"5-4. 分支管理\"></a>5-4. 分支管理</h3><p>首先master主分支应该是非常稳定的，也就是用来发布新版本，一般情况下不允许在上面干活，干活一般情况下在新建的dev分支上干活，干完后，比如上要发布，或者说dev分支代码稳定后可以合并到主分支master上来</p>\n<blockquote>\n<p>bug分支: 在开发中，会经常碰到bug问题，那么有了bug就需要修复，在Git中，分支是很强大的，每个bug都可以通过一个临时分支来修复，修复完成后，合并分支，然后将临时的分支删除掉。</p>\n</blockquote>\n<p>在dev分支修改readme.txt的内容，然后紧急有个bug需要修复, 需要新增分支在master基础上进行修复。需要先将dev分支上的修改隐藏</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 将当前分支的修改隐藏</span></span><br><span class=\"line\">git stash</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 列出隐藏的修改</span></span><br><span class=\"line\">git stash list</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 恢复隐藏的修改</span></span><br><span class=\"line\">git stash apply</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 删除stash</span></span><br><span class=\"line\">git stash drop</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 恢复的同时删除</span></span><br><span class=\"line\">git stash pop</span><br></pre></td></tr></table></figure>\n<h2 id=\"6-多人协作\"><a href=\"#6-多人协作\" class=\"headerlink\" title=\"6. 多人协作\"></a>6. 多人协作</h2><h3 id=\"6-1-查看远程库信息\"><a href=\"#6-1-查看远程库信息\" class=\"headerlink\" title=\"6-1. 查看远程库信息\"></a>6-1. 查看远程库信息</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git remote</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 详细信息</span></span><br><span class=\"line\">git remote -v</span><br></pre></td></tr></table></figure>\n<h3 id=\"6-2-推送分支\"><a href=\"#6-2-推送分支\" class=\"headerlink\" title=\"6-2. 推送分支\"></a>6-2. 推送分支</h3><p>推送分支就是把该分支上所有本地提交到远程库中，推送时，要指定本地分支</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 推送master分支</span></span><br><span class=\"line\">git push origin master</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 推送dev分支</span></span><br><span class=\"line\">git push origin dev</span><br></pre></td></tr></table></figure>\n<p>修改dev分支的内容，并将dev分支推送到远程库，结果远程库会新增dev分支</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190503000207.png\" alt></p>\n<p>gitHub上新增分支dev</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190503000251.png\" alt></p>\n<p>master分支是主分支，因此要时刻与远程同步。</p>\n<p>一些修复bug分支不需要推送到远程去，可以先合并到主分支上，然后把主分支master推送到远程去。</p>\n<h3 id=\"6-3-抓取分支\"><a href=\"#6-3-抓取分支\" class=\"headerlink\" title=\"6-3. 抓取分支\"></a>6-3. 抓取分支</h3><p>将远程的origin的dev分支同步到本地</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git checkout -b dev origin/dev</span><br></pre></td></tr></table></figure>\n<p>现在就可以在dev分支上做开发了，开发完成后把dev分支推送到远程库。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git push origin dev</span><br></pre></td></tr></table></figure>\n<p>抓取远程仓库</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git pull</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 指定den分支与远程origin/dev分支的链接</span></span><br><span class=\"line\">git branch --set-upstream-to dev origin/dev</span><br></pre></td></tr></table></figure>\n<p>多人协作工作模式一般是这样的：</p>\n<ul>\n<li>首先，可以试图用git push origin branch-name推送自己的修改.</li>\n<li>如果推送失败，则因为远程分支比你的本地更新早，需要先用git pull试图合并。</li>\n<li>如果合并有冲突，则需要解决冲突，并在本地提交。再用git push origin branch-name推送。</li>\n</ul>\n<h2 id=\"7-GitHub-Git-Cheat-Sheet\"><a href=\"#7-GitHub-Git-Cheat-Sheet\" class=\"headerlink\" title=\"7. GitHub-Git Cheat Sheet\"></a>7. GitHub-Git Cheat Sheet</h2><p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190507214432.png\" alt></p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190507214558.png\" alt></p>"},{"title":"使用PicGo和GitHub搭建个人图床","date":"2019-05-03T13:50:00.000Z","toc_number":false,"_content":"\n\n\n> 一直苦于一些图片没地方保存，如果图片能够上传到一个地方而且能够直接通过地址访问就好了。无意间在GitHub上看到有人利用GitHub做图层，于是就有了试一试的想法。最终利用PicGo和GitHub成功搭建个人图床\n\n<!--more-->\n\n## 1.GitHub仓库设置\n\n### 1-1.新建仓库\n\n仓库选择public\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501225624.png)\n\n### 1-2.创建token\n\n\n\ntoken用于后面PicGo操作Github仓库。\n\n访问[https://github.com/settings/tokens](https://github.com/settings/tokens) 或者个人头像/Settings/Developer settings/Personal access tokens\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501225737.png)\n\n把repo的勾打上即可。然后翻到页面最底部，点击`Generate token`的绿色按钮生成token。\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501225802.png)\n\n**注意：**这个token生成后只会显示一次！你要把这个token复制一下存到其他地方以备以后要用。\n\n## 2.PicGo\n\nPicGo是一款免费开源的图片上传和管理工具。\n\n[官方网站https://molunerfinn.com/PicGo/](https://molunerfinn.com/PicGo/)\n\n### 2-1.PicGo应用说明\n\nPicGo在上传图片之后自动会将图片链接复制到你的剪贴板里，可选5种复制的链接格式。\n\nPicGo目前支持了,目前最新版本为2.1.0\n\n- 微博图床 v1.0\n- 七牛图床 v1.0\n- 腾讯云COS v4\\v5版本 v1.1 & v1.5.0\n- 又拍云 v1.2.0\n- GitHub v1.5.0\n- SM.MS v1.5.1\n- 阿里云OSS v1.6.0\n- Imgur v1.6.0\n\n### 2-2.下载安装PicGo\n\n按照PicGo官网[文档说明](https://picgo.github.io/PicGo-Doc/zh/guide/#%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85)下载安装PicGo\n\nmacOS用户请下载最新版本的`dmg`文件，windows用户请下载最新版本的`exe`文件，linux用户请下载`AppImage`文件。\n\n\n\n### 2-3. 快速上手\n\n- Mini窗口上传\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501221954.png)\n\n1)直接拖拽图片到mini窗口上传\n\n2)将图片复制到剪贴板，然后右键mini窗口，选择剪贴板上传\n\n- 主窗口上传\n\n### 2-4.配置说明\n\nPicGo配置文件在不同系统里是不一样的\n\n- Windows：`%APPDATA%\\picgo\\data.json`\n- Linux: `$XDG_CONFIG_HOME/picgo/data.json` or `~/.config/picgo/data.json`\n- macOS:` ~/Library/Application\\ Support/picgo/data.json`\n\n我的配置文件是在C:\\Users\\idobe\\AppData\\Roaming\\PicGo\\data.json\n\n默认配置如下,\n\n```json\n{\n  \"uploaded\": [],\n  \"picBed\": {\n    \"current\": \"weibo\"\n  },\n  \"settings\": {\n    \"shortKey\": {\n      \"upload\": \"CommandOrControl+Shift+P\"\n    },\n    \"showUpdateTip\": true\n  },\n  \"needReload\": false,\n  \"picgoPlugins\": {}\n}\n```\n\n在PicGo界面还可以有多种个性化设置，我在这里设置了时间戳重命名，上传的图片会自动按时间戳重命名后上传。\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501223804.png)\n\n### 2-5. 配置GitHub图床\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501222516.jpg)\n\n仓库名：格式-用户名/仓库\n\n分支名：master\n\nToken：GitHub 生成的Token\n\n指定储存路径：注意格式**2019/**，不要写成**/2019/**。仓库下的路径名,注意GitHub上该目录必须存在\n\n自定义域名不用设置。\n\n\n\n至此，使用PicGo和GitHub创建个人图床已经完成。可以愉快的上传图片了。\n\n参考：\n\n1.https://github.com/nnngu/FigureBed\n\n2.https://blog.csdn.net/yefcion/article/details/88412025\n\n3.另外一款图床工具感觉也不错。https://github.com/xiebruce/PicUploader\n\n\n\n","source":"_posts/20190507-使用PicGo和GitHub搭建个人图床.md","raw":"---\ntitle: 使用PicGo和GitHub搭建个人图床\ndate: 2019-05-03 21:50:00\ntags: Hexo博客\ncategory: 使用技巧总结记录\ntoc_number: false\n---\n\n\n\n> 一直苦于一些图片没地方保存，如果图片能够上传到一个地方而且能够直接通过地址访问就好了。无意间在GitHub上看到有人利用GitHub做图层，于是就有了试一试的想法。最终利用PicGo和GitHub成功搭建个人图床\n\n<!--more-->\n\n## 1.GitHub仓库设置\n\n### 1-1.新建仓库\n\n仓库选择public\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501225624.png)\n\n### 1-2.创建token\n\n\n\ntoken用于后面PicGo操作Github仓库。\n\n访问[https://github.com/settings/tokens](https://github.com/settings/tokens) 或者个人头像/Settings/Developer settings/Personal access tokens\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501225737.png)\n\n把repo的勾打上即可。然后翻到页面最底部，点击`Generate token`的绿色按钮生成token。\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501225802.png)\n\n**注意：**这个token生成后只会显示一次！你要把这个token复制一下存到其他地方以备以后要用。\n\n## 2.PicGo\n\nPicGo是一款免费开源的图片上传和管理工具。\n\n[官方网站https://molunerfinn.com/PicGo/](https://molunerfinn.com/PicGo/)\n\n### 2-1.PicGo应用说明\n\nPicGo在上传图片之后自动会将图片链接复制到你的剪贴板里，可选5种复制的链接格式。\n\nPicGo目前支持了,目前最新版本为2.1.0\n\n- 微博图床 v1.0\n- 七牛图床 v1.0\n- 腾讯云COS v4\\v5版本 v1.1 & v1.5.0\n- 又拍云 v1.2.0\n- GitHub v1.5.0\n- SM.MS v1.5.1\n- 阿里云OSS v1.6.0\n- Imgur v1.6.0\n\n### 2-2.下载安装PicGo\n\n按照PicGo官网[文档说明](https://picgo.github.io/PicGo-Doc/zh/guide/#%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85)下载安装PicGo\n\nmacOS用户请下载最新版本的`dmg`文件，windows用户请下载最新版本的`exe`文件，linux用户请下载`AppImage`文件。\n\n\n\n### 2-3. 快速上手\n\n- Mini窗口上传\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501221954.png)\n\n1)直接拖拽图片到mini窗口上传\n\n2)将图片复制到剪贴板，然后右键mini窗口，选择剪贴板上传\n\n- 主窗口上传\n\n### 2-4.配置说明\n\nPicGo配置文件在不同系统里是不一样的\n\n- Windows：`%APPDATA%\\picgo\\data.json`\n- Linux: `$XDG_CONFIG_HOME/picgo/data.json` or `~/.config/picgo/data.json`\n- macOS:` ~/Library/Application\\ Support/picgo/data.json`\n\n我的配置文件是在C:\\Users\\idobe\\AppData\\Roaming\\PicGo\\data.json\n\n默认配置如下,\n\n```json\n{\n  \"uploaded\": [],\n  \"picBed\": {\n    \"current\": \"weibo\"\n  },\n  \"settings\": {\n    \"shortKey\": {\n      \"upload\": \"CommandOrControl+Shift+P\"\n    },\n    \"showUpdateTip\": true\n  },\n  \"needReload\": false,\n  \"picgoPlugins\": {}\n}\n```\n\n在PicGo界面还可以有多种个性化设置，我在这里设置了时间戳重命名，上传的图片会自动按时间戳重命名后上传。\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501223804.png)\n\n### 2-5. 配置GitHub图床\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501222516.jpg)\n\n仓库名：格式-用户名/仓库\n\n分支名：master\n\nToken：GitHub 生成的Token\n\n指定储存路径：注意格式**2019/**，不要写成**/2019/**。仓库下的路径名,注意GitHub上该目录必须存在\n\n自定义域名不用设置。\n\n\n\n至此，使用PicGo和GitHub创建个人图床已经完成。可以愉快的上传图片了。\n\n参考：\n\n1.https://github.com/nnngu/FigureBed\n\n2.https://blog.csdn.net/yefcion/article/details/88412025\n\n3.另外一款图床工具感觉也不错。https://github.com/xiebruce/PicUploader\n\n\n\n","slug":"使用PicGo和GitHub搭建个人图床","published":1,"updated":"2019-05-07T14:08:58.760Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck27dih1w0006mskps5up6vty","content":"<blockquote>\n<p>一直苦于一些图片没地方保存，如果图片能够上传到一个地方而且能够直接通过地址访问就好了。无意间在GitHub上看到有人利用GitHub做图层，于是就有了试一试的想法。最终利用PicGo和GitHub成功搭建个人图床</p>\n</blockquote>\n<a id=\"more\"></a>\n<h2 id=\"1-GitHub仓库设置\"><a href=\"#1-GitHub仓库设置\" class=\"headerlink\" title=\"1.GitHub仓库设置\"></a>1.GitHub仓库设置</h2><h3 id=\"1-1-新建仓库\"><a href=\"#1-1-新建仓库\" class=\"headerlink\" title=\"1-1.新建仓库\"></a>1-1.新建仓库</h3><p>仓库选择public</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501225624.png\" alt></p>\n<h3 id=\"1-2-创建token\"><a href=\"#1-2-创建token\" class=\"headerlink\" title=\"1-2.创建token\"></a>1-2.创建token</h3><p>token用于后面PicGo操作Github仓库。</p>\n<p>访问<a href=\"https://github.com/settings/tokens\" target=\"_blank\" rel=\"noopener\">https://github.com/settings/tokens</a> 或者个人头像/Settings/Developer settings/Personal access tokens</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501225737.png\" alt></p>\n<p>把repo的勾打上即可。然后翻到页面最底部，点击<code>Generate token</code>的绿色按钮生成token。</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501225802.png\" alt></p>\n<p><strong>注意：</strong>这个token生成后只会显示一次！你要把这个token复制一下存到其他地方以备以后要用。</p>\n<h2 id=\"2-PicGo\"><a href=\"#2-PicGo\" class=\"headerlink\" title=\"2.PicGo\"></a>2.PicGo</h2><p>PicGo是一款免费开源的图片上传和管理工具。</p>\n<p><a href=\"https://molunerfinn.com/PicGo/\" target=\"_blank\" rel=\"noopener\">官方网站https://molunerfinn.com/PicGo/</a></p>\n<h3 id=\"2-1-PicGo应用说明\"><a href=\"#2-1-PicGo应用说明\" class=\"headerlink\" title=\"2-1.PicGo应用说明\"></a>2-1.PicGo应用说明</h3><p>PicGo在上传图片之后自动会将图片链接复制到你的剪贴板里，可选5种复制的链接格式。</p>\n<p>PicGo目前支持了,目前最新版本为2.1.0</p>\n<ul>\n<li>微博图床 v1.0</li>\n<li>七牛图床 v1.0</li>\n<li>腾讯云COS v4\\v5版本 v1.1 &amp; v1.5.0</li>\n<li>又拍云 v1.2.0</li>\n<li>GitHub v1.5.0</li>\n<li>SM.MS v1.5.1</li>\n<li>阿里云OSS v1.6.0</li>\n<li>Imgur v1.6.0</li>\n</ul>\n<h3 id=\"2-2-下载安装PicGo\"><a href=\"#2-2-下载安装PicGo\" class=\"headerlink\" title=\"2-2.下载安装PicGo\"></a>2-2.下载安装PicGo</h3><p>按照PicGo官网<a href=\"https://picgo.github.io/PicGo-Doc/zh/guide/#%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85\" target=\"_blank\" rel=\"noopener\">文档说明</a>下载安装PicGo</p>\n<p>macOS用户请下载最新版本的<code>dmg</code>文件，windows用户请下载最新版本的<code>exe</code>文件，linux用户请下载<code>AppImage</code>文件。</p>\n<h3 id=\"2-3-快速上手\"><a href=\"#2-3-快速上手\" class=\"headerlink\" title=\"2-3. 快速上手\"></a>2-3. 快速上手</h3><ul>\n<li>Mini窗口上传</li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501221954.png\" alt></p>\n<p>1)直接拖拽图片到mini窗口上传</p>\n<p>2)将图片复制到剪贴板，然后右键mini窗口，选择剪贴板上传</p>\n<ul>\n<li>主窗口上传</li>\n</ul>\n<h3 id=\"2-4-配置说明\"><a href=\"#2-4-配置说明\" class=\"headerlink\" title=\"2-4.配置说明\"></a>2-4.配置说明</h3><p>PicGo配置文件在不同系统里是不一样的</p>\n<ul>\n<li>Windows：<code>%APPDATA%\\picgo\\data.json</code></li>\n<li>Linux: <code>$XDG_CONFIG_HOME/picgo/data.json</code> or <code>~/.config/picgo/data.json</code></li>\n<li>macOS:<code>~/Library/Application\\ Support/picgo/data.json</code></li>\n</ul>\n<p>我的配置文件是在C:\\Users\\idobe\\AppData\\Roaming\\PicGo\\data.json</p>\n<p>默认配置如下,</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"uploaded\"</span>: [],</span><br><span class=\"line\">  <span class=\"attr\">\"picBed\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"current\"</span>: <span class=\"string\">\"weibo\"</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">\"settings\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"shortKey\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"upload\"</span>: <span class=\"string\">\"CommandOrControl+Shift+P\"</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">\"showUpdateTip\"</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">\"needReload\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"picgoPlugins\"</span>: &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>在PicGo界面还可以有多种个性化设置，我在这里设置了时间戳重命名，上传的图片会自动按时间戳重命名后上传。</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501223804.png\" alt></p>\n<h3 id=\"2-5-配置GitHub图床\"><a href=\"#2-5-配置GitHub图床\" class=\"headerlink\" title=\"2-5. 配置GitHub图床\"></a>2-5. 配置GitHub图床</h3><p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501222516.jpg\" alt></p>\n<p>仓库名：格式-用户名/仓库</p>\n<p>分支名：master</p>\n<p>Token：GitHub 生成的Token</p>\n<p>指定储存路径：注意格式<strong>2019/</strong>，不要写成<strong>/2019/</strong>。仓库下的路径名,注意GitHub上该目录必须存在</p>\n<p>自定义域名不用设置。</p>\n<p>至此，使用PicGo和GitHub创建个人图床已经完成。可以愉快的上传图片了。</p>\n<p>参考：</p>\n<p>1.<a href=\"https://github.com/nnngu/FigureBed\" target=\"_blank\" rel=\"noopener\">https://github.com/nnngu/FigureBed</a></p>\n<p>2.<a href=\"https://blog.csdn.net/yefcion/article/details/88412025\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/yefcion/article/details/88412025</a></p>\n<p>3.另外一款图床工具感觉也不错。<a href=\"https://github.com/xiebruce/PicUploader\" target=\"_blank\" rel=\"noopener\">https://github.com/xiebruce/PicUploader</a></p>\n","site":{"data":{}},"length":1708,"excerpt":"<blockquote>\n<p>一直苦于一些图片没地方保存，如果图片能够上传到一个地方而且能够直接通过地址访问就好了。无意间在GitHub上看到有人利用GitHub做图层，于是就有了试一试的想法。最终利用PicGo和GitHub成功搭建个人图床</p>\n</blockquote>","more":"<h2 id=\"1-GitHub仓库设置\"><a href=\"#1-GitHub仓库设置\" class=\"headerlink\" title=\"1.GitHub仓库设置\"></a>1.GitHub仓库设置</h2><h3 id=\"1-1-新建仓库\"><a href=\"#1-1-新建仓库\" class=\"headerlink\" title=\"1-1.新建仓库\"></a>1-1.新建仓库</h3><p>仓库选择public</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501225624.png\" alt></p>\n<h3 id=\"1-2-创建token\"><a href=\"#1-2-创建token\" class=\"headerlink\" title=\"1-2.创建token\"></a>1-2.创建token</h3><p>token用于后面PicGo操作Github仓库。</p>\n<p>访问<a href=\"https://github.com/settings/tokens\" target=\"_blank\" rel=\"noopener\">https://github.com/settings/tokens</a> 或者个人头像/Settings/Developer settings/Personal access tokens</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501225737.png\" alt></p>\n<p>把repo的勾打上即可。然后翻到页面最底部，点击<code>Generate token</code>的绿色按钮生成token。</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501225802.png\" alt></p>\n<p><strong>注意：</strong>这个token生成后只会显示一次！你要把这个token复制一下存到其他地方以备以后要用。</p>\n<h2 id=\"2-PicGo\"><a href=\"#2-PicGo\" class=\"headerlink\" title=\"2.PicGo\"></a>2.PicGo</h2><p>PicGo是一款免费开源的图片上传和管理工具。</p>\n<p><a href=\"https://molunerfinn.com/PicGo/\" target=\"_blank\" rel=\"noopener\">官方网站https://molunerfinn.com/PicGo/</a></p>\n<h3 id=\"2-1-PicGo应用说明\"><a href=\"#2-1-PicGo应用说明\" class=\"headerlink\" title=\"2-1.PicGo应用说明\"></a>2-1.PicGo应用说明</h3><p>PicGo在上传图片之后自动会将图片链接复制到你的剪贴板里，可选5种复制的链接格式。</p>\n<p>PicGo目前支持了,目前最新版本为2.1.0</p>\n<ul>\n<li>微博图床 v1.0</li>\n<li>七牛图床 v1.0</li>\n<li>腾讯云COS v4\\v5版本 v1.1 &amp; v1.5.0</li>\n<li>又拍云 v1.2.0</li>\n<li>GitHub v1.5.0</li>\n<li>SM.MS v1.5.1</li>\n<li>阿里云OSS v1.6.0</li>\n<li>Imgur v1.6.0</li>\n</ul>\n<h3 id=\"2-2-下载安装PicGo\"><a href=\"#2-2-下载安装PicGo\" class=\"headerlink\" title=\"2-2.下载安装PicGo\"></a>2-2.下载安装PicGo</h3><p>按照PicGo官网<a href=\"https://picgo.github.io/PicGo-Doc/zh/guide/#%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85\" target=\"_blank\" rel=\"noopener\">文档说明</a>下载安装PicGo</p>\n<p>macOS用户请下载最新版本的<code>dmg</code>文件，windows用户请下载最新版本的<code>exe</code>文件，linux用户请下载<code>AppImage</code>文件。</p>\n<h3 id=\"2-3-快速上手\"><a href=\"#2-3-快速上手\" class=\"headerlink\" title=\"2-3. 快速上手\"></a>2-3. 快速上手</h3><ul>\n<li>Mini窗口上传</li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501221954.png\" alt></p>\n<p>1)直接拖拽图片到mini窗口上传</p>\n<p>2)将图片复制到剪贴板，然后右键mini窗口，选择剪贴板上传</p>\n<ul>\n<li>主窗口上传</li>\n</ul>\n<h3 id=\"2-4-配置说明\"><a href=\"#2-4-配置说明\" class=\"headerlink\" title=\"2-4.配置说明\"></a>2-4.配置说明</h3><p>PicGo配置文件在不同系统里是不一样的</p>\n<ul>\n<li>Windows：<code>%APPDATA%\\picgo\\data.json</code></li>\n<li>Linux: <code>$XDG_CONFIG_HOME/picgo/data.json</code> or <code>~/.config/picgo/data.json</code></li>\n<li>macOS:<code>~/Library/Application\\ Support/picgo/data.json</code></li>\n</ul>\n<p>我的配置文件是在C:\\Users\\idobe\\AppData\\Roaming\\PicGo\\data.json</p>\n<p>默认配置如下,</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"uploaded\"</span>: [],</span><br><span class=\"line\">  <span class=\"attr\">\"picBed\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"current\"</span>: <span class=\"string\">\"weibo\"</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">\"settings\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"shortKey\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"upload\"</span>: <span class=\"string\">\"CommandOrControl+Shift+P\"</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">\"showUpdateTip\"</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">\"needReload\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"picgoPlugins\"</span>: &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>在PicGo界面还可以有多种个性化设置，我在这里设置了时间戳重命名，上传的图片会自动按时间戳重命名后上传。</p>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501223804.png\" alt></p>\n<h3 id=\"2-5-配置GitHub图床\"><a href=\"#2-5-配置GitHub图床\" class=\"headerlink\" title=\"2-5. 配置GitHub图床\"></a>2-5. 配置GitHub图床</h3><p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/20190501222516.jpg\" alt></p>\n<p>仓库名：格式-用户名/仓库</p>\n<p>分支名：master</p>\n<p>Token：GitHub 生成的Token</p>\n<p>指定储存路径：注意格式<strong>2019/</strong>，不要写成<strong>/2019/</strong>。仓库下的路径名,注意GitHub上该目录必须存在</p>\n<p>自定义域名不用设置。</p>\n<p>至此，使用PicGo和GitHub创建个人图床已经完成。可以愉快的上传图片了。</p>\n<p>参考：</p>\n<p>1.<a href=\"https://github.com/nnngu/FigureBed\" target=\"_blank\" rel=\"noopener\">https://github.com/nnngu/FigureBed</a></p>\n<p>2.<a href=\"https://blog.csdn.net/yefcion/article/details/88412025\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/yefcion/article/details/88412025</a></p>\n<p>3.另外一款图床工具感觉也不错。<a href=\"https://github.com/xiebruce/PicUploader\" target=\"_blank\" rel=\"noopener\">https://github.com/xiebruce/PicUploader</a></p>"},{"title":"CentOS7下搭建FTP","date":"2019-05-11T15:25:54.000Z","toc_number":false,"_content":"\n\n\n# Cent OS下搭建FTP服务器\n\n环境：\n\n- 百度云服务器Cent OS 7\n- 使用客户端win 10\n\n<!--more-->\n\n## 1. 安装并启动 FTP 服务\n\n### 1-1. 安装 VSFTPD\n\n使用 `yum` 安装 `vsftpd`\n\n```shell\nyum install -y vsftpd\n```\n\n### 1-2. 启动 VSFTPD\n\n安装完成后，启动 FTP 服务：\n\n```bash\nservice vsftpd start\n# CentOS 7使用下面的命令启动服务\nsystemctl start vsftpd.service\n# 开机自启\nsystemctl enable vsftpd\n```\n\n启动后，可以看到系统已经监听了 21 端口：\n\n```shell\nnetstat -nltp | grep 21\n```\n\n此时，访问 ftp://192.168.1.170 可浏览机器上的 /var/ftp目录了。\n\n## 2. 配置 FTP 权限\n\n### 2-1. 了解 VSFTP 配置\n\nvsftpd 的配置目录为 /etc/vsftpd，包含下列的配置文件：\n\n- vsftpd.conf 为主要配置文件\n- ftpusers 配置禁止访问 FTP 服务器的用户列表\n- user_list 配置用户访问控制\n\n### 2-2. 阻止匿名访问和切换根目录\n\n匿名访问和切换根目录都会给服务器带来安全风险，我们把这两个功能关闭。\n\n编辑 /etc/vsftpd/vsftpd.conf，找到下面两处配置并修改：\n\n```xml\n# 禁用匿名用户  12 YES 改为NO\nanonymous_enable=NO\n\n# 禁止切换根目录 101 行 删除#\nchroot_local_user=YES\n```\n\n编辑完成后保存配置，重新启动 FTP 服务\n\n```bash\nservice vsftpd restart\n# CentOS 7\nsystemctl restart vsftpd.service\n```\n\n\n\nvsftpd.conf配置文件\n\n```properties\n# 是否允许匿名登录\nanonymous_enable=YES\n# 是否允许本地用户登录\nlocal_enable=YES\n# 是否允许本地用户对FTP服务器文件具有写权限\nwrite_enable=YES\n# 本地用户主目录\nlocal_root=/var/ftp\n# 匿名用户主目录\nanon_root=/var/ftp/pub\n# 是否允许匿名用户上传文件，如允许，须将全局的write_enable=YES\nanon_upload_enable=YES\n# 是否允许匿名用户创建新文件夹\nanon_mkdir_write_enable=YES\n# 容许匿名用户除了新建和上传外的其他权限\nanon_other_write_enable=YES\n# 本地用户掩码\nlocal_umask=022\n# 设置匿名登入者新增或上传档案时的umask值\nanon_umask=022\n# 是否激活目录欢迎信息功能\ndirmessage_enable=YES\nxferlog_enable=YES\n# 主动模式数据传输20端口\nconnect_from_port_20=NO\nxferlog_std_format=YES\n# 是否监听ipv4\nlisten=YES\n# listen_ipv6=YES\n\npam_service_name=vsftpd\nuserlist_enable=YES\ntcp_wrappers=YES\n\n# 是否设置被动模式\npasv_enable=YES\n\n# 被动模式传输使用端口\npasv_min_port=20020\npasv_max_port=20020\n\n# 被动模式返回给客户端的ip地址(服务器内网穿透时使用)\npasv_address=0.0.0.0( 服务器外网ip )\n\n# 设置用户访问目录，默认只允许用户自己的ftp目录\n# 需要同时设置allow_writeable_chroot，允许受限用户的写权限，不然会报错\nchroot_local_user=YES\nchroot_list_enable=YES\nchroot_list_file=/etc/vsftpd/chroot_list\nallow_writeable_chroot=YES\n```\n\n\n\n|                            | chroot_local_user=YES                                        | chroot_local_user=NO                                         |\n| -------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |\n| **chroot_list_enable=YES** | 1.所有用户都被限制在其主目录下 <br/>2.使用chroot_list_file指定的用户列表，这些用户作为“例外”，不受限制 | 1.所有用户都不被限制其主目录下 <br/>2.使用chroot_list_file指定的用户列表，这些用户作为“例外”，受到限制 |\n| **chroot_list_enable=NO**  | 1.所有用户都被限制在其主目录下<br/> 2.不使用chroot_list_file指定的用户列表，没有任何“例外”用户 | 1.所有用户都不被限制其主目录下<br/> 2.不使用chroot_list_file指定的用户列表，没有任何“例外”用户 |\n\n\n\n### 2-3. 创建 FTP 用户\n\n创建一个用户 `ftpuser`\n\n```bash\nuseradd ftpuser\n```\n\n为用户 ftpuser 设置密码\n\n```bash\necho \"pwd\" | passwd ftpuser --stdin\n```\n\n### 2-4. 限制该用户仅能通过 FTP 访问\n\n限制用户 `ftpuser`只能通过 FTP 访问服务器，而不能直接登录服务器：\n\n```bash\nusermod -s /sbin/nologin ftpuser\n\n```\n\n### 2-5. 为用户分配主目录\n\n因安全问题，vsftpd不允许匿名用户在ftp主目录上传，可以新建一个子目录，然后设置权限为777\n\n为用户 `ftpuser`创建主目录并约定：\n\n`/data/ftp` 为主目录, 该目录不可上传文件 \n`/data/ftp/pub` 文件只能上传到该目录下\n\n在`/data`中创建相关的目录\n\n```bash\nmkdir -p /data/ftp/pub\n\n```\n\n#### 2-5-1. 创建登录欢迎文件\n\n```bash\necho \"Welcome to use FTP service.\" > /data/ftp/welcome.txt\n\n```\n\n设置访问权限\n\n```bash\nchmod a-w /data/ftp && chmod 777 -R /data/ftp/pub\n\n```\n\n这里去掉了ftp目录写入的权限\n\n设置为用户的主目录：\n\n```bash\nusermod -d /data/ftp ftpuser\n\n```\n\n\n\n注意：记得关闭防火墙或者开放FTP默认端口(21)\n\n```bash\n# 关闭SELinux服务\nsetenforce 0 \n# 关闭防火墙\niptables -F \n\n```\n\n\n\nbase: https://www.linuxidc.com/Linux/2017-11/148518.htm\n\n\n\n## 3. FTP的连接方式\n\n> FTP是仅基于TCP的服务，不支持UDP。与众不同的是FTP使用2个端口，一个数据端口和一个命令端口（也可叫做控制端口）\n\n> 主动模式和被动模式的不同简单概述为： 主动模式传送数据时是“服务器”连接到“客户端”的端口；被动模式传送数据是“客户端”连接到“服务器”的端口。\n\n> 主动模式需要客户端必须开放端口给服务器，很多客户端都是在防火墙内，开放端口给FTP服务器访问比较困难。\n\n> 被动模式只需要服务器端开放端口给客户端连接就行了。\n\n\n\n### 3-1. 主动模式(PORT)\n\nPORT是主动模式，在建立数据通道时，服务端去连接别人\n\n工作过程：\n\n1. 客户端从一个任意的非特权端口N（N大于1024）连接到FTP服务器的命令端口(21端口)\n2. 客户端开始监听端口N+1，并发送FTP命令“port N+1”到FTP服务器\n3. 服务器会主动从数据端口（20）连接到客户端指定的数据端口（N+1）\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190509223643.png)\n\n**命令连接：客户端 （大于1024端口） ->  服务器 21端口 **\n\n**数据连接：服务器 20端口 ->  客户端（大于1024的端口**\n\n\n\n### 3-2. 被动模式(PASV)\n\nPASV是被动模式，在建立数据通道时，服务端被别人连接。当客户端通知服务器它处于被动模式时才启用\n\n在被动方式FTP中，命令连接和数据连接都由客户端发起，这样就可以解决从服务器到客户端的数据端口的入方向连接被防火墙过滤掉的问题\n\n工作过程：\n\n1. 客户端打开两个任意的非特权本地端口（N 大于 1024和N+1）。第一个端口连接服务器的21端口，然后向服务器发送PASV命令，通知服务端自己处于被动状态（主动方式的FTP不同，客户端不会提交PORT命令并允许服务器来回连它的数据端口）\n2. 服务端收到命令后，会开启一个任意的非特权端口（P大于 1024），并发送PORT P命令给客户端，通知自己的数据端口是P。\n3. 客户端收到命令后，通过N+1端口连接服务器的端口P, 用来传送数据\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190509223749.png)\n\n**命令连接：客户端大于1024端口 -> 服务器 21端口**\n\n**数据连接：客户端大于1024端口 -> 服务器大于1024端口**\n\n\n\n有些ftp客户端默认就是使用PASV被动模式来连接ftp服务器的，如果我们的ftp服务器只支持主动模式，就会造成客户端可以进行用户验证，但无法列目录，也无法进行数据传送，并提示“你没有权限”这样的550返回错误\n\n\n\n### 3-3. 主动模式与被动模式的优缺点\n\n- 主动FTP - 对FTP`服务器`的管理有利\n\n  优点：服务端配置简单，利于服务器安全管理，服务器只需要开放21端口\n\n  缺点：如果客户端开启了防火墙，或客户端处于内网（NAT网关之后）， 那么服务器对客户端端口发起的连接可能会失败\n\n- 被动FTP - 对FTP`客户端`的管理有利\n\n  缺点：服务器配置管理稍显复杂，不利于安全，服务器需要开放随机高位端口以便客户端可以连接，因此大多数FTP服务软件都可以手动配置被动端口的范围\n\n  优点：对客户端网络环境没有要求\n\n\n\n### 3-4. 常用方案\n\n被动模式下，在FTP服务端设置被动模式下开放的随机端口范围，然后设置服务器防火墙规则，开放服务器端对应的端口\n\n```properties\npasv_enable=YES   //开启PASV模式\npasv_min_port=40000   //最小端口号\npasv_max_port=40000   //最大端口号\npasv_promiscuous=YES\n\n```\n\n\n\n## 4. DOS环境下FTP常用命令\n\n```bash\n# 与服务器建立连接\nopen/ftp ...\n# 切换目录\ncd\n# 切换本地目录\nlcd\n# 下载文件 / 下载多个文件\nget / wget\n# 上传文件\nsend / put\n# 断开连接\nbye\n# 关闭交互模式\nprompt off\n# 切换主动/被动模式\nquote PORT / PASV\n```\n\n","source":"_posts/20190511-CentOS7下搭建FTP.md","raw":"---\ntitle: CentOS7下搭建FTP\ndate: 2019-05-11 23:25:54\ntags: FTP\ncategory: 服务器\ntoc_number: false\n---\n\n\n\n# Cent OS下搭建FTP服务器\n\n环境：\n\n- 百度云服务器Cent OS 7\n- 使用客户端win 10\n\n<!--more-->\n\n## 1. 安装并启动 FTP 服务\n\n### 1-1. 安装 VSFTPD\n\n使用 `yum` 安装 `vsftpd`\n\n```shell\nyum install -y vsftpd\n```\n\n### 1-2. 启动 VSFTPD\n\n安装完成后，启动 FTP 服务：\n\n```bash\nservice vsftpd start\n# CentOS 7使用下面的命令启动服务\nsystemctl start vsftpd.service\n# 开机自启\nsystemctl enable vsftpd\n```\n\n启动后，可以看到系统已经监听了 21 端口：\n\n```shell\nnetstat -nltp | grep 21\n```\n\n此时，访问 ftp://192.168.1.170 可浏览机器上的 /var/ftp目录了。\n\n## 2. 配置 FTP 权限\n\n### 2-1. 了解 VSFTP 配置\n\nvsftpd 的配置目录为 /etc/vsftpd，包含下列的配置文件：\n\n- vsftpd.conf 为主要配置文件\n- ftpusers 配置禁止访问 FTP 服务器的用户列表\n- user_list 配置用户访问控制\n\n### 2-2. 阻止匿名访问和切换根目录\n\n匿名访问和切换根目录都会给服务器带来安全风险，我们把这两个功能关闭。\n\n编辑 /etc/vsftpd/vsftpd.conf，找到下面两处配置并修改：\n\n```xml\n# 禁用匿名用户  12 YES 改为NO\nanonymous_enable=NO\n\n# 禁止切换根目录 101 行 删除#\nchroot_local_user=YES\n```\n\n编辑完成后保存配置，重新启动 FTP 服务\n\n```bash\nservice vsftpd restart\n# CentOS 7\nsystemctl restart vsftpd.service\n```\n\n\n\nvsftpd.conf配置文件\n\n```properties\n# 是否允许匿名登录\nanonymous_enable=YES\n# 是否允许本地用户登录\nlocal_enable=YES\n# 是否允许本地用户对FTP服务器文件具有写权限\nwrite_enable=YES\n# 本地用户主目录\nlocal_root=/var/ftp\n# 匿名用户主目录\nanon_root=/var/ftp/pub\n# 是否允许匿名用户上传文件，如允许，须将全局的write_enable=YES\nanon_upload_enable=YES\n# 是否允许匿名用户创建新文件夹\nanon_mkdir_write_enable=YES\n# 容许匿名用户除了新建和上传外的其他权限\nanon_other_write_enable=YES\n# 本地用户掩码\nlocal_umask=022\n# 设置匿名登入者新增或上传档案时的umask值\nanon_umask=022\n# 是否激活目录欢迎信息功能\ndirmessage_enable=YES\nxferlog_enable=YES\n# 主动模式数据传输20端口\nconnect_from_port_20=NO\nxferlog_std_format=YES\n# 是否监听ipv4\nlisten=YES\n# listen_ipv6=YES\n\npam_service_name=vsftpd\nuserlist_enable=YES\ntcp_wrappers=YES\n\n# 是否设置被动模式\npasv_enable=YES\n\n# 被动模式传输使用端口\npasv_min_port=20020\npasv_max_port=20020\n\n# 被动模式返回给客户端的ip地址(服务器内网穿透时使用)\npasv_address=0.0.0.0( 服务器外网ip )\n\n# 设置用户访问目录，默认只允许用户自己的ftp目录\n# 需要同时设置allow_writeable_chroot，允许受限用户的写权限，不然会报错\nchroot_local_user=YES\nchroot_list_enable=YES\nchroot_list_file=/etc/vsftpd/chroot_list\nallow_writeable_chroot=YES\n```\n\n\n\n|                            | chroot_local_user=YES                                        | chroot_local_user=NO                                         |\n| -------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |\n| **chroot_list_enable=YES** | 1.所有用户都被限制在其主目录下 <br/>2.使用chroot_list_file指定的用户列表，这些用户作为“例外”，不受限制 | 1.所有用户都不被限制其主目录下 <br/>2.使用chroot_list_file指定的用户列表，这些用户作为“例外”，受到限制 |\n| **chroot_list_enable=NO**  | 1.所有用户都被限制在其主目录下<br/> 2.不使用chroot_list_file指定的用户列表，没有任何“例外”用户 | 1.所有用户都不被限制其主目录下<br/> 2.不使用chroot_list_file指定的用户列表，没有任何“例外”用户 |\n\n\n\n### 2-3. 创建 FTP 用户\n\n创建一个用户 `ftpuser`\n\n```bash\nuseradd ftpuser\n```\n\n为用户 ftpuser 设置密码\n\n```bash\necho \"pwd\" | passwd ftpuser --stdin\n```\n\n### 2-4. 限制该用户仅能通过 FTP 访问\n\n限制用户 `ftpuser`只能通过 FTP 访问服务器，而不能直接登录服务器：\n\n```bash\nusermod -s /sbin/nologin ftpuser\n\n```\n\n### 2-5. 为用户分配主目录\n\n因安全问题，vsftpd不允许匿名用户在ftp主目录上传，可以新建一个子目录，然后设置权限为777\n\n为用户 `ftpuser`创建主目录并约定：\n\n`/data/ftp` 为主目录, 该目录不可上传文件 \n`/data/ftp/pub` 文件只能上传到该目录下\n\n在`/data`中创建相关的目录\n\n```bash\nmkdir -p /data/ftp/pub\n\n```\n\n#### 2-5-1. 创建登录欢迎文件\n\n```bash\necho \"Welcome to use FTP service.\" > /data/ftp/welcome.txt\n\n```\n\n设置访问权限\n\n```bash\nchmod a-w /data/ftp && chmod 777 -R /data/ftp/pub\n\n```\n\n这里去掉了ftp目录写入的权限\n\n设置为用户的主目录：\n\n```bash\nusermod -d /data/ftp ftpuser\n\n```\n\n\n\n注意：记得关闭防火墙或者开放FTP默认端口(21)\n\n```bash\n# 关闭SELinux服务\nsetenforce 0 \n# 关闭防火墙\niptables -F \n\n```\n\n\n\nbase: https://www.linuxidc.com/Linux/2017-11/148518.htm\n\n\n\n## 3. FTP的连接方式\n\n> FTP是仅基于TCP的服务，不支持UDP。与众不同的是FTP使用2个端口，一个数据端口和一个命令端口（也可叫做控制端口）\n\n> 主动模式和被动模式的不同简单概述为： 主动模式传送数据时是“服务器”连接到“客户端”的端口；被动模式传送数据是“客户端”连接到“服务器”的端口。\n\n> 主动模式需要客户端必须开放端口给服务器，很多客户端都是在防火墙内，开放端口给FTP服务器访问比较困难。\n\n> 被动模式只需要服务器端开放端口给客户端连接就行了。\n\n\n\n### 3-1. 主动模式(PORT)\n\nPORT是主动模式，在建立数据通道时，服务端去连接别人\n\n工作过程：\n\n1. 客户端从一个任意的非特权端口N（N大于1024）连接到FTP服务器的命令端口(21端口)\n2. 客户端开始监听端口N+1，并发送FTP命令“port N+1”到FTP服务器\n3. 服务器会主动从数据端口（20）连接到客户端指定的数据端口（N+1）\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190509223643.png)\n\n**命令连接：客户端 （大于1024端口） ->  服务器 21端口 **\n\n**数据连接：服务器 20端口 ->  客户端（大于1024的端口**\n\n\n\n### 3-2. 被动模式(PASV)\n\nPASV是被动模式，在建立数据通道时，服务端被别人连接。当客户端通知服务器它处于被动模式时才启用\n\n在被动方式FTP中，命令连接和数据连接都由客户端发起，这样就可以解决从服务器到客户端的数据端口的入方向连接被防火墙过滤掉的问题\n\n工作过程：\n\n1. 客户端打开两个任意的非特权本地端口（N 大于 1024和N+1）。第一个端口连接服务器的21端口，然后向服务器发送PASV命令，通知服务端自己处于被动状态（主动方式的FTP不同，客户端不会提交PORT命令并允许服务器来回连它的数据端口）\n2. 服务端收到命令后，会开启一个任意的非特权端口（P大于 1024），并发送PORT P命令给客户端，通知自己的数据端口是P。\n3. 客户端收到命令后，通过N+1端口连接服务器的端口P, 用来传送数据\n\n![](https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190509223749.png)\n\n**命令连接：客户端大于1024端口 -> 服务器 21端口**\n\n**数据连接：客户端大于1024端口 -> 服务器大于1024端口**\n\n\n\n有些ftp客户端默认就是使用PASV被动模式来连接ftp服务器的，如果我们的ftp服务器只支持主动模式，就会造成客户端可以进行用户验证，但无法列目录，也无法进行数据传送，并提示“你没有权限”这样的550返回错误\n\n\n\n### 3-3. 主动模式与被动模式的优缺点\n\n- 主动FTP - 对FTP`服务器`的管理有利\n\n  优点：服务端配置简单，利于服务器安全管理，服务器只需要开放21端口\n\n  缺点：如果客户端开启了防火墙，或客户端处于内网（NAT网关之后）， 那么服务器对客户端端口发起的连接可能会失败\n\n- 被动FTP - 对FTP`客户端`的管理有利\n\n  缺点：服务器配置管理稍显复杂，不利于安全，服务器需要开放随机高位端口以便客户端可以连接，因此大多数FTP服务软件都可以手动配置被动端口的范围\n\n  优点：对客户端网络环境没有要求\n\n\n\n### 3-4. 常用方案\n\n被动模式下，在FTP服务端设置被动模式下开放的随机端口范围，然后设置服务器防火墙规则，开放服务器端对应的端口\n\n```properties\npasv_enable=YES   //开启PASV模式\npasv_min_port=40000   //最小端口号\npasv_max_port=40000   //最大端口号\npasv_promiscuous=YES\n\n```\n\n\n\n## 4. DOS环境下FTP常用命令\n\n```bash\n# 与服务器建立连接\nopen/ftp ...\n# 切换目录\ncd\n# 切换本地目录\nlcd\n# 下载文件 / 下载多个文件\nget / wget\n# 上传文件\nsend / put\n# 断开连接\nbye\n# 关闭交互模式\nprompt off\n# 切换主动/被动模式\nquote PORT / PASV\n```\n\n","slug":"CentOS7下搭建FTP","published":1,"updated":"2019-05-11T15:31:29.657Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck27dih200007mskpdmvhxywz","content":"<h1 id=\"Cent-OS下搭建FTP服务器\"><a href=\"#Cent-OS下搭建FTP服务器\" class=\"headerlink\" title=\"Cent OS下搭建FTP服务器\"></a>Cent OS下搭建FTP服务器</h1><p>环境：</p>\n<ul>\n<li>百度云服务器Cent OS 7</li>\n<li>使用客户端win 10</li>\n</ul>\n<a id=\"more\"></a>\n<h2 id=\"1-安装并启动-FTP-服务\"><a href=\"#1-安装并启动-FTP-服务\" class=\"headerlink\" title=\"1. 安装并启动 FTP 服务\"></a>1. 安装并启动 FTP 服务</h2><h3 id=\"1-1-安装-VSFTPD\"><a href=\"#1-1-安装-VSFTPD\" class=\"headerlink\" title=\"1-1. 安装 VSFTPD\"></a>1-1. 安装 VSFTPD</h3><p>使用 <code>yum</code> 安装 <code>vsftpd</code></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y vsftpd</span><br></pre></td></tr></table></figure>\n<h3 id=\"1-2-启动-VSFTPD\"><a href=\"#1-2-启动-VSFTPD\" class=\"headerlink\" title=\"1-2. 启动 VSFTPD\"></a>1-2. 启动 VSFTPD</h3><p>安装完成后，启动 FTP 服务：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service vsftpd start</span><br><span class=\"line\"><span class=\"comment\"># CentOS 7使用下面的命令启动服务</span></span><br><span class=\"line\">systemctl start vsftpd.service</span><br><span class=\"line\"><span class=\"comment\"># 开机自启</span></span><br><span class=\"line\">systemctl <span class=\"built_in\">enable</span> vsftpd</span><br></pre></td></tr></table></figure>\n<p>启动后，可以看到系统已经监听了 21 端口：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">netstat -nltp | grep 21</span><br></pre></td></tr></table></figure>\n<p>此时，访问 <a href=\"ftp://192.168.1.170\" target=\"_blank\" rel=\"noopener\">ftp://192.168.1.170</a> 可浏览机器上的 /var/ftp目录了。</p>\n<h2 id=\"2-配置-FTP-权限\"><a href=\"#2-配置-FTP-权限\" class=\"headerlink\" title=\"2. 配置 FTP 权限\"></a>2. 配置 FTP 权限</h2><h3 id=\"2-1-了解-VSFTP-配置\"><a href=\"#2-1-了解-VSFTP-配置\" class=\"headerlink\" title=\"2-1. 了解 VSFTP 配置\"></a>2-1. 了解 VSFTP 配置</h3><p>vsftpd 的配置目录为 /etc/vsftpd，包含下列的配置文件：</p>\n<ul>\n<li>vsftpd.conf 为主要配置文件</li>\n<li>ftpusers 配置禁止访问 FTP 服务器的用户列表</li>\n<li>user_list 配置用户访问控制</li>\n</ul>\n<h3 id=\"2-2-阻止匿名访问和切换根目录\"><a href=\"#2-2-阻止匿名访问和切换根目录\" class=\"headerlink\" title=\"2-2. 阻止匿名访问和切换根目录\"></a>2-2. 阻止匿名访问和切换根目录</h3><p>匿名访问和切换根目录都会给服务器带来安全风险，我们把这两个功能关闭。</p>\n<p>编辑 /etc/vsftpd/vsftpd.conf，找到下面两处配置并修改：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 禁用匿名用户  12 YES 改为NO</span><br><span class=\"line\">anonymous_enable=NO</span><br><span class=\"line\"></span><br><span class=\"line\"># 禁止切换根目录 101 行 删除#</span><br><span class=\"line\">chroot_local_user=YES</span><br></pre></td></tr></table></figure>\n<p>编辑完成后保存配置，重新启动 FTP 服务</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service vsftpd restart</span><br><span class=\"line\"><span class=\"comment\"># CentOS 7</span></span><br><span class=\"line\">systemctl restart vsftpd.service</span><br></pre></td></tr></table></figure>\n<p>vsftpd.conf配置文件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 是否允许匿名登录</span><br><span class=\"line\">anonymous_enable=YES</span><br><span class=\"line\"># 是否允许本地用户登录</span><br><span class=\"line\">local_enable=YES</span><br><span class=\"line\"># 是否允许本地用户对FTP服务器文件具有写权限</span><br><span class=\"line\">write_enable=YES</span><br><span class=\"line\"># 本地用户主目录</span><br><span class=\"line\">local_root=/var/ftp</span><br><span class=\"line\"># 匿名用户主目录</span><br><span class=\"line\">anon_root=/var/ftp/pub</span><br><span class=\"line\"># 是否允许匿名用户上传文件，如允许，须将全局的write_enable=YES</span><br><span class=\"line\">anon_upload_enable=YES</span><br><span class=\"line\"># 是否允许匿名用户创建新文件夹</span><br><span class=\"line\">anon_mkdir_write_enable=YES</span><br><span class=\"line\"># 容许匿名用户除了新建和上传外的其他权限</span><br><span class=\"line\">anon_other_write_enable=YES</span><br><span class=\"line\"># 本地用户掩码</span><br><span class=\"line\">local_umask=022</span><br><span class=\"line\"># 设置匿名登入者新增或上传档案时的umask值</span><br><span class=\"line\">anon_umask=022</span><br><span class=\"line\"># 是否激活目录欢迎信息功能</span><br><span class=\"line\">dirmessage_enable=YES</span><br><span class=\"line\">xferlog_enable=YES</span><br><span class=\"line\"># 主动模式数据传输20端口</span><br><span class=\"line\">connect_from_port_20=NO</span><br><span class=\"line\">xferlog_std_format=YES</span><br><span class=\"line\"># 是否监听ipv4</span><br><span class=\"line\">listen=YES</span><br><span class=\"line\"># listen_ipv6=YES</span><br><span class=\"line\"></span><br><span class=\"line\">pam_service_name=vsftpd</span><br><span class=\"line\">userlist_enable=YES</span><br><span class=\"line\">tcp_wrappers=YES</span><br><span class=\"line\"></span><br><span class=\"line\"># 是否设置被动模式</span><br><span class=\"line\">pasv_enable=YES</span><br><span class=\"line\"></span><br><span class=\"line\"># 被动模式传输使用端口</span><br><span class=\"line\">pasv_min_port=20020</span><br><span class=\"line\">pasv_max_port=20020</span><br><span class=\"line\"></span><br><span class=\"line\"># 被动模式返回给客户端的ip地址(服务器内网穿透时使用)</span><br><span class=\"line\">pasv_address=0.0.0.0( 服务器外网ip )</span><br><span class=\"line\"></span><br><span class=\"line\"># 设置用户访问目录，默认只允许用户自己的ftp目录</span><br><span class=\"line\"># 需要同时设置allow_writeable_chroot，允许受限用户的写权限，不然会报错</span><br><span class=\"line\">chroot_local_user=YES</span><br><span class=\"line\">chroot_list_enable=YES</span><br><span class=\"line\">chroot_list_file=/etc/vsftpd/chroot_list</span><br><span class=\"line\">allow_writeable_chroot=YES</span><br></pre></td></tr></table></figure>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>chroot_local_user=YES</th>\n<th>chroot_local_user=NO</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>chroot_list_enable=YES</strong></td>\n<td>1.所有用户都被限制在其主目录下 <br>2.使用chroot_list_file指定的用户列表，这些用户作为“例外”，不受限制</td>\n<td>1.所有用户都不被限制其主目录下 <br>2.使用chroot_list_file指定的用户列表，这些用户作为“例外”，受到限制</td>\n</tr>\n<tr>\n<td><strong>chroot_list_enable=NO</strong></td>\n<td>1.所有用户都被限制在其主目录下<br> 2.不使用chroot_list_file指定的用户列表，没有任何“例外”用户</td>\n<td>1.所有用户都不被限制其主目录下<br> 2.不使用chroot_list_file指定的用户列表，没有任何“例外”用户</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"2-3-创建-FTP-用户\"><a href=\"#2-3-创建-FTP-用户\" class=\"headerlink\" title=\"2-3. 创建 FTP 用户\"></a>2-3. 创建 FTP 用户</h3><p>创建一个用户 <code>ftpuser</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">useradd ftpuser</span><br></pre></td></tr></table></figure>\n<p>为用户 ftpuser 设置密码</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"pwd\"</span> | passwd ftpuser --stdin</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-4-限制该用户仅能通过-FTP-访问\"><a href=\"#2-4-限制该用户仅能通过-FTP-访问\" class=\"headerlink\" title=\"2-4. 限制该用户仅能通过 FTP 访问\"></a>2-4. 限制该用户仅能通过 FTP 访问</h3><p>限制用户 <code>ftpuser</code>只能通过 FTP 访问服务器，而不能直接登录服务器：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">usermod -s /sbin/nologin ftpuser</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-5-为用户分配主目录\"><a href=\"#2-5-为用户分配主目录\" class=\"headerlink\" title=\"2-5. 为用户分配主目录\"></a>2-5. 为用户分配主目录</h3><p>因安全问题，vsftpd不允许匿名用户在ftp主目录上传，可以新建一个子目录，然后设置权限为777</p>\n<p>为用户 <code>ftpuser</code>创建主目录并约定：</p>\n<p><code>/data/ftp</code> 为主目录, 该目录不可上传文件<br><code>/data/ftp/pub</code> 文件只能上传到该目录下</p>\n<p>在<code>/data</code>中创建相关的目录</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir -p /data/ftp/pub</span><br></pre></td></tr></table></figure>\n<h4 id=\"2-5-1-创建登录欢迎文件\"><a href=\"#2-5-1-创建登录欢迎文件\" class=\"headerlink\" title=\"2-5-1. 创建登录欢迎文件\"></a>2-5-1. 创建登录欢迎文件</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"Welcome to use FTP service.\"</span> &gt; /data/ftp/welcome.txt</span><br></pre></td></tr></table></figure>\n<p>设置访问权限</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod a-w /data/ftp &amp;&amp; chmod 777 -R /data/ftp/pub</span><br></pre></td></tr></table></figure>\n<p>这里去掉了ftp目录写入的权限</p>\n<p>设置为用户的主目录：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">usermod -d /data/ftp ftpuser</span><br></pre></td></tr></table></figure>\n<p>注意：记得关闭防火墙或者开放FTP默认端口(21)</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 关闭SELinux服务</span></span><br><span class=\"line\">setenforce 0 </span><br><span class=\"line\"><span class=\"comment\"># 关闭防火墙</span></span><br><span class=\"line\">iptables -F</span><br></pre></td></tr></table></figure>\n<p>base: <a href=\"https://www.linuxidc.com/Linux/2017-11/148518.htm\" target=\"_blank\" rel=\"noopener\">https://www.linuxidc.com/Linux/2017-11/148518.htm</a></p>\n<h2 id=\"3-FTP的连接方式\"><a href=\"#3-FTP的连接方式\" class=\"headerlink\" title=\"3. FTP的连接方式\"></a>3. FTP的连接方式</h2><blockquote>\n<p>FTP是仅基于TCP的服务，不支持UDP。与众不同的是FTP使用2个端口，一个数据端口和一个命令端口（也可叫做控制端口）</p>\n</blockquote>\n<blockquote>\n<p>主动模式和被动模式的不同简单概述为： 主动模式传送数据时是“服务器”连接到“客户端”的端口；被动模式传送数据是“客户端”连接到“服务器”的端口。</p>\n</blockquote>\n<blockquote>\n<p>主动模式需要客户端必须开放端口给服务器，很多客户端都是在防火墙内，开放端口给FTP服务器访问比较困难。</p>\n</blockquote>\n<blockquote>\n<p>被动模式只需要服务器端开放端口给客户端连接就行了。</p>\n</blockquote>\n<h3 id=\"3-1-主动模式-PORT\"><a href=\"#3-1-主动模式-PORT\" class=\"headerlink\" title=\"3-1. 主动模式(PORT)\"></a>3-1. 主动模式(PORT)</h3><p>PORT是主动模式，在建立数据通道时，服务端去连接别人</p>\n<p>工作过程：</p>\n<ol>\n<li>客户端从一个任意的非特权端口N（N大于1024）连接到FTP服务器的命令端口(21端口)</li>\n<li>客户端开始监听端口N+1，并发送FTP命令“port N+1”到FTP服务器</li>\n<li>服务器会主动从数据端口（20）连接到客户端指定的数据端口（N+1）</li>\n</ol>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190509223643.png\" alt></p>\n<p><strong>命令连接：客户端 （大于1024端口） -&gt;  服务器 21端口 </strong></p>\n<p><strong>数据连接：服务器 20端口 -&gt;  客户端（大于1024的端口</strong></p>\n<h3 id=\"3-2-被动模式-PASV\"><a href=\"#3-2-被动模式-PASV\" class=\"headerlink\" title=\"3-2. 被动模式(PASV)\"></a>3-2. 被动模式(PASV)</h3><p>PASV是被动模式，在建立数据通道时，服务端被别人连接。当客户端通知服务器它处于被动模式时才启用</p>\n<p>在被动方式FTP中，命令连接和数据连接都由客户端发起，这样就可以解决从服务器到客户端的数据端口的入方向连接被防火墙过滤掉的问题</p>\n<p>工作过程：</p>\n<ol>\n<li>客户端打开两个任意的非特权本地端口（N 大于 1024和N+1）。第一个端口连接服务器的21端口，然后向服务器发送PASV命令，通知服务端自己处于被动状态（主动方式的FTP不同，客户端不会提交PORT命令并允许服务器来回连它的数据端口）</li>\n<li>服务端收到命令后，会开启一个任意的非特权端口（P大于 1024），并发送PORT P命令给客户端，通知自己的数据端口是P。</li>\n<li>客户端收到命令后，通过N+1端口连接服务器的端口P, 用来传送数据</li>\n</ol>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190509223749.png\" alt></p>\n<p><strong>命令连接：客户端大于1024端口 -&gt; 服务器 21端口</strong></p>\n<p><strong>数据连接：客户端大于1024端口 -&gt; 服务器大于1024端口</strong></p>\n<p>有些ftp客户端默认就是使用PASV被动模式来连接ftp服务器的，如果我们的ftp服务器只支持主动模式，就会造成客户端可以进行用户验证，但无法列目录，也无法进行数据传送，并提示“你没有权限”这样的550返回错误</p>\n<h3 id=\"3-3-主动模式与被动模式的优缺点\"><a href=\"#3-3-主动模式与被动模式的优缺点\" class=\"headerlink\" title=\"3-3. 主动模式与被动模式的优缺点\"></a>3-3. 主动模式与被动模式的优缺点</h3><ul>\n<li><p>主动FTP - 对FTP<code>服务器</code>的管理有利</p>\n<p>优点：服务端配置简单，利于服务器安全管理，服务器只需要开放21端口</p>\n<p>缺点：如果客户端开启了防火墙，或客户端处于内网（NAT网关之后）， 那么服务器对客户端端口发起的连接可能会失败</p>\n</li>\n<li><p>被动FTP - 对FTP<code>客户端</code>的管理有利</p>\n<p>缺点：服务器配置管理稍显复杂，不利于安全，服务器需要开放随机高位端口以便客户端可以连接，因此大多数FTP服务软件都可以手动配置被动端口的范围</p>\n<p>优点：对客户端网络环境没有要求</p>\n</li>\n</ul>\n<h3 id=\"3-4-常用方案\"><a href=\"#3-4-常用方案\" class=\"headerlink\" title=\"3-4. 常用方案\"></a>3-4. 常用方案</h3><p>被动模式下，在FTP服务端设置被动模式下开放的随机端口范围，然后设置服务器防火墙规则，开放服务器端对应的端口</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pasv_enable=YES   //开启PASV模式</span><br><span class=\"line\">pasv_min_port=40000   //最小端口号</span><br><span class=\"line\">pasv_max_port=40000   //最大端口号</span><br><span class=\"line\">pasv_promiscuous=YES</span><br></pre></td></tr></table></figure>\n<h2 id=\"4-DOS环境下FTP常用命令\"><a href=\"#4-DOS环境下FTP常用命令\" class=\"headerlink\" title=\"4. DOS环境下FTP常用命令\"></a>4. DOS环境下FTP常用命令</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 与服务器建立连接</span></span><br><span class=\"line\">open/ftp ...</span><br><span class=\"line\"><span class=\"comment\"># 切换目录</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span></span><br><span class=\"line\"><span class=\"comment\"># 切换本地目录</span></span><br><span class=\"line\">lcd</span><br><span class=\"line\"><span class=\"comment\"># 下载文件 / 下载多个文件</span></span><br><span class=\"line\">get / wget</span><br><span class=\"line\"><span class=\"comment\"># 上传文件</span></span><br><span class=\"line\">send / put</span><br><span class=\"line\"><span class=\"comment\"># 断开连接</span></span><br><span class=\"line\"><span class=\"built_in\">bye</span></span><br><span class=\"line\"><span class=\"comment\"># 关闭交互模式</span></span><br><span class=\"line\">prompt off</span><br><span class=\"line\"><span class=\"comment\"># 切换主动/被动模式</span></span><br><span class=\"line\">quote PORT / PASV</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"length":4242,"excerpt":"<h1 id=\"Cent-OS下搭建FTP服务器\"><a href=\"#Cent-OS下搭建FTP服务器\" class=\"headerlink\" title=\"Cent OS下搭建FTP服务器\"></a>Cent OS下搭建FTP服务器</h1><p>环境：</p>\n<ul>\n<li>百度云服务器Cent OS 7</li>\n<li>使用客户端win 10</li>\n</ul>","more":"<h2 id=\"1-安装并启动-FTP-服务\"><a href=\"#1-安装并启动-FTP-服务\" class=\"headerlink\" title=\"1. 安装并启动 FTP 服务\"></a>1. 安装并启动 FTP 服务</h2><h3 id=\"1-1-安装-VSFTPD\"><a href=\"#1-1-安装-VSFTPD\" class=\"headerlink\" title=\"1-1. 安装 VSFTPD\"></a>1-1. 安装 VSFTPD</h3><p>使用 <code>yum</code> 安装 <code>vsftpd</code></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y vsftpd</span><br></pre></td></tr></table></figure>\n<h3 id=\"1-2-启动-VSFTPD\"><a href=\"#1-2-启动-VSFTPD\" class=\"headerlink\" title=\"1-2. 启动 VSFTPD\"></a>1-2. 启动 VSFTPD</h3><p>安装完成后，启动 FTP 服务：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service vsftpd start</span><br><span class=\"line\"><span class=\"comment\"># CentOS 7使用下面的命令启动服务</span></span><br><span class=\"line\">systemctl start vsftpd.service</span><br><span class=\"line\"><span class=\"comment\"># 开机自启</span></span><br><span class=\"line\">systemctl <span class=\"built_in\">enable</span> vsftpd</span><br></pre></td></tr></table></figure>\n<p>启动后，可以看到系统已经监听了 21 端口：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">netstat -nltp | grep 21</span><br></pre></td></tr></table></figure>\n<p>此时，访问 <a href=\"ftp://192.168.1.170\" target=\"_blank\" rel=\"noopener\">ftp://192.168.1.170</a> 可浏览机器上的 /var/ftp目录了。</p>\n<h2 id=\"2-配置-FTP-权限\"><a href=\"#2-配置-FTP-权限\" class=\"headerlink\" title=\"2. 配置 FTP 权限\"></a>2. 配置 FTP 权限</h2><h3 id=\"2-1-了解-VSFTP-配置\"><a href=\"#2-1-了解-VSFTP-配置\" class=\"headerlink\" title=\"2-1. 了解 VSFTP 配置\"></a>2-1. 了解 VSFTP 配置</h3><p>vsftpd 的配置目录为 /etc/vsftpd，包含下列的配置文件：</p>\n<ul>\n<li>vsftpd.conf 为主要配置文件</li>\n<li>ftpusers 配置禁止访问 FTP 服务器的用户列表</li>\n<li>user_list 配置用户访问控制</li>\n</ul>\n<h3 id=\"2-2-阻止匿名访问和切换根目录\"><a href=\"#2-2-阻止匿名访问和切换根目录\" class=\"headerlink\" title=\"2-2. 阻止匿名访问和切换根目录\"></a>2-2. 阻止匿名访问和切换根目录</h3><p>匿名访问和切换根目录都会给服务器带来安全风险，我们把这两个功能关闭。</p>\n<p>编辑 /etc/vsftpd/vsftpd.conf，找到下面两处配置并修改：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 禁用匿名用户  12 YES 改为NO</span><br><span class=\"line\">anonymous_enable=NO</span><br><span class=\"line\"></span><br><span class=\"line\"># 禁止切换根目录 101 行 删除#</span><br><span class=\"line\">chroot_local_user=YES</span><br></pre></td></tr></table></figure>\n<p>编辑完成后保存配置，重新启动 FTP 服务</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service vsftpd restart</span><br><span class=\"line\"><span class=\"comment\"># CentOS 7</span></span><br><span class=\"line\">systemctl restart vsftpd.service</span><br></pre></td></tr></table></figure>\n<p>vsftpd.conf配置文件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 是否允许匿名登录</span><br><span class=\"line\">anonymous_enable=YES</span><br><span class=\"line\"># 是否允许本地用户登录</span><br><span class=\"line\">local_enable=YES</span><br><span class=\"line\"># 是否允许本地用户对FTP服务器文件具有写权限</span><br><span class=\"line\">write_enable=YES</span><br><span class=\"line\"># 本地用户主目录</span><br><span class=\"line\">local_root=/var/ftp</span><br><span class=\"line\"># 匿名用户主目录</span><br><span class=\"line\">anon_root=/var/ftp/pub</span><br><span class=\"line\"># 是否允许匿名用户上传文件，如允许，须将全局的write_enable=YES</span><br><span class=\"line\">anon_upload_enable=YES</span><br><span class=\"line\"># 是否允许匿名用户创建新文件夹</span><br><span class=\"line\">anon_mkdir_write_enable=YES</span><br><span class=\"line\"># 容许匿名用户除了新建和上传外的其他权限</span><br><span class=\"line\">anon_other_write_enable=YES</span><br><span class=\"line\"># 本地用户掩码</span><br><span class=\"line\">local_umask=022</span><br><span class=\"line\"># 设置匿名登入者新增或上传档案时的umask值</span><br><span class=\"line\">anon_umask=022</span><br><span class=\"line\"># 是否激活目录欢迎信息功能</span><br><span class=\"line\">dirmessage_enable=YES</span><br><span class=\"line\">xferlog_enable=YES</span><br><span class=\"line\"># 主动模式数据传输20端口</span><br><span class=\"line\">connect_from_port_20=NO</span><br><span class=\"line\">xferlog_std_format=YES</span><br><span class=\"line\"># 是否监听ipv4</span><br><span class=\"line\">listen=YES</span><br><span class=\"line\"># listen_ipv6=YES</span><br><span class=\"line\"></span><br><span class=\"line\">pam_service_name=vsftpd</span><br><span class=\"line\">userlist_enable=YES</span><br><span class=\"line\">tcp_wrappers=YES</span><br><span class=\"line\"></span><br><span class=\"line\"># 是否设置被动模式</span><br><span class=\"line\">pasv_enable=YES</span><br><span class=\"line\"></span><br><span class=\"line\"># 被动模式传输使用端口</span><br><span class=\"line\">pasv_min_port=20020</span><br><span class=\"line\">pasv_max_port=20020</span><br><span class=\"line\"></span><br><span class=\"line\"># 被动模式返回给客户端的ip地址(服务器内网穿透时使用)</span><br><span class=\"line\">pasv_address=0.0.0.0( 服务器外网ip )</span><br><span class=\"line\"></span><br><span class=\"line\"># 设置用户访问目录，默认只允许用户自己的ftp目录</span><br><span class=\"line\"># 需要同时设置allow_writeable_chroot，允许受限用户的写权限，不然会报错</span><br><span class=\"line\">chroot_local_user=YES</span><br><span class=\"line\">chroot_list_enable=YES</span><br><span class=\"line\">chroot_list_file=/etc/vsftpd/chroot_list</span><br><span class=\"line\">allow_writeable_chroot=YES</span><br></pre></td></tr></table></figure>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>chroot_local_user=YES</th>\n<th>chroot_local_user=NO</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>chroot_list_enable=YES</strong></td>\n<td>1.所有用户都被限制在其主目录下 <br>2.使用chroot_list_file指定的用户列表，这些用户作为“例外”，不受限制</td>\n<td>1.所有用户都不被限制其主目录下 <br>2.使用chroot_list_file指定的用户列表，这些用户作为“例外”，受到限制</td>\n</tr>\n<tr>\n<td><strong>chroot_list_enable=NO</strong></td>\n<td>1.所有用户都被限制在其主目录下<br> 2.不使用chroot_list_file指定的用户列表，没有任何“例外”用户</td>\n<td>1.所有用户都不被限制其主目录下<br> 2.不使用chroot_list_file指定的用户列表，没有任何“例外”用户</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"2-3-创建-FTP-用户\"><a href=\"#2-3-创建-FTP-用户\" class=\"headerlink\" title=\"2-3. 创建 FTP 用户\"></a>2-3. 创建 FTP 用户</h3><p>创建一个用户 <code>ftpuser</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">useradd ftpuser</span><br></pre></td></tr></table></figure>\n<p>为用户 ftpuser 设置密码</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"pwd\"</span> | passwd ftpuser --stdin</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-4-限制该用户仅能通过-FTP-访问\"><a href=\"#2-4-限制该用户仅能通过-FTP-访问\" class=\"headerlink\" title=\"2-4. 限制该用户仅能通过 FTP 访问\"></a>2-4. 限制该用户仅能通过 FTP 访问</h3><p>限制用户 <code>ftpuser</code>只能通过 FTP 访问服务器，而不能直接登录服务器：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">usermod -s /sbin/nologin ftpuser</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-5-为用户分配主目录\"><a href=\"#2-5-为用户分配主目录\" class=\"headerlink\" title=\"2-5. 为用户分配主目录\"></a>2-5. 为用户分配主目录</h3><p>因安全问题，vsftpd不允许匿名用户在ftp主目录上传，可以新建一个子目录，然后设置权限为777</p>\n<p>为用户 <code>ftpuser</code>创建主目录并约定：</p>\n<p><code>/data/ftp</code> 为主目录, 该目录不可上传文件<br><code>/data/ftp/pub</code> 文件只能上传到该目录下</p>\n<p>在<code>/data</code>中创建相关的目录</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir -p /data/ftp/pub</span><br></pre></td></tr></table></figure>\n<h4 id=\"2-5-1-创建登录欢迎文件\"><a href=\"#2-5-1-创建登录欢迎文件\" class=\"headerlink\" title=\"2-5-1. 创建登录欢迎文件\"></a>2-5-1. 创建登录欢迎文件</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"Welcome to use FTP service.\"</span> &gt; /data/ftp/welcome.txt</span><br></pre></td></tr></table></figure>\n<p>设置访问权限</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod a-w /data/ftp &amp;&amp; chmod 777 -R /data/ftp/pub</span><br></pre></td></tr></table></figure>\n<p>这里去掉了ftp目录写入的权限</p>\n<p>设置为用户的主目录：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">usermod -d /data/ftp ftpuser</span><br></pre></td></tr></table></figure>\n<p>注意：记得关闭防火墙或者开放FTP默认端口(21)</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 关闭SELinux服务</span></span><br><span class=\"line\">setenforce 0 </span><br><span class=\"line\"><span class=\"comment\"># 关闭防火墙</span></span><br><span class=\"line\">iptables -F</span><br></pre></td></tr></table></figure>\n<p>base: <a href=\"https://www.linuxidc.com/Linux/2017-11/148518.htm\" target=\"_blank\" rel=\"noopener\">https://www.linuxidc.com/Linux/2017-11/148518.htm</a></p>\n<h2 id=\"3-FTP的连接方式\"><a href=\"#3-FTP的连接方式\" class=\"headerlink\" title=\"3. FTP的连接方式\"></a>3. FTP的连接方式</h2><blockquote>\n<p>FTP是仅基于TCP的服务，不支持UDP。与众不同的是FTP使用2个端口，一个数据端口和一个命令端口（也可叫做控制端口）</p>\n</blockquote>\n<blockquote>\n<p>主动模式和被动模式的不同简单概述为： 主动模式传送数据时是“服务器”连接到“客户端”的端口；被动模式传送数据是“客户端”连接到“服务器”的端口。</p>\n</blockquote>\n<blockquote>\n<p>主动模式需要客户端必须开放端口给服务器，很多客户端都是在防火墙内，开放端口给FTP服务器访问比较困难。</p>\n</blockquote>\n<blockquote>\n<p>被动模式只需要服务器端开放端口给客户端连接就行了。</p>\n</blockquote>\n<h3 id=\"3-1-主动模式-PORT\"><a href=\"#3-1-主动模式-PORT\" class=\"headerlink\" title=\"3-1. 主动模式(PORT)\"></a>3-1. 主动模式(PORT)</h3><p>PORT是主动模式，在建立数据通道时，服务端去连接别人</p>\n<p>工作过程：</p>\n<ol>\n<li>客户端从一个任意的非特权端口N（N大于1024）连接到FTP服务器的命令端口(21端口)</li>\n<li>客户端开始监听端口N+1，并发送FTP命令“port N+1”到FTP服务器</li>\n<li>服务器会主动从数据端口（20）连接到客户端指定的数据端口（N+1）</li>\n</ol>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190509223643.png\" alt></p>\n<p><strong>命令连接：客户端 （大于1024端口） -&gt;  服务器 21端口 </strong></p>\n<p><strong>数据连接：服务器 20端口 -&gt;  客户端（大于1024的端口</strong></p>\n<h3 id=\"3-2-被动模式-PASV\"><a href=\"#3-2-被动模式-PASV\" class=\"headerlink\" title=\"3-2. 被动模式(PASV)\"></a>3-2. 被动模式(PASV)</h3><p>PASV是被动模式，在建立数据通道时，服务端被别人连接。当客户端通知服务器它处于被动模式时才启用</p>\n<p>在被动方式FTP中，命令连接和数据连接都由客户端发起，这样就可以解决从服务器到客户端的数据端口的入方向连接被防火墙过滤掉的问题</p>\n<p>工作过程：</p>\n<ol>\n<li>客户端打开两个任意的非特权本地端口（N 大于 1024和N+1）。第一个端口连接服务器的21端口，然后向服务器发送PASV命令，通知服务端自己处于被动状态（主动方式的FTP不同，客户端不会提交PORT命令并允许服务器来回连它的数据端口）</li>\n<li>服务端收到命令后，会开启一个任意的非特权端口（P大于 1024），并发送PORT P命令给客户端，通知自己的数据端口是P。</li>\n<li>客户端收到命令后，通过N+1端口连接服务器的端口P, 用来传送数据</li>\n</ol>\n<p><img src=\"https://raw.githubusercontent.com/hyman213/FigureBed/master/2019/05/20190509223749.png\" alt></p>\n<p><strong>命令连接：客户端大于1024端口 -&gt; 服务器 21端口</strong></p>\n<p><strong>数据连接：客户端大于1024端口 -&gt; 服务器大于1024端口</strong></p>\n<p>有些ftp客户端默认就是使用PASV被动模式来连接ftp服务器的，如果我们的ftp服务器只支持主动模式，就会造成客户端可以进行用户验证，但无法列目录，也无法进行数据传送，并提示“你没有权限”这样的550返回错误</p>\n<h3 id=\"3-3-主动模式与被动模式的优缺点\"><a href=\"#3-3-主动模式与被动模式的优缺点\" class=\"headerlink\" title=\"3-3. 主动模式与被动模式的优缺点\"></a>3-3. 主动模式与被动模式的优缺点</h3><ul>\n<li><p>主动FTP - 对FTP<code>服务器</code>的管理有利</p>\n<p>优点：服务端配置简单，利于服务器安全管理，服务器只需要开放21端口</p>\n<p>缺点：如果客户端开启了防火墙，或客户端处于内网（NAT网关之后）， 那么服务器对客户端端口发起的连接可能会失败</p>\n</li>\n<li><p>被动FTP - 对FTP<code>客户端</code>的管理有利</p>\n<p>缺点：服务器配置管理稍显复杂，不利于安全，服务器需要开放随机高位端口以便客户端可以连接，因此大多数FTP服务软件都可以手动配置被动端口的范围</p>\n<p>优点：对客户端网络环境没有要求</p>\n</li>\n</ul>\n<h3 id=\"3-4-常用方案\"><a href=\"#3-4-常用方案\" class=\"headerlink\" title=\"3-4. 常用方案\"></a>3-4. 常用方案</h3><p>被动模式下，在FTP服务端设置被动模式下开放的随机端口范围，然后设置服务器防火墙规则，开放服务器端对应的端口</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pasv_enable=YES   //开启PASV模式</span><br><span class=\"line\">pasv_min_port=40000   //最小端口号</span><br><span class=\"line\">pasv_max_port=40000   //最大端口号</span><br><span class=\"line\">pasv_promiscuous=YES</span><br></pre></td></tr></table></figure>\n<h2 id=\"4-DOS环境下FTP常用命令\"><a href=\"#4-DOS环境下FTP常用命令\" class=\"headerlink\" title=\"4. DOS环境下FTP常用命令\"></a>4. DOS环境下FTP常用命令</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 与服务器建立连接</span></span><br><span class=\"line\">open/ftp ...</span><br><span class=\"line\"><span class=\"comment\"># 切换目录</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span></span><br><span class=\"line\"><span class=\"comment\"># 切换本地目录</span></span><br><span class=\"line\">lcd</span><br><span class=\"line\"><span class=\"comment\"># 下载文件 / 下载多个文件</span></span><br><span class=\"line\">get / wget</span><br><span class=\"line\"><span class=\"comment\"># 上传文件</span></span><br><span class=\"line\">send / put</span><br><span class=\"line\"><span class=\"comment\"># 断开连接</span></span><br><span class=\"line\"><span class=\"built_in\">bye</span></span><br><span class=\"line\"><span class=\"comment\"># 关闭交互模式</span></span><br><span class=\"line\">prompt off</span><br><span class=\"line\"><span class=\"comment\"># 切换主动/被动模式</span></span><br><span class=\"line\">quote PORT / PASV</span><br></pre></td></tr></table></figure>"},{"title":"使用不同json包对象转Json过程中的大小写问题","date":"2019-05-20T13:29:22.000Z","toc_number":false,"_content":"\n# 使用不同工具对象转JsonObject中的大小写问题\n\n对象转json字符串时，针对对象属性不同的大小写，常用的两种工具类json-lib和fastjson转换的结果有差异。记录于此，作为今后的参考。\n\n<!--more-->\n\n## 1. `net.sf.json-lib` 与 `com.alibaba.fastjson`的不同效果\n\n### 1-1. 导入jar包\n\n这里同时导入两个json工具包\n\n```xml\n<dependency>\n    <groupId>net.sf.json-lib</groupId>\n    <artifactId>json-lib</artifactId>\n    <version>2.4</version>\n</dependency>\n\n<dependency>\n    <groupId>com.alibaba</groupId>\n    <artifactId>fastjson</artifactId>\n    <version>1.2.45</version>\n</dependency>\n```\n\n### 1-2. 对象采用驼峰命名法\n\n```java\n@Data\n@AllArgsConstructor\n@NoArgsConstructor\npublic class User {\n\n    private Integer id;\n\n    private String name;\n\n    private String sex;\n\n    private Integer age;\n\n    private String companyName;\n\n}\n\n```\n\n#### 1-2-1. 使用`net.sf.json-lib`\n\n```java\nimport net.sf.json.JSONObject;\n\npublic class JSONUtilsTest {\n\n    public static void main(String[] args) {\n        User user = new User(1, \"zhangsan\", \"Male\", 18, \"华为\");\n        JSONObject jsonObject = JSONObject.fromObject(user);\n        System.out.println(jsonObject.toString());\n    }\n}\n\n结果：(与对象名一致，没毛病)\n{\"age\":18,\"companyName\":\"华为\",\"id\":1,\"name\":\"zhangsan\",\"sex\":\"Male\"}\n```\n\n#### 1-2-2. 使用fastjson\n\n```java\nimport com.alibaba.fastjson.JSONObject;\n\npublic class JSONUtilsTest {\n\n    public static void main(String[] args) {\n        User user = new User(1, \"zhangsan\", \"Male\", 18, \"华为\");\n        String jsonString = JSONObject.toJSONString(user);\n        System.out.println(jsonString);\n    }\n\n}\n结果：(与对象名一致，没毛病)\n{\"age\":18,\"companyName\":\"华为\",\"id\":1,\"name\":\"zhangsan\",\"sex\":\"Male\"}\n```\n\n### 1-3. 对象首字母大写\n\n```java\n@Data\n@AllArgsConstructor\n@NoArgsConstructor\npublic class User {\n\n    private Integer Id;\n\n    private String Name;\n\n    private String Sex;\n\n    private Integer Age;\n\n    private String CompanyName;\n\n    private String Remark;\n\n}\n```\n\n#### 1-3-1. 使用`net.sf.json-lib\n\n```java\nimport net.sf.json.JSONObject;\n\npublic class JSONUtilsTest {\n\n    public static void main(String[] args) {\n        User user1 = new User(1, \"zhangsan\", \"Male\", 18, \"华为\", null);\n        User user2 = new User(2, \"Lisi\", \"Female\", null, \"小米\", \"\");\n        JSONObject jsonObject1 = JSONObject.fromObject(user1);\n        JSONObject jsonObject2 = JSONObject.fromObject(user2);\n        System.out.println(\"user1  \" + jsonObject1.toString());\n        System.out.println(\"user2  \" + jsonObject2.toString());\n    }\n\n}\n\n结果: 首字母变成小写,保留了值为null的节点（0和\"\"）\nuser1  {\"age\":18,\"companyName\":\"华为\",\"id\":1,\"name\":\"zhangsan\",\"remark\":\"\",\"sex\":\"Male\"}\nuser2  {\"age\":0,\"companyName\":\"小米\",\"id\":2,\"name\":\"Lisi\",\"remark\":\"\",\"sex\":\"Female\"}\n```\n\n#### 1-3-2. 使用fastjson\n\n```java\nimport com.alibaba.fastjson.JSONObject;\n\npublic class JSONUtilsTest {\n\n    public static void main(String[] args) {\n        User user1 = new User(1, \"zhangsan\", \"Male\", 18, \"华为\", null);\n        User user2 = new User(2, \"Lisi\", \"Female\", null, \"小米\", \"\");\n        String jsonString1 = JSONObject.toJSONString(user1);\n        String jsonString2 = JSONObject.toJSONString(user2);\n        System.out.println(\"user1  \" + jsonString1);\n        System.out.println(\"user2  \" + jsonString2);\n    }\n\n}\n\n结果：首字母自动变成小写,自动去掉了值为null的节点(为\"\"的仍然保留)\nuser1  {\"age\":18,\"companyName\":\"华为\",\"id\":1,\"name\":\"zhangsan\",\"sex\":\"Male\"}\nuser2  {\"companyName\":\"小米\",\"id\":2,\"name\":\"Lisi\",\"remark\":\"\",\"sex\":\"Female\"}\n```\n\n如果需要一定按指定的字段名，可使用@JSONField\n\n```java\n@Data\n@AllArgsConstructor\n@NoArgsConstructor\npublic class User {\n\n    @JSONField(name = \"Id\")\n    private Integer Id;\n\n    @JSONField(name = \"Name\")\n    private String Name;\n\n    @JSONField(name = \"Sex\")\n    private String Sex;\n\n    @JSONField(name = \"Age\")\n    private Integer Age;\n\n    @JSONField(name = \"CompanyName\")\n    private String CompanyName;\n\n    @JSONField(name = \"Remark\")\n    private String Remark;\n\n}\n\nimport com.alibaba.fastjson.JSONObject;\n\npublic class JSONUtilsTest {\n\n    public static void main(String[] args) {\n        User user1 = new User(1, \"zhangsan\", \"Male\", 18, \"华为\", null);\n        User user2 = new User(2, \"Lisi\", \"Female\", null, \"小米\", \"\");\n        String jsonString1 = JSONObject.toJSONString(user1);\n        String jsonString2 = JSONObject.toJSONString(user2);\n        System.out.println(\"user1  \" + jsonString1);\n        System.out.println(\"user2  \" + jsonString2);\n    }\n\n}\n\n结果: 按JSONField指定的name转json，自动去掉了值为null的节点(为\"\"的仍然保留)\nuser1  {\"Age\":18,\"CompanyName\":\"华为\",\"Id\":1,\"Name\":\"zhangsan\",\"Sex\":\"Male\"}\nuser2  {\"CompanyName\":\"小米\",\"Id\":2,\"Name\":\"Lisi\",\"Remark\":\"\",\"Sex\":\"Female\"}\n```\n\n### 1-4. 对象属性全部大写\n\n```java\n@Data\n@AllArgsConstructor\n@NoArgsConstructor\npublic class User {\n\n    private Integer ID;\n\n    private String NAME;\n\n    private String SEX;\n\n    private Integer AGE;\n\n    private String COMPANYNAME;\n\n    private String REMARK;\n\n}\n\n```\n\n#### 1-4-1. 使用`net.sf.json-lib\n\n```java\nimport net.sf.json.JSONObject;\n\npublic class JSONUtilsTest {\n\n    public static void main(String[] args) {\n        User user1 = new User(1, \"zhangsan\", \"Male\", 18, \"华为\", null);\n        User user2 = new User(2, \"Lisi\", \"Female\", null, \"小米\", \"\");\n        JSONObject jsonObject1 = JSONObject.fromObject(user1);\n        JSONObject jsonObject2 = JSONObject.fromObject(user2);\n        System.out.println(\"user1  \" + jsonObject1.toString());\n        System.out.println(\"user2  \" + jsonObject2.toString());\n    }\n\n}\n\n结果：首字母没有自动变成小写,保留了值为null的节点（0和\"\"）\nuser1  {\"AGE\":18,\"COMPANYNAME\":\"华为\",\"ID\":1,\"NAME\":\"zhangsan\",\"REMARK\":\"\",\"SEX\":\"Male\"}\nuser2  {\"AGE\":0,\"COMPANYNAME\":\"小米\",\"ID\":2,\"NAME\":\"Lisi\",\"REMARK\":\"\",\"SEX\":\"Female\"}\n\n```\n\n#### 1-4-2. 使用fastjson\n\n```json\nimport com.alibaba.fastjson.JSONObject;\n\npublic class JSONUtilsTest {\n\n    public static void main(String[] args) {\n        User user1 = new User(1, \"zhangsan\", \"Male\", 18, \"华为\", null);\n        User user2 = new User(2, \"Lisi\", \"Female\", null, \"小米\", \"\");\n        String jsonString1 = JSONObject.toJSONString(user1);\n        String jsonString2 = JSONObject.toJSONString(user2);\n        System.out.println(\"user1  \" + jsonString1);\n        System.out.println(\"user2  \" + jsonString2);\n    }\n\n}\n\n结果：首字母自动变成小写,自动去掉了值为null的节点(为\"\"的仍然保留)\nuser1  {\"aGE\":18,\"cOMPANYNAME\":\"华为\",\"iD\":1,\"nAME\":\"zhangsan\",\"sEX\":\"Male\"}\nuser2  {\"cOMPANYNAME\":\"小米\",\"iD\":2,\"nAME\":\"Lisi\",\"rEMARK\":\"\",\"sEX\":\"Female\"}\n\n```\n\n## 2. 结论\n\n### 2-1. fastjson\n\n1. 无论对象首字母是大写，或者是小写，转json字符串是都会将首字母自动变成小写。\n2. 默认会将值为null的节点忽略掉\n3. 可通过注解@JSONField，指定对象转json时的key\n\n### 2-2. json-lib\n\n1. 只有在对象属性名全部为大写时，才不会将首字母变为小写，其他情况都会将首字母变成小写\n2. 依然会保留值为null的节点\n\n## 3. 对Date类型的字段格式化的处理\n\n### 3-1. fastjson\n\n默认会将时间转为毫秒值，可使用`JSONObject.toJSONStringWithDateFormat`或者在属性字段上使用`@JSONField(format = \"yyyy-MM-dd HH:mm:ss\")`\n\n```java\nimport com.alibaba.fastjson.JSONObject;\n\nimport java.util.Date;\n\npublic class JSONUtilsTest {\n\n    public static void main(String[] args) {\n        User user1 = new User(1, \"zhangsan\", \"Male\", 18, \"华为\", null, new Date());\n        User user2 = new User(2, \"Lisi\", \"Female\", null, \"小米\", \"\", new Date());\n        String jsonString1 = JSONObject.toJSONStringWithDateFormat(user1, \"yyyy-MM-dd\");\n        String jsonString2 = JSONObject.toJSONString(user2);\n        System.out.println(\"user1  \" + jsonString1);\n        System.out.println(\"user2  \" + jsonString2);\n    }\n\n}\n\n结果：\nuser1  {\"Age\":18,\"CompanyName\":\"华为\",\"Id\":1,\"Name\":\"zhangsan\",\"Sex\":\"Male\",\"birthday\":\"2019-05-21\"}\nuser2  {\"CompanyName\":\"小米\",\"Id\":2,\"Name\":\"Lisi\",\"Remark\":\"\",\"Sex\":\"Female\",\"birthday\":1558398124477}\n```\n\n\n\n### 3-2. json-lib\n\n默认会将Date类型的字段分解, 可通过传入`JsonConfig`并注册`JsonValueProcessor`解决这个问题\n\n```java\nimport net.sf.json.JSONObject;\nimport net.sf.json.JsonConfig;\n\nimport java.util.Date;\n\npublic class JSONUtilsTest {\n\n    public static void main(String[] args) {\n        User user1 = new User(1, \"zhangsan\", \"Male\", 18, \"华为\", null, new Date());\n        User user2 = new User(2, \"Lisi\", \"Female\", null, \"小米\", \"\", new Date());\n        JsonConfig jsonConfig = new JsonConfig();\n        jsonConfig.registerJsonValueProcessor(Date.class, new DateJsonValueProcessor());\n        JSONObject jsonObject1 = JSONObject.fromObject(user1, jsonConfig);\n        JSONObject jsonObject2 = JSONObject.fromObject(user2);\n        System.out.println(\"user1  \" + jsonObject1.toString());\n        System.out.println(\"user2  \" + jsonObject2.toString());\n    }\n\n}\n\nuser1  {\"age\":18,\"birthday\":\"2019-05-21 08:30:53\",\"companyName\":\"华为\",\"id\":1,\"name\":\"zhangsan\",\"remark\":\"\",\"sex\":\"Male\"}\nuser2  {\"age\":0,\"birthday\":{\"date\":21,\"day\":2,\"hours\":8,\"minutes\":30,\"month\":4,\"seconds\":53,\"time\":1558398653824,\"timezoneOffset\":-480,\"year\":119},\"companyName\":\"小米\",\"id\":2,\"name\":\"Lisi\",\"remark\":\"\",\"sex\":\"Female\"}\n\npublic class DateJsonValueProcessor implements JsonValueProcessor {\n\n    private String formatDateTime = \"yyyy-MM-dd HH:mm:ss\";\n\n    private String formatDate = \"yyyy-MM-dd\";\n\n    public DateJsonValueProcessor() {\n\n    }\n\n    public DateJsonValueProcessor(String format) {\n        this.formatDateTime = format;\n    }\n\n    @Override\n    public Object processArrayValue(Object value, JsonConfig jsonConfig) {\n        String[] obj = {};\n        if (value instanceof Date[]) {\n            SimpleDateFormat sf = new SimpleDateFormat(formatDateTime);\n            Date[] dates = (Date[]) value;\n            obj = new String[dates.length];\n            for (int i = 0; i < dates.length; i++) {\n                obj[i] = sf.format(dates[i]);\n            }\n        }\n        return obj;\n    }\n\n    @Override\n    public Object processObjectValue(String key, Object value, JsonConfig jsonConfig) {\n        if (value instanceof Date) {\n            String str = \"\";\n            if (Objects.equals(key, \"checkDate\") || Objects.equals(key, \"validUntil\")) {\n                str = new SimpleDateFormat(formatDate).format((Date) value);\n            } else {\n                str = new SimpleDateFormat(formatDateTime).format((Date) value);\n            }\n            return str;\n        }\n        return value;\n    }\n}\n```\n\n","source":"_posts/20190520-使用不同json包对象转Json过程中的大小写问题.md","raw":"---\ntitle: 使用不同json包对象转Json过程中的大小写问题\ndate: 2019-05-20 21:29:22\ntags: 经验总结\ncategory: Lesson-Learned\ntoc_number: false\n---\n\n# 使用不同工具对象转JsonObject中的大小写问题\n\n对象转json字符串时，针对对象属性不同的大小写，常用的两种工具类json-lib和fastjson转换的结果有差异。记录于此，作为今后的参考。\n\n<!--more-->\n\n## 1. `net.sf.json-lib` 与 `com.alibaba.fastjson`的不同效果\n\n### 1-1. 导入jar包\n\n这里同时导入两个json工具包\n\n```xml\n<dependency>\n    <groupId>net.sf.json-lib</groupId>\n    <artifactId>json-lib</artifactId>\n    <version>2.4</version>\n</dependency>\n\n<dependency>\n    <groupId>com.alibaba</groupId>\n    <artifactId>fastjson</artifactId>\n    <version>1.2.45</version>\n</dependency>\n```\n\n### 1-2. 对象采用驼峰命名法\n\n```java\n@Data\n@AllArgsConstructor\n@NoArgsConstructor\npublic class User {\n\n    private Integer id;\n\n    private String name;\n\n    private String sex;\n\n    private Integer age;\n\n    private String companyName;\n\n}\n\n```\n\n#### 1-2-1. 使用`net.sf.json-lib`\n\n```java\nimport net.sf.json.JSONObject;\n\npublic class JSONUtilsTest {\n\n    public static void main(String[] args) {\n        User user = new User(1, \"zhangsan\", \"Male\", 18, \"华为\");\n        JSONObject jsonObject = JSONObject.fromObject(user);\n        System.out.println(jsonObject.toString());\n    }\n}\n\n结果：(与对象名一致，没毛病)\n{\"age\":18,\"companyName\":\"华为\",\"id\":1,\"name\":\"zhangsan\",\"sex\":\"Male\"}\n```\n\n#### 1-2-2. 使用fastjson\n\n```java\nimport com.alibaba.fastjson.JSONObject;\n\npublic class JSONUtilsTest {\n\n    public static void main(String[] args) {\n        User user = new User(1, \"zhangsan\", \"Male\", 18, \"华为\");\n        String jsonString = JSONObject.toJSONString(user);\n        System.out.println(jsonString);\n    }\n\n}\n结果：(与对象名一致，没毛病)\n{\"age\":18,\"companyName\":\"华为\",\"id\":1,\"name\":\"zhangsan\",\"sex\":\"Male\"}\n```\n\n### 1-3. 对象首字母大写\n\n```java\n@Data\n@AllArgsConstructor\n@NoArgsConstructor\npublic class User {\n\n    private Integer Id;\n\n    private String Name;\n\n    private String Sex;\n\n    private Integer Age;\n\n    private String CompanyName;\n\n    private String Remark;\n\n}\n```\n\n#### 1-3-1. 使用`net.sf.json-lib\n\n```java\nimport net.sf.json.JSONObject;\n\npublic class JSONUtilsTest {\n\n    public static void main(String[] args) {\n        User user1 = new User(1, \"zhangsan\", \"Male\", 18, \"华为\", null);\n        User user2 = new User(2, \"Lisi\", \"Female\", null, \"小米\", \"\");\n        JSONObject jsonObject1 = JSONObject.fromObject(user1);\n        JSONObject jsonObject2 = JSONObject.fromObject(user2);\n        System.out.println(\"user1  \" + jsonObject1.toString());\n        System.out.println(\"user2  \" + jsonObject2.toString());\n    }\n\n}\n\n结果: 首字母变成小写,保留了值为null的节点（0和\"\"）\nuser1  {\"age\":18,\"companyName\":\"华为\",\"id\":1,\"name\":\"zhangsan\",\"remark\":\"\",\"sex\":\"Male\"}\nuser2  {\"age\":0,\"companyName\":\"小米\",\"id\":2,\"name\":\"Lisi\",\"remark\":\"\",\"sex\":\"Female\"}\n```\n\n#### 1-3-2. 使用fastjson\n\n```java\nimport com.alibaba.fastjson.JSONObject;\n\npublic class JSONUtilsTest {\n\n    public static void main(String[] args) {\n        User user1 = new User(1, \"zhangsan\", \"Male\", 18, \"华为\", null);\n        User user2 = new User(2, \"Lisi\", \"Female\", null, \"小米\", \"\");\n        String jsonString1 = JSONObject.toJSONString(user1);\n        String jsonString2 = JSONObject.toJSONString(user2);\n        System.out.println(\"user1  \" + jsonString1);\n        System.out.println(\"user2  \" + jsonString2);\n    }\n\n}\n\n结果：首字母自动变成小写,自动去掉了值为null的节点(为\"\"的仍然保留)\nuser1  {\"age\":18,\"companyName\":\"华为\",\"id\":1,\"name\":\"zhangsan\",\"sex\":\"Male\"}\nuser2  {\"companyName\":\"小米\",\"id\":2,\"name\":\"Lisi\",\"remark\":\"\",\"sex\":\"Female\"}\n```\n\n如果需要一定按指定的字段名，可使用@JSONField\n\n```java\n@Data\n@AllArgsConstructor\n@NoArgsConstructor\npublic class User {\n\n    @JSONField(name = \"Id\")\n    private Integer Id;\n\n    @JSONField(name = \"Name\")\n    private String Name;\n\n    @JSONField(name = \"Sex\")\n    private String Sex;\n\n    @JSONField(name = \"Age\")\n    private Integer Age;\n\n    @JSONField(name = \"CompanyName\")\n    private String CompanyName;\n\n    @JSONField(name = \"Remark\")\n    private String Remark;\n\n}\n\nimport com.alibaba.fastjson.JSONObject;\n\npublic class JSONUtilsTest {\n\n    public static void main(String[] args) {\n        User user1 = new User(1, \"zhangsan\", \"Male\", 18, \"华为\", null);\n        User user2 = new User(2, \"Lisi\", \"Female\", null, \"小米\", \"\");\n        String jsonString1 = JSONObject.toJSONString(user1);\n        String jsonString2 = JSONObject.toJSONString(user2);\n        System.out.println(\"user1  \" + jsonString1);\n        System.out.println(\"user2  \" + jsonString2);\n    }\n\n}\n\n结果: 按JSONField指定的name转json，自动去掉了值为null的节点(为\"\"的仍然保留)\nuser1  {\"Age\":18,\"CompanyName\":\"华为\",\"Id\":1,\"Name\":\"zhangsan\",\"Sex\":\"Male\"}\nuser2  {\"CompanyName\":\"小米\",\"Id\":2,\"Name\":\"Lisi\",\"Remark\":\"\",\"Sex\":\"Female\"}\n```\n\n### 1-4. 对象属性全部大写\n\n```java\n@Data\n@AllArgsConstructor\n@NoArgsConstructor\npublic class User {\n\n    private Integer ID;\n\n    private String NAME;\n\n    private String SEX;\n\n    private Integer AGE;\n\n    private String COMPANYNAME;\n\n    private String REMARK;\n\n}\n\n```\n\n#### 1-4-1. 使用`net.sf.json-lib\n\n```java\nimport net.sf.json.JSONObject;\n\npublic class JSONUtilsTest {\n\n    public static void main(String[] args) {\n        User user1 = new User(1, \"zhangsan\", \"Male\", 18, \"华为\", null);\n        User user2 = new User(2, \"Lisi\", \"Female\", null, \"小米\", \"\");\n        JSONObject jsonObject1 = JSONObject.fromObject(user1);\n        JSONObject jsonObject2 = JSONObject.fromObject(user2);\n        System.out.println(\"user1  \" + jsonObject1.toString());\n        System.out.println(\"user2  \" + jsonObject2.toString());\n    }\n\n}\n\n结果：首字母没有自动变成小写,保留了值为null的节点（0和\"\"）\nuser1  {\"AGE\":18,\"COMPANYNAME\":\"华为\",\"ID\":1,\"NAME\":\"zhangsan\",\"REMARK\":\"\",\"SEX\":\"Male\"}\nuser2  {\"AGE\":0,\"COMPANYNAME\":\"小米\",\"ID\":2,\"NAME\":\"Lisi\",\"REMARK\":\"\",\"SEX\":\"Female\"}\n\n```\n\n#### 1-4-2. 使用fastjson\n\n```json\nimport com.alibaba.fastjson.JSONObject;\n\npublic class JSONUtilsTest {\n\n    public static void main(String[] args) {\n        User user1 = new User(1, \"zhangsan\", \"Male\", 18, \"华为\", null);\n        User user2 = new User(2, \"Lisi\", \"Female\", null, \"小米\", \"\");\n        String jsonString1 = JSONObject.toJSONString(user1);\n        String jsonString2 = JSONObject.toJSONString(user2);\n        System.out.println(\"user1  \" + jsonString1);\n        System.out.println(\"user2  \" + jsonString2);\n    }\n\n}\n\n结果：首字母自动变成小写,自动去掉了值为null的节点(为\"\"的仍然保留)\nuser1  {\"aGE\":18,\"cOMPANYNAME\":\"华为\",\"iD\":1,\"nAME\":\"zhangsan\",\"sEX\":\"Male\"}\nuser2  {\"cOMPANYNAME\":\"小米\",\"iD\":2,\"nAME\":\"Lisi\",\"rEMARK\":\"\",\"sEX\":\"Female\"}\n\n```\n\n## 2. 结论\n\n### 2-1. fastjson\n\n1. 无论对象首字母是大写，或者是小写，转json字符串是都会将首字母自动变成小写。\n2. 默认会将值为null的节点忽略掉\n3. 可通过注解@JSONField，指定对象转json时的key\n\n### 2-2. json-lib\n\n1. 只有在对象属性名全部为大写时，才不会将首字母变为小写，其他情况都会将首字母变成小写\n2. 依然会保留值为null的节点\n\n## 3. 对Date类型的字段格式化的处理\n\n### 3-1. fastjson\n\n默认会将时间转为毫秒值，可使用`JSONObject.toJSONStringWithDateFormat`或者在属性字段上使用`@JSONField(format = \"yyyy-MM-dd HH:mm:ss\")`\n\n```java\nimport com.alibaba.fastjson.JSONObject;\n\nimport java.util.Date;\n\npublic class JSONUtilsTest {\n\n    public static void main(String[] args) {\n        User user1 = new User(1, \"zhangsan\", \"Male\", 18, \"华为\", null, new Date());\n        User user2 = new User(2, \"Lisi\", \"Female\", null, \"小米\", \"\", new Date());\n        String jsonString1 = JSONObject.toJSONStringWithDateFormat(user1, \"yyyy-MM-dd\");\n        String jsonString2 = JSONObject.toJSONString(user2);\n        System.out.println(\"user1  \" + jsonString1);\n        System.out.println(\"user2  \" + jsonString2);\n    }\n\n}\n\n结果：\nuser1  {\"Age\":18,\"CompanyName\":\"华为\",\"Id\":1,\"Name\":\"zhangsan\",\"Sex\":\"Male\",\"birthday\":\"2019-05-21\"}\nuser2  {\"CompanyName\":\"小米\",\"Id\":2,\"Name\":\"Lisi\",\"Remark\":\"\",\"Sex\":\"Female\",\"birthday\":1558398124477}\n```\n\n\n\n### 3-2. json-lib\n\n默认会将Date类型的字段分解, 可通过传入`JsonConfig`并注册`JsonValueProcessor`解决这个问题\n\n```java\nimport net.sf.json.JSONObject;\nimport net.sf.json.JsonConfig;\n\nimport java.util.Date;\n\npublic class JSONUtilsTest {\n\n    public static void main(String[] args) {\n        User user1 = new User(1, \"zhangsan\", \"Male\", 18, \"华为\", null, new Date());\n        User user2 = new User(2, \"Lisi\", \"Female\", null, \"小米\", \"\", new Date());\n        JsonConfig jsonConfig = new JsonConfig();\n        jsonConfig.registerJsonValueProcessor(Date.class, new DateJsonValueProcessor());\n        JSONObject jsonObject1 = JSONObject.fromObject(user1, jsonConfig);\n        JSONObject jsonObject2 = JSONObject.fromObject(user2);\n        System.out.println(\"user1  \" + jsonObject1.toString());\n        System.out.println(\"user2  \" + jsonObject2.toString());\n    }\n\n}\n\nuser1  {\"age\":18,\"birthday\":\"2019-05-21 08:30:53\",\"companyName\":\"华为\",\"id\":1,\"name\":\"zhangsan\",\"remark\":\"\",\"sex\":\"Male\"}\nuser2  {\"age\":0,\"birthday\":{\"date\":21,\"day\":2,\"hours\":8,\"minutes\":30,\"month\":4,\"seconds\":53,\"time\":1558398653824,\"timezoneOffset\":-480,\"year\":119},\"companyName\":\"小米\",\"id\":2,\"name\":\"Lisi\",\"remark\":\"\",\"sex\":\"Female\"}\n\npublic class DateJsonValueProcessor implements JsonValueProcessor {\n\n    private String formatDateTime = \"yyyy-MM-dd HH:mm:ss\";\n\n    private String formatDate = \"yyyy-MM-dd\";\n\n    public DateJsonValueProcessor() {\n\n    }\n\n    public DateJsonValueProcessor(String format) {\n        this.formatDateTime = format;\n    }\n\n    @Override\n    public Object processArrayValue(Object value, JsonConfig jsonConfig) {\n        String[] obj = {};\n        if (value instanceof Date[]) {\n            SimpleDateFormat sf = new SimpleDateFormat(formatDateTime);\n            Date[] dates = (Date[]) value;\n            obj = new String[dates.length];\n            for (int i = 0; i < dates.length; i++) {\n                obj[i] = sf.format(dates[i]);\n            }\n        }\n        return obj;\n    }\n\n    @Override\n    public Object processObjectValue(String key, Object value, JsonConfig jsonConfig) {\n        if (value instanceof Date) {\n            String str = \"\";\n            if (Objects.equals(key, \"checkDate\") || Objects.equals(key, \"validUntil\")) {\n                str = new SimpleDateFormat(formatDate).format((Date) value);\n            } else {\n                str = new SimpleDateFormat(formatDateTime).format((Date) value);\n            }\n            return str;\n        }\n        return value;\n    }\n}\n```\n\n","slug":"使用不同json包对象转Json过程中的大小写问题","published":1,"updated":"2019-05-21T00:34:30.158Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck27dih240008mskp18panrad","content":"<h1 id=\"使用不同工具对象转JsonObject中的大小写问题\"><a href=\"#使用不同工具对象转JsonObject中的大小写问题\" class=\"headerlink\" title=\"使用不同工具对象转JsonObject中的大小写问题\"></a>使用不同工具对象转JsonObject中的大小写问题</h1><p>对象转json字符串时，针对对象属性不同的大小写，常用的两种工具类json-lib和fastjson转换的结果有差异。记录于此，作为今后的参考。</p>\n<a id=\"more\"></a>\n<h2 id=\"1-net-sf-json-lib-与-com-alibaba-fastjson的不同效果\"><a href=\"#1-net-sf-json-lib-与-com-alibaba-fastjson的不同效果\" class=\"headerlink\" title=\"1. net.sf.json-lib 与 com.alibaba.fastjson的不同效果\"></a>1. <code>net.sf.json-lib</code> 与 <code>com.alibaba.fastjson</code>的不同效果</h2><h3 id=\"1-1-导入jar包\"><a href=\"#1-1-导入jar包\" class=\"headerlink\" title=\"1-1. 导入jar包\"></a>1-1. 导入jar包</h3><p>这里同时导入两个json工具包</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>net.sf.json-lib<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>json-lib<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.4<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.alibaba<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>fastjson<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.2.45<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"1-2-对象采用驼峰命名法\"><a href=\"#1-2-对象采用驼峰命名法\" class=\"headerlink\" title=\"1-2. 对象采用驼峰命名法\"></a>1-2. 对象采用驼峰命名法</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@NoArgsConstructor</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer id;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String sex;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer age;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String companyName;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"1-2-1-使用net-sf-json-lib\"><a href=\"#1-2-1-使用net-sf-json-lib\" class=\"headerlink\" title=\"1-2-1. 使用net.sf.json-lib\"></a>1-2-1. 使用<code>net.sf.json-lib</code></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> net.sf.json.JSONObject;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JSONUtilsTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        User user = <span class=\"keyword\">new</span> User(<span class=\"number\">1</span>, <span class=\"string\">\"zhangsan\"</span>, <span class=\"string\">\"Male\"</span>, <span class=\"number\">18</span>, <span class=\"string\">\"华为\"</span>);</span><br><span class=\"line\">        JSONObject jsonObject = JSONObject.fromObject(user);</span><br><span class=\"line\">        System.out.println(jsonObject.toString());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">结果：(与对象名一致，没毛病)</span><br><span class=\"line\">&#123;<span class=\"string\">\"age\"</span>:<span class=\"number\">18</span>,<span class=\"string\">\"companyName\"</span>:<span class=\"string\">\"华为\"</span>,<span class=\"string\">\"id\"</span>:<span class=\"number\">1</span>,<span class=\"string\">\"name\"</span>:<span class=\"string\">\"zhangsan\"</span>,<span class=\"string\">\"sex\"</span>:<span class=\"string\">\"Male\"</span>&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"1-2-2-使用fastjson\"><a href=\"#1-2-2-使用fastjson\" class=\"headerlink\" title=\"1-2-2. 使用fastjson\"></a>1-2-2. 使用fastjson</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JSONUtilsTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        User user = <span class=\"keyword\">new</span> User(<span class=\"number\">1</span>, <span class=\"string\">\"zhangsan\"</span>, <span class=\"string\">\"Male\"</span>, <span class=\"number\">18</span>, <span class=\"string\">\"华为\"</span>);</span><br><span class=\"line\">        String jsonString = JSONObject.toJSONString(user);</span><br><span class=\"line\">        System.out.println(jsonString);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">结果：(与对象名一致，没毛病)</span><br><span class=\"line\">&#123;<span class=\"string\">\"age\"</span>:<span class=\"number\">18</span>,<span class=\"string\">\"companyName\"</span>:<span class=\"string\">\"华为\"</span>,<span class=\"string\">\"id\"</span>:<span class=\"number\">1</span>,<span class=\"string\">\"name\"</span>:<span class=\"string\">\"zhangsan\"</span>,<span class=\"string\">\"sex\"</span>:<span class=\"string\">\"Male\"</span>&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"1-3-对象首字母大写\"><a href=\"#1-3-对象首字母大写\" class=\"headerlink\" title=\"1-3. 对象首字母大写\"></a>1-3. 对象首字母大写</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@NoArgsConstructor</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer Id;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String Name;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String Sex;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer Age;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String CompanyName;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String Remark;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"1-3-1-使用-net-sf-json-lib\"><a href=\"#1-3-1-使用-net-sf-json-lib\" class=\"headerlink\" title=\"1-3-1. 使用`net.sf.json-lib\"></a>1-3-1. 使用`net.sf.json-lib</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> net.sf.json.JSONObject;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JSONUtilsTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        User user1 = <span class=\"keyword\">new</span> User(<span class=\"number\">1</span>, <span class=\"string\">\"zhangsan\"</span>, <span class=\"string\">\"Male\"</span>, <span class=\"number\">18</span>, <span class=\"string\">\"华为\"</span>, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">        User user2 = <span class=\"keyword\">new</span> User(<span class=\"number\">2</span>, <span class=\"string\">\"Lisi\"</span>, <span class=\"string\">\"Female\"</span>, <span class=\"keyword\">null</span>, <span class=\"string\">\"小米\"</span>, <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        JSONObject jsonObject1 = JSONObject.fromObject(user1);</span><br><span class=\"line\">        JSONObject jsonObject2 = JSONObject.fromObject(user2);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user1  \"</span> + jsonObject1.toString());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user2  \"</span> + jsonObject2.toString());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">结果: 首字母变成小写,保留了值为<span class=\"keyword\">null</span>的节点（<span class=\"number\">0</span>和<span class=\"string\">\"\"</span>）</span><br><span class=\"line\">user1  &#123;<span class=\"string\">\"age\"</span>:<span class=\"number\">18</span>,<span class=\"string\">\"companyName\"</span>:<span class=\"string\">\"华为\"</span>,<span class=\"string\">\"id\"</span>:<span class=\"number\">1</span>,<span class=\"string\">\"name\"</span>:<span class=\"string\">\"zhangsan\"</span>,<span class=\"string\">\"remark\"</span>:<span class=\"string\">\"\"</span>,<span class=\"string\">\"sex\"</span>:<span class=\"string\">\"Male\"</span>&#125;</span><br><span class=\"line\">user2  &#123;<span class=\"string\">\"age\"</span>:<span class=\"number\">0</span>,<span class=\"string\">\"companyName\"</span>:<span class=\"string\">\"小米\"</span>,<span class=\"string\">\"id\"</span>:<span class=\"number\">2</span>,<span class=\"string\">\"name\"</span>:<span class=\"string\">\"Lisi\"</span>,<span class=\"string\">\"remark\"</span>:<span class=\"string\">\"\"</span>,<span class=\"string\">\"sex\"</span>:<span class=\"string\">\"Female\"</span>&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"1-3-2-使用fastjson\"><a href=\"#1-3-2-使用fastjson\" class=\"headerlink\" title=\"1-3-2. 使用fastjson\"></a>1-3-2. 使用fastjson</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JSONUtilsTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        User user1 = <span class=\"keyword\">new</span> User(<span class=\"number\">1</span>, <span class=\"string\">\"zhangsan\"</span>, <span class=\"string\">\"Male\"</span>, <span class=\"number\">18</span>, <span class=\"string\">\"华为\"</span>, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">        User user2 = <span class=\"keyword\">new</span> User(<span class=\"number\">2</span>, <span class=\"string\">\"Lisi\"</span>, <span class=\"string\">\"Female\"</span>, <span class=\"keyword\">null</span>, <span class=\"string\">\"小米\"</span>, <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        String jsonString1 = JSONObject.toJSONString(user1);</span><br><span class=\"line\">        String jsonString2 = JSONObject.toJSONString(user2);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user1  \"</span> + jsonString1);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user2  \"</span> + jsonString2);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">结果：首字母自动变成小写,自动去掉了值为<span class=\"keyword\">null</span>的节点(为<span class=\"string\">\"\"</span>的仍然保留)</span><br><span class=\"line\">user1  &#123;<span class=\"string\">\"age\"</span>:<span class=\"number\">18</span>,<span class=\"string\">\"companyName\"</span>:<span class=\"string\">\"华为\"</span>,<span class=\"string\">\"id\"</span>:<span class=\"number\">1</span>,<span class=\"string\">\"name\"</span>:<span class=\"string\">\"zhangsan\"</span>,<span class=\"string\">\"sex\"</span>:<span class=\"string\">\"Male\"</span>&#125;</span><br><span class=\"line\">user2  &#123;<span class=\"string\">\"companyName\"</span>:<span class=\"string\">\"小米\"</span>,<span class=\"string\">\"id\"</span>:<span class=\"number\">2</span>,<span class=\"string\">\"name\"</span>:<span class=\"string\">\"Lisi\"</span>,<span class=\"string\">\"remark\"</span>:<span class=\"string\">\"\"</span>,<span class=\"string\">\"sex\"</span>:<span class=\"string\">\"Female\"</span>&#125;</span><br></pre></td></tr></table></figure>\n<p>如果需要一定按指定的字段名，可使用@JSONField</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@NoArgsConstructor</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@JSONField</span>(name = <span class=\"string\">\"Id\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer Id;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@JSONField</span>(name = <span class=\"string\">\"Name\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String Name;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@JSONField</span>(name = <span class=\"string\">\"Sex\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String Sex;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@JSONField</span>(name = <span class=\"string\">\"Age\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer Age;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@JSONField</span>(name = <span class=\"string\">\"CompanyName\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String CompanyName;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@JSONField</span>(name = <span class=\"string\">\"Remark\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String Remark;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JSONUtilsTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        User user1 = <span class=\"keyword\">new</span> User(<span class=\"number\">1</span>, <span class=\"string\">\"zhangsan\"</span>, <span class=\"string\">\"Male\"</span>, <span class=\"number\">18</span>, <span class=\"string\">\"华为\"</span>, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">        User user2 = <span class=\"keyword\">new</span> User(<span class=\"number\">2</span>, <span class=\"string\">\"Lisi\"</span>, <span class=\"string\">\"Female\"</span>, <span class=\"keyword\">null</span>, <span class=\"string\">\"小米\"</span>, <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        String jsonString1 = JSONObject.toJSONString(user1);</span><br><span class=\"line\">        String jsonString2 = JSONObject.toJSONString(user2);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user1  \"</span> + jsonString1);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user2  \"</span> + jsonString2);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">结果: 按JSONField指定的name转json，自动去掉了值为<span class=\"keyword\">null</span>的节点(为<span class=\"string\">\"\"</span>的仍然保留)</span><br><span class=\"line\">user1  &#123;<span class=\"string\">\"Age\"</span>:<span class=\"number\">18</span>,<span class=\"string\">\"CompanyName\"</span>:<span class=\"string\">\"华为\"</span>,<span class=\"string\">\"Id\"</span>:<span class=\"number\">1</span>,<span class=\"string\">\"Name\"</span>:<span class=\"string\">\"zhangsan\"</span>,<span class=\"string\">\"Sex\"</span>:<span class=\"string\">\"Male\"</span>&#125;</span><br><span class=\"line\">user2  &#123;<span class=\"string\">\"CompanyName\"</span>:<span class=\"string\">\"小米\"</span>,<span class=\"string\">\"Id\"</span>:<span class=\"number\">2</span>,<span class=\"string\">\"Name\"</span>:<span class=\"string\">\"Lisi\"</span>,<span class=\"string\">\"Remark\"</span>:<span class=\"string\">\"\"</span>,<span class=\"string\">\"Sex\"</span>:<span class=\"string\">\"Female\"</span>&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"1-4-对象属性全部大写\"><a href=\"#1-4-对象属性全部大写\" class=\"headerlink\" title=\"1-4. 对象属性全部大写\"></a>1-4. 对象属性全部大写</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@NoArgsConstructor</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer ID;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String NAME;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String SEX;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer AGE;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String COMPANYNAME;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String REMARK;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"1-4-1-使用-net-sf-json-lib\"><a href=\"#1-4-1-使用-net-sf-json-lib\" class=\"headerlink\" title=\"1-4-1. 使用`net.sf.json-lib\"></a>1-4-1. 使用`net.sf.json-lib</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> net.sf.json.JSONObject;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JSONUtilsTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        User user1 = <span class=\"keyword\">new</span> User(<span class=\"number\">1</span>, <span class=\"string\">\"zhangsan\"</span>, <span class=\"string\">\"Male\"</span>, <span class=\"number\">18</span>, <span class=\"string\">\"华为\"</span>, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">        User user2 = <span class=\"keyword\">new</span> User(<span class=\"number\">2</span>, <span class=\"string\">\"Lisi\"</span>, <span class=\"string\">\"Female\"</span>, <span class=\"keyword\">null</span>, <span class=\"string\">\"小米\"</span>, <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        JSONObject jsonObject1 = JSONObject.fromObject(user1);</span><br><span class=\"line\">        JSONObject jsonObject2 = JSONObject.fromObject(user2);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user1  \"</span> + jsonObject1.toString());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user2  \"</span> + jsonObject2.toString());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">结果：首字母没有自动变成小写,保留了值为<span class=\"keyword\">null</span>的节点（<span class=\"number\">0</span>和<span class=\"string\">\"\"</span>）</span><br><span class=\"line\">user1  &#123;<span class=\"string\">\"AGE\"</span>:<span class=\"number\">18</span>,<span class=\"string\">\"COMPANYNAME\"</span>:<span class=\"string\">\"华为\"</span>,<span class=\"string\">\"ID\"</span>:<span class=\"number\">1</span>,<span class=\"string\">\"NAME\"</span>:<span class=\"string\">\"zhangsan\"</span>,<span class=\"string\">\"REMARK\"</span>:<span class=\"string\">\"\"</span>,<span class=\"string\">\"SEX\"</span>:<span class=\"string\">\"Male\"</span>&#125;</span><br><span class=\"line\">user2  &#123;<span class=\"string\">\"AGE\"</span>:<span class=\"number\">0</span>,<span class=\"string\">\"COMPANYNAME\"</span>:<span class=\"string\">\"小米\"</span>,<span class=\"string\">\"ID\"</span>:<span class=\"number\">2</span>,<span class=\"string\">\"NAME\"</span>:<span class=\"string\">\"Lisi\"</span>,<span class=\"string\">\"REMARK\"</span>:<span class=\"string\">\"\"</span>,<span class=\"string\">\"SEX\"</span>:<span class=\"string\">\"Female\"</span>&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"1-4-2-使用fastjson\"><a href=\"#1-4-2-使用fastjson\" class=\"headerlink\" title=\"1-4-2. 使用fastjson\"></a>1-4-2. 使用fastjson</h4><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import com.alibaba.fastjson.JSONObject;</span><br><span class=\"line\"></span><br><span class=\"line\">public class JSONUtilsTest &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        User user1 = new User(1, \"zhangsan\", \"Male\", 18, \"华为\", null);</span><br><span class=\"line\">        User user2 = new User(2, \"Lisi\", \"Female\", null, \"小米\", \"\");</span><br><span class=\"line\">        String jsonString1 = JSONObject.toJSONString(user1);</span><br><span class=\"line\">        String jsonString2 = JSONObject.toJSONString(user2);</span><br><span class=\"line\">        System.out.println(\"user1  \" + jsonString1);</span><br><span class=\"line\">        System.out.println(\"user2  \" + jsonString2);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">结果：首字母自动变成小写,自动去掉了值为null的节点(为\"\"的仍然保留)</span><br><span class=\"line\">user1  &#123;\"aGE\":18,\"cOMPANYNAME\":\"华为\",\"iD\":1,\"nAME\":\"zhangsan\",\"sEX\":\"Male\"&#125;</span><br><span class=\"line\">user2  &#123;\"cOMPANYNAME\":\"小米\",\"iD\":2,\"nAME\":\"Lisi\",\"rEMARK\":\"\",\"sEX\":\"Female\"&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-结论\"><a href=\"#2-结论\" class=\"headerlink\" title=\"2. 结论\"></a>2. 结论</h2><h3 id=\"2-1-fastjson\"><a href=\"#2-1-fastjson\" class=\"headerlink\" title=\"2-1. fastjson\"></a>2-1. fastjson</h3><ol>\n<li>无论对象首字母是大写，或者是小写，转json字符串是都会将首字母自动变成小写。</li>\n<li>默认会将值为null的节点忽略掉</li>\n<li>可通过注解@JSONField，指定对象转json时的key</li>\n</ol>\n<h3 id=\"2-2-json-lib\"><a href=\"#2-2-json-lib\" class=\"headerlink\" title=\"2-2. json-lib\"></a>2-2. json-lib</h3><ol>\n<li>只有在对象属性名全部为大写时，才不会将首字母变为小写，其他情况都会将首字母变成小写</li>\n<li>依然会保留值为null的节点</li>\n</ol>\n<h2 id=\"3-对Date类型的字段格式化的处理\"><a href=\"#3-对Date类型的字段格式化的处理\" class=\"headerlink\" title=\"3. 对Date类型的字段格式化的处理\"></a>3. 对Date类型的字段格式化的处理</h2><h3 id=\"3-1-fastjson\"><a href=\"#3-1-fastjson\" class=\"headerlink\" title=\"3-1. fastjson\"></a>3-1. fastjson</h3><p>默认会将时间转为毫秒值，可使用<code>JSONObject.toJSONStringWithDateFormat</code>或者在属性字段上使用<code>@JSONField(format = &quot;yyyy-MM-dd HH:mm:ss&quot;)</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Date;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JSONUtilsTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        User user1 = <span class=\"keyword\">new</span> User(<span class=\"number\">1</span>, <span class=\"string\">\"zhangsan\"</span>, <span class=\"string\">\"Male\"</span>, <span class=\"number\">18</span>, <span class=\"string\">\"华为\"</span>, <span class=\"keyword\">null</span>, <span class=\"keyword\">new</span> Date());</span><br><span class=\"line\">        User user2 = <span class=\"keyword\">new</span> User(<span class=\"number\">2</span>, <span class=\"string\">\"Lisi\"</span>, <span class=\"string\">\"Female\"</span>, <span class=\"keyword\">null</span>, <span class=\"string\">\"小米\"</span>, <span class=\"string\">\"\"</span>, <span class=\"keyword\">new</span> Date());</span><br><span class=\"line\">        String jsonString1 = JSONObject.toJSONStringWithDateFormat(user1, <span class=\"string\">\"yyyy-MM-dd\"</span>);</span><br><span class=\"line\">        String jsonString2 = JSONObject.toJSONString(user2);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user1  \"</span> + jsonString1);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user2  \"</span> + jsonString2);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">结果：</span><br><span class=\"line\">user1  &#123;<span class=\"string\">\"Age\"</span>:<span class=\"number\">18</span>,<span class=\"string\">\"CompanyName\"</span>:<span class=\"string\">\"华为\"</span>,<span class=\"string\">\"Id\"</span>:<span class=\"number\">1</span>,<span class=\"string\">\"Name\"</span>:<span class=\"string\">\"zhangsan\"</span>,<span class=\"string\">\"Sex\"</span>:<span class=\"string\">\"Male\"</span>,<span class=\"string\">\"birthday\"</span>:<span class=\"string\">\"2019-05-21\"</span>&#125;</span><br><span class=\"line\">user2  &#123;<span class=\"string\">\"CompanyName\"</span>:<span class=\"string\">\"小米\"</span>,<span class=\"string\">\"Id\"</span>:<span class=\"number\">2</span>,<span class=\"string\">\"Name\"</span>:<span class=\"string\">\"Lisi\"</span>,<span class=\"string\">\"Remark\"</span>:<span class=\"string\">\"\"</span>,<span class=\"string\">\"Sex\"</span>:<span class=\"string\">\"Female\"</span>,<span class=\"string\">\"birthday\"</span>:<span class=\"number\">1558398124477</span>&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-2-json-lib\"><a href=\"#3-2-json-lib\" class=\"headerlink\" title=\"3-2. json-lib\"></a>3-2. json-lib</h3><p>默认会将Date类型的字段分解, 可通过传入<code>JsonConfig</code>并注册<code>JsonValueProcessor</code>解决这个问题</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> net.sf.json.JSONObject;</span><br><span class=\"line\"><span class=\"keyword\">import</span> net.sf.json.JsonConfig;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Date;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JSONUtilsTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        User user1 = <span class=\"keyword\">new</span> User(<span class=\"number\">1</span>, <span class=\"string\">\"zhangsan\"</span>, <span class=\"string\">\"Male\"</span>, <span class=\"number\">18</span>, <span class=\"string\">\"华为\"</span>, <span class=\"keyword\">null</span>, <span class=\"keyword\">new</span> Date());</span><br><span class=\"line\">        User user2 = <span class=\"keyword\">new</span> User(<span class=\"number\">2</span>, <span class=\"string\">\"Lisi\"</span>, <span class=\"string\">\"Female\"</span>, <span class=\"keyword\">null</span>, <span class=\"string\">\"小米\"</span>, <span class=\"string\">\"\"</span>, <span class=\"keyword\">new</span> Date());</span><br><span class=\"line\">        JsonConfig jsonConfig = <span class=\"keyword\">new</span> JsonConfig();</span><br><span class=\"line\">        jsonConfig.registerJsonValueProcessor(Date.class, <span class=\"keyword\">new</span> DateJsonValueProcessor());</span><br><span class=\"line\">        JSONObject jsonObject1 = JSONObject.fromObject(user1, jsonConfig);</span><br><span class=\"line\">        JSONObject jsonObject2 = JSONObject.fromObject(user2);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user1  \"</span> + jsonObject1.toString());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user2  \"</span> + jsonObject2.toString());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">user1  &#123;<span class=\"string\">\"age\"</span>:<span class=\"number\">18</span>,<span class=\"string\">\"birthday\"</span>:<span class=\"string\">\"2019-05-21 08:30:53\"</span>,<span class=\"string\">\"companyName\"</span>:<span class=\"string\">\"华为\"</span>,<span class=\"string\">\"id\"</span>:<span class=\"number\">1</span>,<span class=\"string\">\"name\"</span>:<span class=\"string\">\"zhangsan\"</span>,<span class=\"string\">\"remark\"</span>:<span class=\"string\">\"\"</span>,<span class=\"string\">\"sex\"</span>:<span class=\"string\">\"Male\"</span>&#125;</span><br><span class=\"line\">user2  &#123;<span class=\"string\">\"age\"</span>:<span class=\"number\">0</span>,<span class=\"string\">\"birthday\"</span>:&#123;<span class=\"string\">\"date\"</span>:<span class=\"number\">21</span>,<span class=\"string\">\"day\"</span>:<span class=\"number\">2</span>,<span class=\"string\">\"hours\"</span>:<span class=\"number\">8</span>,<span class=\"string\">\"minutes\"</span>:<span class=\"number\">30</span>,<span class=\"string\">\"month\"</span>:<span class=\"number\">4</span>,<span class=\"string\">\"seconds\"</span>:<span class=\"number\">53</span>,<span class=\"string\">\"time\"</span>:<span class=\"number\">1558398653824</span>,<span class=\"string\">\"timezoneOffset\"</span>:-<span class=\"number\">480</span>,<span class=\"string\">\"year\"</span>:<span class=\"number\">119</span>&#125;,<span class=\"string\">\"companyName\"</span>:<span class=\"string\">\"小米\"</span>,<span class=\"string\">\"id\"</span>:<span class=\"number\">2</span>,<span class=\"string\">\"name\"</span>:<span class=\"string\">\"Lisi\"</span>,<span class=\"string\">\"remark\"</span>:<span class=\"string\">\"\"</span>,<span class=\"string\">\"sex\"</span>:<span class=\"string\">\"Female\"</span>&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DateJsonValueProcessor</span> <span class=\"keyword\">implements</span> <span class=\"title\">JsonValueProcessor</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String formatDateTime = <span class=\"string\">\"yyyy-MM-dd HH:mm:ss\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String formatDate = <span class=\"string\">\"yyyy-MM-dd\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">DateJsonValueProcessor</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">DateJsonValueProcessor</span><span class=\"params\">(String format)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.formatDateTime = format;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">processArrayValue</span><span class=\"params\">(Object value, JsonConfig jsonConfig)</span> </span>&#123;</span><br><span class=\"line\">        String[] obj = &#123;&#125;;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (value <span class=\"keyword\">instanceof</span> Date[]) &#123;</span><br><span class=\"line\">            SimpleDateFormat sf = <span class=\"keyword\">new</span> SimpleDateFormat(formatDateTime);</span><br><span class=\"line\">            Date[] dates = (Date[]) value;</span><br><span class=\"line\">            obj = <span class=\"keyword\">new</span> String[dates.length];</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; dates.length; i++) &#123;</span><br><span class=\"line\">                obj[i] = sf.format(dates[i]);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> obj;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">processObjectValue</span><span class=\"params\">(String key, Object value, JsonConfig jsonConfig)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (value <span class=\"keyword\">instanceof</span> Date) &#123;</span><br><span class=\"line\">            String str = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (Objects.equals(key, <span class=\"string\">\"checkDate\"</span>) || Objects.equals(key, <span class=\"string\">\"validUntil\"</span>)) &#123;</span><br><span class=\"line\">                str = <span class=\"keyword\">new</span> SimpleDateFormat(formatDate).format((Date) value);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                str = <span class=\"keyword\">new</span> SimpleDateFormat(formatDateTime).format((Date) value);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> str;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"length":9803,"excerpt":"<h1 id=\"使用不同工具对象转JsonObject中的大小写问题\"><a href=\"#使用不同工具对象转JsonObject中的大小写问题\" class=\"headerlink\" title=\"使用不同工具对象转JsonObject中的大小写问题\"></a>使用不同工具对象转JsonObject中的大小写问题</h1><p>对象转json字符串时，针对对象属性不同的大小写，常用的两种工具类json-lib和fastjson转换的结果有差异。记录于此，作为今后的参考。</p>","more":"<h2 id=\"1-net-sf-json-lib-与-com-alibaba-fastjson的不同效果\"><a href=\"#1-net-sf-json-lib-与-com-alibaba-fastjson的不同效果\" class=\"headerlink\" title=\"1. net.sf.json-lib 与 com.alibaba.fastjson的不同效果\"></a>1. <code>net.sf.json-lib</code> 与 <code>com.alibaba.fastjson</code>的不同效果</h2><h3 id=\"1-1-导入jar包\"><a href=\"#1-1-导入jar包\" class=\"headerlink\" title=\"1-1. 导入jar包\"></a>1-1. 导入jar包</h3><p>这里同时导入两个json工具包</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>net.sf.json-lib<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>json-lib<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.4<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.alibaba<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>fastjson<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.2.45<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"1-2-对象采用驼峰命名法\"><a href=\"#1-2-对象采用驼峰命名法\" class=\"headerlink\" title=\"1-2. 对象采用驼峰命名法\"></a>1-2. 对象采用驼峰命名法</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@NoArgsConstructor</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer id;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String sex;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer age;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String companyName;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"1-2-1-使用net-sf-json-lib\"><a href=\"#1-2-1-使用net-sf-json-lib\" class=\"headerlink\" title=\"1-2-1. 使用net.sf.json-lib\"></a>1-2-1. 使用<code>net.sf.json-lib</code></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> net.sf.json.JSONObject;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JSONUtilsTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        User user = <span class=\"keyword\">new</span> User(<span class=\"number\">1</span>, <span class=\"string\">\"zhangsan\"</span>, <span class=\"string\">\"Male\"</span>, <span class=\"number\">18</span>, <span class=\"string\">\"华为\"</span>);</span><br><span class=\"line\">        JSONObject jsonObject = JSONObject.fromObject(user);</span><br><span class=\"line\">        System.out.println(jsonObject.toString());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">结果：(与对象名一致，没毛病)</span><br><span class=\"line\">&#123;<span class=\"string\">\"age\"</span>:<span class=\"number\">18</span>,<span class=\"string\">\"companyName\"</span>:<span class=\"string\">\"华为\"</span>,<span class=\"string\">\"id\"</span>:<span class=\"number\">1</span>,<span class=\"string\">\"name\"</span>:<span class=\"string\">\"zhangsan\"</span>,<span class=\"string\">\"sex\"</span>:<span class=\"string\">\"Male\"</span>&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"1-2-2-使用fastjson\"><a href=\"#1-2-2-使用fastjson\" class=\"headerlink\" title=\"1-2-2. 使用fastjson\"></a>1-2-2. 使用fastjson</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JSONUtilsTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        User user = <span class=\"keyword\">new</span> User(<span class=\"number\">1</span>, <span class=\"string\">\"zhangsan\"</span>, <span class=\"string\">\"Male\"</span>, <span class=\"number\">18</span>, <span class=\"string\">\"华为\"</span>);</span><br><span class=\"line\">        String jsonString = JSONObject.toJSONString(user);</span><br><span class=\"line\">        System.out.println(jsonString);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">结果：(与对象名一致，没毛病)</span><br><span class=\"line\">&#123;<span class=\"string\">\"age\"</span>:<span class=\"number\">18</span>,<span class=\"string\">\"companyName\"</span>:<span class=\"string\">\"华为\"</span>,<span class=\"string\">\"id\"</span>:<span class=\"number\">1</span>,<span class=\"string\">\"name\"</span>:<span class=\"string\">\"zhangsan\"</span>,<span class=\"string\">\"sex\"</span>:<span class=\"string\">\"Male\"</span>&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"1-3-对象首字母大写\"><a href=\"#1-3-对象首字母大写\" class=\"headerlink\" title=\"1-3. 对象首字母大写\"></a>1-3. 对象首字母大写</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@NoArgsConstructor</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer Id;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String Name;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String Sex;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer Age;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String CompanyName;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String Remark;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"1-3-1-使用-net-sf-json-lib\"><a href=\"#1-3-1-使用-net-sf-json-lib\" class=\"headerlink\" title=\"1-3-1. 使用`net.sf.json-lib\"></a>1-3-1. 使用`net.sf.json-lib</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> net.sf.json.JSONObject;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JSONUtilsTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        User user1 = <span class=\"keyword\">new</span> User(<span class=\"number\">1</span>, <span class=\"string\">\"zhangsan\"</span>, <span class=\"string\">\"Male\"</span>, <span class=\"number\">18</span>, <span class=\"string\">\"华为\"</span>, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">        User user2 = <span class=\"keyword\">new</span> User(<span class=\"number\">2</span>, <span class=\"string\">\"Lisi\"</span>, <span class=\"string\">\"Female\"</span>, <span class=\"keyword\">null</span>, <span class=\"string\">\"小米\"</span>, <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        JSONObject jsonObject1 = JSONObject.fromObject(user1);</span><br><span class=\"line\">        JSONObject jsonObject2 = JSONObject.fromObject(user2);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user1  \"</span> + jsonObject1.toString());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user2  \"</span> + jsonObject2.toString());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">结果: 首字母变成小写,保留了值为<span class=\"keyword\">null</span>的节点（<span class=\"number\">0</span>和<span class=\"string\">\"\"</span>）</span><br><span class=\"line\">user1  &#123;<span class=\"string\">\"age\"</span>:<span class=\"number\">18</span>,<span class=\"string\">\"companyName\"</span>:<span class=\"string\">\"华为\"</span>,<span class=\"string\">\"id\"</span>:<span class=\"number\">1</span>,<span class=\"string\">\"name\"</span>:<span class=\"string\">\"zhangsan\"</span>,<span class=\"string\">\"remark\"</span>:<span class=\"string\">\"\"</span>,<span class=\"string\">\"sex\"</span>:<span class=\"string\">\"Male\"</span>&#125;</span><br><span class=\"line\">user2  &#123;<span class=\"string\">\"age\"</span>:<span class=\"number\">0</span>,<span class=\"string\">\"companyName\"</span>:<span class=\"string\">\"小米\"</span>,<span class=\"string\">\"id\"</span>:<span class=\"number\">2</span>,<span class=\"string\">\"name\"</span>:<span class=\"string\">\"Lisi\"</span>,<span class=\"string\">\"remark\"</span>:<span class=\"string\">\"\"</span>,<span class=\"string\">\"sex\"</span>:<span class=\"string\">\"Female\"</span>&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"1-3-2-使用fastjson\"><a href=\"#1-3-2-使用fastjson\" class=\"headerlink\" title=\"1-3-2. 使用fastjson\"></a>1-3-2. 使用fastjson</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JSONUtilsTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        User user1 = <span class=\"keyword\">new</span> User(<span class=\"number\">1</span>, <span class=\"string\">\"zhangsan\"</span>, <span class=\"string\">\"Male\"</span>, <span class=\"number\">18</span>, <span class=\"string\">\"华为\"</span>, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">        User user2 = <span class=\"keyword\">new</span> User(<span class=\"number\">2</span>, <span class=\"string\">\"Lisi\"</span>, <span class=\"string\">\"Female\"</span>, <span class=\"keyword\">null</span>, <span class=\"string\">\"小米\"</span>, <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        String jsonString1 = JSONObject.toJSONString(user1);</span><br><span class=\"line\">        String jsonString2 = JSONObject.toJSONString(user2);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user1  \"</span> + jsonString1);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user2  \"</span> + jsonString2);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">结果：首字母自动变成小写,自动去掉了值为<span class=\"keyword\">null</span>的节点(为<span class=\"string\">\"\"</span>的仍然保留)</span><br><span class=\"line\">user1  &#123;<span class=\"string\">\"age\"</span>:<span class=\"number\">18</span>,<span class=\"string\">\"companyName\"</span>:<span class=\"string\">\"华为\"</span>,<span class=\"string\">\"id\"</span>:<span class=\"number\">1</span>,<span class=\"string\">\"name\"</span>:<span class=\"string\">\"zhangsan\"</span>,<span class=\"string\">\"sex\"</span>:<span class=\"string\">\"Male\"</span>&#125;</span><br><span class=\"line\">user2  &#123;<span class=\"string\">\"companyName\"</span>:<span class=\"string\">\"小米\"</span>,<span class=\"string\">\"id\"</span>:<span class=\"number\">2</span>,<span class=\"string\">\"name\"</span>:<span class=\"string\">\"Lisi\"</span>,<span class=\"string\">\"remark\"</span>:<span class=\"string\">\"\"</span>,<span class=\"string\">\"sex\"</span>:<span class=\"string\">\"Female\"</span>&#125;</span><br></pre></td></tr></table></figure>\n<p>如果需要一定按指定的字段名，可使用@JSONField</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@NoArgsConstructor</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@JSONField</span>(name = <span class=\"string\">\"Id\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer Id;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@JSONField</span>(name = <span class=\"string\">\"Name\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String Name;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@JSONField</span>(name = <span class=\"string\">\"Sex\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String Sex;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@JSONField</span>(name = <span class=\"string\">\"Age\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer Age;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@JSONField</span>(name = <span class=\"string\">\"CompanyName\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String CompanyName;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@JSONField</span>(name = <span class=\"string\">\"Remark\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String Remark;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JSONUtilsTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        User user1 = <span class=\"keyword\">new</span> User(<span class=\"number\">1</span>, <span class=\"string\">\"zhangsan\"</span>, <span class=\"string\">\"Male\"</span>, <span class=\"number\">18</span>, <span class=\"string\">\"华为\"</span>, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">        User user2 = <span class=\"keyword\">new</span> User(<span class=\"number\">2</span>, <span class=\"string\">\"Lisi\"</span>, <span class=\"string\">\"Female\"</span>, <span class=\"keyword\">null</span>, <span class=\"string\">\"小米\"</span>, <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        String jsonString1 = JSONObject.toJSONString(user1);</span><br><span class=\"line\">        String jsonString2 = JSONObject.toJSONString(user2);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user1  \"</span> + jsonString1);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user2  \"</span> + jsonString2);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">结果: 按JSONField指定的name转json，自动去掉了值为<span class=\"keyword\">null</span>的节点(为<span class=\"string\">\"\"</span>的仍然保留)</span><br><span class=\"line\">user1  &#123;<span class=\"string\">\"Age\"</span>:<span class=\"number\">18</span>,<span class=\"string\">\"CompanyName\"</span>:<span class=\"string\">\"华为\"</span>,<span class=\"string\">\"Id\"</span>:<span class=\"number\">1</span>,<span class=\"string\">\"Name\"</span>:<span class=\"string\">\"zhangsan\"</span>,<span class=\"string\">\"Sex\"</span>:<span class=\"string\">\"Male\"</span>&#125;</span><br><span class=\"line\">user2  &#123;<span class=\"string\">\"CompanyName\"</span>:<span class=\"string\">\"小米\"</span>,<span class=\"string\">\"Id\"</span>:<span class=\"number\">2</span>,<span class=\"string\">\"Name\"</span>:<span class=\"string\">\"Lisi\"</span>,<span class=\"string\">\"Remark\"</span>:<span class=\"string\">\"\"</span>,<span class=\"string\">\"Sex\"</span>:<span class=\"string\">\"Female\"</span>&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"1-4-对象属性全部大写\"><a href=\"#1-4-对象属性全部大写\" class=\"headerlink\" title=\"1-4. 对象属性全部大写\"></a>1-4. 对象属性全部大写</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@NoArgsConstructor</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer ID;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String NAME;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String SEX;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer AGE;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String COMPANYNAME;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String REMARK;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"1-4-1-使用-net-sf-json-lib\"><a href=\"#1-4-1-使用-net-sf-json-lib\" class=\"headerlink\" title=\"1-4-1. 使用`net.sf.json-lib\"></a>1-4-1. 使用`net.sf.json-lib</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> net.sf.json.JSONObject;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JSONUtilsTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        User user1 = <span class=\"keyword\">new</span> User(<span class=\"number\">1</span>, <span class=\"string\">\"zhangsan\"</span>, <span class=\"string\">\"Male\"</span>, <span class=\"number\">18</span>, <span class=\"string\">\"华为\"</span>, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">        User user2 = <span class=\"keyword\">new</span> User(<span class=\"number\">2</span>, <span class=\"string\">\"Lisi\"</span>, <span class=\"string\">\"Female\"</span>, <span class=\"keyword\">null</span>, <span class=\"string\">\"小米\"</span>, <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        JSONObject jsonObject1 = JSONObject.fromObject(user1);</span><br><span class=\"line\">        JSONObject jsonObject2 = JSONObject.fromObject(user2);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user1  \"</span> + jsonObject1.toString());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user2  \"</span> + jsonObject2.toString());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">结果：首字母没有自动变成小写,保留了值为<span class=\"keyword\">null</span>的节点（<span class=\"number\">0</span>和<span class=\"string\">\"\"</span>）</span><br><span class=\"line\">user1  &#123;<span class=\"string\">\"AGE\"</span>:<span class=\"number\">18</span>,<span class=\"string\">\"COMPANYNAME\"</span>:<span class=\"string\">\"华为\"</span>,<span class=\"string\">\"ID\"</span>:<span class=\"number\">1</span>,<span class=\"string\">\"NAME\"</span>:<span class=\"string\">\"zhangsan\"</span>,<span class=\"string\">\"REMARK\"</span>:<span class=\"string\">\"\"</span>,<span class=\"string\">\"SEX\"</span>:<span class=\"string\">\"Male\"</span>&#125;</span><br><span class=\"line\">user2  &#123;<span class=\"string\">\"AGE\"</span>:<span class=\"number\">0</span>,<span class=\"string\">\"COMPANYNAME\"</span>:<span class=\"string\">\"小米\"</span>,<span class=\"string\">\"ID\"</span>:<span class=\"number\">2</span>,<span class=\"string\">\"NAME\"</span>:<span class=\"string\">\"Lisi\"</span>,<span class=\"string\">\"REMARK\"</span>:<span class=\"string\">\"\"</span>,<span class=\"string\">\"SEX\"</span>:<span class=\"string\">\"Female\"</span>&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"1-4-2-使用fastjson\"><a href=\"#1-4-2-使用fastjson\" class=\"headerlink\" title=\"1-4-2. 使用fastjson\"></a>1-4-2. 使用fastjson</h4><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import com.alibaba.fastjson.JSONObject;</span><br><span class=\"line\"></span><br><span class=\"line\">public class JSONUtilsTest &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        User user1 = new User(1, \"zhangsan\", \"Male\", 18, \"华为\", null);</span><br><span class=\"line\">        User user2 = new User(2, \"Lisi\", \"Female\", null, \"小米\", \"\");</span><br><span class=\"line\">        String jsonString1 = JSONObject.toJSONString(user1);</span><br><span class=\"line\">        String jsonString2 = JSONObject.toJSONString(user2);</span><br><span class=\"line\">        System.out.println(\"user1  \" + jsonString1);</span><br><span class=\"line\">        System.out.println(\"user2  \" + jsonString2);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">结果：首字母自动变成小写,自动去掉了值为null的节点(为\"\"的仍然保留)</span><br><span class=\"line\">user1  &#123;\"aGE\":18,\"cOMPANYNAME\":\"华为\",\"iD\":1,\"nAME\":\"zhangsan\",\"sEX\":\"Male\"&#125;</span><br><span class=\"line\">user2  &#123;\"cOMPANYNAME\":\"小米\",\"iD\":2,\"nAME\":\"Lisi\",\"rEMARK\":\"\",\"sEX\":\"Female\"&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-结论\"><a href=\"#2-结论\" class=\"headerlink\" title=\"2. 结论\"></a>2. 结论</h2><h3 id=\"2-1-fastjson\"><a href=\"#2-1-fastjson\" class=\"headerlink\" title=\"2-1. fastjson\"></a>2-1. fastjson</h3><ol>\n<li>无论对象首字母是大写，或者是小写，转json字符串是都会将首字母自动变成小写。</li>\n<li>默认会将值为null的节点忽略掉</li>\n<li>可通过注解@JSONField，指定对象转json时的key</li>\n</ol>\n<h3 id=\"2-2-json-lib\"><a href=\"#2-2-json-lib\" class=\"headerlink\" title=\"2-2. json-lib\"></a>2-2. json-lib</h3><ol>\n<li>只有在对象属性名全部为大写时，才不会将首字母变为小写，其他情况都会将首字母变成小写</li>\n<li>依然会保留值为null的节点</li>\n</ol>\n<h2 id=\"3-对Date类型的字段格式化的处理\"><a href=\"#3-对Date类型的字段格式化的处理\" class=\"headerlink\" title=\"3. 对Date类型的字段格式化的处理\"></a>3. 对Date类型的字段格式化的处理</h2><h3 id=\"3-1-fastjson\"><a href=\"#3-1-fastjson\" class=\"headerlink\" title=\"3-1. fastjson\"></a>3-1. fastjson</h3><p>默认会将时间转为毫秒值，可使用<code>JSONObject.toJSONStringWithDateFormat</code>或者在属性字段上使用<code>@JSONField(format = &quot;yyyy-MM-dd HH:mm:ss&quot;)</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Date;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JSONUtilsTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        User user1 = <span class=\"keyword\">new</span> User(<span class=\"number\">1</span>, <span class=\"string\">\"zhangsan\"</span>, <span class=\"string\">\"Male\"</span>, <span class=\"number\">18</span>, <span class=\"string\">\"华为\"</span>, <span class=\"keyword\">null</span>, <span class=\"keyword\">new</span> Date());</span><br><span class=\"line\">        User user2 = <span class=\"keyword\">new</span> User(<span class=\"number\">2</span>, <span class=\"string\">\"Lisi\"</span>, <span class=\"string\">\"Female\"</span>, <span class=\"keyword\">null</span>, <span class=\"string\">\"小米\"</span>, <span class=\"string\">\"\"</span>, <span class=\"keyword\">new</span> Date());</span><br><span class=\"line\">        String jsonString1 = JSONObject.toJSONStringWithDateFormat(user1, <span class=\"string\">\"yyyy-MM-dd\"</span>);</span><br><span class=\"line\">        String jsonString2 = JSONObject.toJSONString(user2);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user1  \"</span> + jsonString1);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user2  \"</span> + jsonString2);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">结果：</span><br><span class=\"line\">user1  &#123;<span class=\"string\">\"Age\"</span>:<span class=\"number\">18</span>,<span class=\"string\">\"CompanyName\"</span>:<span class=\"string\">\"华为\"</span>,<span class=\"string\">\"Id\"</span>:<span class=\"number\">1</span>,<span class=\"string\">\"Name\"</span>:<span class=\"string\">\"zhangsan\"</span>,<span class=\"string\">\"Sex\"</span>:<span class=\"string\">\"Male\"</span>,<span class=\"string\">\"birthday\"</span>:<span class=\"string\">\"2019-05-21\"</span>&#125;</span><br><span class=\"line\">user2  &#123;<span class=\"string\">\"CompanyName\"</span>:<span class=\"string\">\"小米\"</span>,<span class=\"string\">\"Id\"</span>:<span class=\"number\">2</span>,<span class=\"string\">\"Name\"</span>:<span class=\"string\">\"Lisi\"</span>,<span class=\"string\">\"Remark\"</span>:<span class=\"string\">\"\"</span>,<span class=\"string\">\"Sex\"</span>:<span class=\"string\">\"Female\"</span>,<span class=\"string\">\"birthday\"</span>:<span class=\"number\">1558398124477</span>&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-2-json-lib\"><a href=\"#3-2-json-lib\" class=\"headerlink\" title=\"3-2. json-lib\"></a>3-2. json-lib</h3><p>默认会将Date类型的字段分解, 可通过传入<code>JsonConfig</code>并注册<code>JsonValueProcessor</code>解决这个问题</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> net.sf.json.JSONObject;</span><br><span class=\"line\"><span class=\"keyword\">import</span> net.sf.json.JsonConfig;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Date;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JSONUtilsTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        User user1 = <span class=\"keyword\">new</span> User(<span class=\"number\">1</span>, <span class=\"string\">\"zhangsan\"</span>, <span class=\"string\">\"Male\"</span>, <span class=\"number\">18</span>, <span class=\"string\">\"华为\"</span>, <span class=\"keyword\">null</span>, <span class=\"keyword\">new</span> Date());</span><br><span class=\"line\">        User user2 = <span class=\"keyword\">new</span> User(<span class=\"number\">2</span>, <span class=\"string\">\"Lisi\"</span>, <span class=\"string\">\"Female\"</span>, <span class=\"keyword\">null</span>, <span class=\"string\">\"小米\"</span>, <span class=\"string\">\"\"</span>, <span class=\"keyword\">new</span> Date());</span><br><span class=\"line\">        JsonConfig jsonConfig = <span class=\"keyword\">new</span> JsonConfig();</span><br><span class=\"line\">        jsonConfig.registerJsonValueProcessor(Date.class, <span class=\"keyword\">new</span> DateJsonValueProcessor());</span><br><span class=\"line\">        JSONObject jsonObject1 = JSONObject.fromObject(user1, jsonConfig);</span><br><span class=\"line\">        JSONObject jsonObject2 = JSONObject.fromObject(user2);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user1  \"</span> + jsonObject1.toString());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"user2  \"</span> + jsonObject2.toString());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">user1  &#123;<span class=\"string\">\"age\"</span>:<span class=\"number\">18</span>,<span class=\"string\">\"birthday\"</span>:<span class=\"string\">\"2019-05-21 08:30:53\"</span>,<span class=\"string\">\"companyName\"</span>:<span class=\"string\">\"华为\"</span>,<span class=\"string\">\"id\"</span>:<span class=\"number\">1</span>,<span class=\"string\">\"name\"</span>:<span class=\"string\">\"zhangsan\"</span>,<span class=\"string\">\"remark\"</span>:<span class=\"string\">\"\"</span>,<span class=\"string\">\"sex\"</span>:<span class=\"string\">\"Male\"</span>&#125;</span><br><span class=\"line\">user2  &#123;<span class=\"string\">\"age\"</span>:<span class=\"number\">0</span>,<span class=\"string\">\"birthday\"</span>:&#123;<span class=\"string\">\"date\"</span>:<span class=\"number\">21</span>,<span class=\"string\">\"day\"</span>:<span class=\"number\">2</span>,<span class=\"string\">\"hours\"</span>:<span class=\"number\">8</span>,<span class=\"string\">\"minutes\"</span>:<span class=\"number\">30</span>,<span class=\"string\">\"month\"</span>:<span class=\"number\">4</span>,<span class=\"string\">\"seconds\"</span>:<span class=\"number\">53</span>,<span class=\"string\">\"time\"</span>:<span class=\"number\">1558398653824</span>,<span class=\"string\">\"timezoneOffset\"</span>:-<span class=\"number\">480</span>,<span class=\"string\">\"year\"</span>:<span class=\"number\">119</span>&#125;,<span class=\"string\">\"companyName\"</span>:<span class=\"string\">\"小米\"</span>,<span class=\"string\">\"id\"</span>:<span class=\"number\">2</span>,<span class=\"string\">\"name\"</span>:<span class=\"string\">\"Lisi\"</span>,<span class=\"string\">\"remark\"</span>:<span class=\"string\">\"\"</span>,<span class=\"string\">\"sex\"</span>:<span class=\"string\">\"Female\"</span>&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DateJsonValueProcessor</span> <span class=\"keyword\">implements</span> <span class=\"title\">JsonValueProcessor</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String formatDateTime = <span class=\"string\">\"yyyy-MM-dd HH:mm:ss\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String formatDate = <span class=\"string\">\"yyyy-MM-dd\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">DateJsonValueProcessor</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">DateJsonValueProcessor</span><span class=\"params\">(String format)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.formatDateTime = format;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">processArrayValue</span><span class=\"params\">(Object value, JsonConfig jsonConfig)</span> </span>&#123;</span><br><span class=\"line\">        String[] obj = &#123;&#125;;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (value <span class=\"keyword\">instanceof</span> Date[]) &#123;</span><br><span class=\"line\">            SimpleDateFormat sf = <span class=\"keyword\">new</span> SimpleDateFormat(formatDateTime);</span><br><span class=\"line\">            Date[] dates = (Date[]) value;</span><br><span class=\"line\">            obj = <span class=\"keyword\">new</span> String[dates.length];</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; dates.length; i++) &#123;</span><br><span class=\"line\">                obj[i] = sf.format(dates[i]);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> obj;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">processObjectValue</span><span class=\"params\">(String key, Object value, JsonConfig jsonConfig)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (value <span class=\"keyword\">instanceof</span> Date) &#123;</span><br><span class=\"line\">            String str = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (Objects.equals(key, <span class=\"string\">\"checkDate\"</span>) || Objects.equals(key, <span class=\"string\">\"validUntil\"</span>)) &#123;</span><br><span class=\"line\">                str = <span class=\"keyword\">new</span> SimpleDateFormat(formatDate).format((Date) value);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                str = <span class=\"keyword\">new</span> SimpleDateFormat(formatDateTime).format((Date) value);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> str;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"记一次事务不起作用的排错历程","date":"2019-06-11T14:04:03.000Z","_content":"\n# 记一次@Transactional不起作用的排错历程\n\n## 问题描述\n\n服务端接口需提供接口，在web端将某个终端调为在线模式时，同时需要更新内存中在线的终端数据。 在更新终端状态成功之后，立刻查询数据库处于在线状态的终端数据,然后内存中的数据。更新状态与更新内存数据在同一个事务，查询操作需要保证能够读取到还未提交的更新操作。\n\n<!--more-->\n\n想到这应该是设计到事务的隔离性这块，因为之前对事务处理这块认识比较不足，就决定来科普下事务相关的知识点。\n\n但出门的第一步就跌了个大跟头，代码里的事务根本不起作用，@Transactional注解形同虚设，于是开始排错。\n\n代码是这样的(项目整合了SpringBoot+MyBatisPlus+Druid+Shiro)\n\nController层\n\n```java\n@RequestMapping(value = \"/switchstatus\", method = RequestMethod.POST)\n@RequiresPermissions(\"oilset:intelligentterminal:update\")\npublic ResponseResult switchStatus(String uid, Integer status) {\n    if (StrUtils.isEmpty(uid) || status == null) return ResponseResult.error(ResponseCode.requiredParamNotFound);\n    IntelligentterminalEntity entity = intelligentterminalService.selectById(uid);\n    if (entity == null) {\n        return ResponseResult.error(ResponseCode.recordNotFound);\n    } else if (entity.getStatus() == status) {\n        return ResponseResult.error(ResponseCode.requestParamInvalid);\n    }\n    boolean success = intelligentterminalService.switchStatus(uid, status);\n    return success ? ResponseResult.ok() : ResponseResult.error();\n}\n```\n\nService层\n\n```java\n@Override\n@Transactional\npublic boolean switchStatus(String uid, Integer status) {\n    boolean success = false;\n    success = this.updateById(new IntelligentterminalEntity(uid, status), SpringContextHolder.getLogInUserId());\n    if (success) {\n        throw new RuntimeException();\n    }\n    return success;\n}\n```\n\n尝试手动rollback,事务可以回滚\n\n```java\n@Autowired\nprivate DataSourceTransactionManager transactionManager;\n\n\n@Override\n@Transactional\npublic boolean switchStatus(String uid, Integer status) {\n    DefaultTransactionDefinition def = new DefaultTransactionDefinition();\n    def.setName(\"text-transaction\");\n    def.setPropagationBehavior(TransactionDefinition.PROPAGATION_REQUIRED);\n    TransactionStatus tsStatus = transactionManager.getTransaction(def);\n\n    boolean success = false;\n    try {\n        success = this.updateById(new IntelligentterminalEntity(uid, status), SpringContextHolder.getLogInUserId());\n        if (success){\n            throw new RuntimeException();\n        }\n    } catch (RuntimeException e) {\n        transactionManager.rollback(tsStatus);\n        throw e;\n    }\n    return success;\n}\n```\n\n启动类加入了\n\n```xml\n@EnableTransactionManagement\n```\n\napplication.properties加入了\n\n```xml\nspring.transaction.rollback-on-commit-failure=true\n```\n\n本来想的是，本次更新应该不会成功，可数据库偏偏就更新了，事务根本就没有回滚。\n\n## 分析\n\n- 事务用法不对，对@Transactional的用法存在问题\n- 项目搭建/配置存在问题，导致整个项目事务不起作用\n- 框架之间整合不兼容，导致事务不起作用\n\n### 排错之一：SpringBoot事务管理用法错误\n\n经过查阅各种资料，SpringBoot中声明式事务注意点有以下几点：\n\n- @Transactional 只能应用到 public 方法才有效\n- 正确的设置@Transactional 的 rollbackFor 属性。默认情况下，如果在事务中抛出了未检查异常（继承自 RuntimeException 的异常）或者 Error，则 Spring 将回滚事务；除此之外，Spring 不会回滚事务。如果在事务中抛出其他类型的异常，并期望 Spring 能够回滚事务，可以指定 rollbackFor\n- 正确的设置@Transactional 的 propagation 属性\n- 避免 Spring 的 AOP 的自调用问题。在 Spring 的 AOP 代理下，只有目标方法由外部调用，目标方法才由 Spring 生成的代理对象来管理，这会造成自调用问题。若同一类中的其他没有@Transactional 注解的方法内部调用有@Transactional 注解的方法，有@Transactional 注解的方法的事务被忽略，不会发生回滚。\n- 抛出的异常不能被catch,或者catch后抛出其他异常\n\n检查代码后，所有这些条件都符合，可是就是没有生效呢。于是只能换个思路走走\n\n### 排错之二：数据库引擎类型不支持\n\n数据库引擎要支持事务，如果是MySQL，注意表要使用支持事务的引擎，比如innodb，如果是myisam，事务是不起作用的。可检查发现表引擎确实是innodb。为了确认表引擎支持事务，我还重新在另一个项目里测试了表确实支持事务。那这到底是为啥呢，别的项目里可以，目前这个项目里就是不生效。于是怀疑是项目各框架之间整合出了问题。\n\n### 排错之三：框架整合冲突\n\n第一步：\n我重新建一张测试表, 然后操作这张表，其他代码与原代码一致。见证奇迹的时候到了,事务回滚了，欣喜若狂。代码如下\n\nController层\n\n```java\n@RequestMapping(\"/update\")\npublic ResponseResult update(String id, String name) {\n    areaService.updateAreaById(id, name);\n    return ResponseResult.ok();\n}\n```\n\nService层\n\n```java\n@Override\n@Transactional\npublic boolean updateAreaById(String id, String name) {\n        AreaEntity entity = new AreaEntity();\n        entity.setAreaId(Integer.parseInt(id));\n        entity.setAreaName(name);\n        Integer integer = this.baseMapper.updateById(entity);\n        if (integer > 0) {\n            throw new RuntimeException();\n        }\n    return true;\n}\n```\n\n这就奇怪了,项目整合没啥问题,怎么操作终端的就是不回滚呢。好吧，我开始怀疑人生了。。。\n于是我又用同样的操作，测试了用户更新，果然不负所望，跟操作终端的update一样的效果。我先冷静会。。。后来我各种神测试，在终端的Controller层调用Area的Service层，在终端Service层调用Area的Service层。突然，原来的测试Area的事务也不回滚了，这下彻底无解了。\n\n这期间实在头疼，脑子里各种回忆还有那种可能。好像项目中还有比较影响的就是Shiro了，于是灵机一动，百度一下\"Shiro 使注解无效\"。果然，有大牛给出了答案。[Spring Boot整合shiro后导致@Cacheable、@Transactional等注解失效的问题](https://blog.csdn.net/gnail_oug/article/details/80706205)\n\n参考:\nstackoverflow网站上的一些文章认为，Shiro框架初始化比Spring框架的某些部件早，导致使用@Autowire注入Shiro框架的某些类不能被Spring正确初始化。\n[文章链接](https://stackoverflow.com/questions/21512791/spring-service-with-cacheable-methods-gets-initialized-without-cache-when-autowi)\n\n原来是shiro框架与spring框架的BeanFactory有所冲突，导致注入shiro框架的类不能被spring正确初始化。\n于是修改了MyShiroRealm中的代码加入懒加载@Lazy\n\n```java\n@Lazy\n@Autowired\nprivate SysUserService userService;\n```\n\n终于，奇迹发生了，事务回滚了，我欣喜若狂。但回头想想，不对呀，Realm只注入了SysUserService，怎么会影响终端的Service,于是又开始各种寻找，果然SysUserService里注入了B，B又注入了终端的Service，这就是一环套一环啊，之前测试Area也解释通了，我在终端Service注入了AreaService，导致也被带跑偏了。\n\n终于这个找了2天的问题终于得到了解答。\n\n\n\n## 补充知识点\n\n[转自https://www.ibm.com/developerworks/cn/java/j-master-spring-transactional-use/](https://www.ibm.com/developerworks/cn/java/j-master-spring-transactional-use/)\n\nSpring 事务管理分为编码式和声明式的两种方式。编程式事务指的是通过编码方式实现事务；声明式事务基于 AOP,将具体业务逻辑与事务处理解耦。声明式事务管理使业务代码逻辑不受污染, 因此在实际使用中声明式事务用的比较多\n\n### @Transactional注解实现事务管理的步骤\n\n#### 事务配置信息\n\n```xml\n<tx:annotation-driven />\n<bean id=\"transactionManager\" class=\"org.springframework.jdbc.datasource.DataSourceTransactionManager\">\n    <property name=\"dataSource\" ref=\"dataSource\" />\n</bean>\n```\n\n或者使用 **@EnableTransactionManagement** 注解\n\n#### 将@Transactional 注解添加到合适的方法上，并设置合适的属性信息。\n\n@Transactional 注解的属性信息\n\n|     属性名      | 说明                                                         |\n| :-------------: | :----------------------------------------------------------- |\n|      name       | 当在配置文件中有多个 TransactionManager , 可以用该属性指定选择哪个事务管理器 |\n|   propagation   | 事务的传播行为，默认值为 REQUIRED                            |\n|    isolation    | 事务的隔离度，默认值采用 DEFAULT                             |\n|     timeout     | 事务的超时时间，默认值为-1。如果超过该时间限制但事务还没有完成，则自动回滚事务 |\n|    read-only    | 指定事务是否为只读事务，默认值为 false；为了忽略那些不需要事务的方法，比如读取数据，可以设置 read-only 为 true |\n|  rollback-for   | 用于指定能够触发事务回滚的异常类型，如果有多个异常类型需要指定，各类型之间可以通过逗号分隔 |\n| no-rollback-for | 抛出 no-rollback-for 指定的异常类型，不回滚事务              |\n\n除此以外，@Transactional 注解也可以添加到类级别上。当把@Transactional 注解放在类级别时，表示所有该类的公共方法都配置相同的事务属性信息。见清单 2，EmployeeService 的所有方法都支持事务并且是只读。当类级别配置了@Transactional，方法级别也配置了@Transactional，应用程序会以方法级别的事务属性信息来管理事务，换言之，方法级别的事务属性信息会覆盖类级别的相关配置信息\n\n**read-only使用场景**\n\n从这一点设置的时间点开始（时间点a）到这个事务结束的过程中，其他事务所提交的数据，该事务将看不见！（查询中不会出现别人在时间点a之后提交的数据）\n\n如果你一次执行单条查询语句，则没有必要启用事务支持，数据库默认支持SQL执行期间的读一致性； \n如果你一次执行多条查询语句，例如统计查询，报表查询，在这种场景下，多条查询SQL必须保证整体的读一致性，否则，在前条SQL查询之后，后条SQL查询之前，数据被其他用户改变，则该次整体的统计查询将会出现读数据不一致的状态，此时，应该启用事务支持。\n【注意是一次执行多次查询来统计某些信息，这时为了保证数据整体的一致性，要用只读事务】\n\n在将事务设置成只读后，相当于将数据库设置成只读数据库，此时若要进行写的操作，会出现错误\n\n### Spring 的注解方式的事务实现机制\n\n在应用系统调用声明@Transactional 的目标方法时，Spring Framework 默认使用 AOP 代理，在代码运行时生成一个代理对象，根据@Transactional 的属性配置信息，这个代理对象决定该声明@Transactional 的目标方法是否由拦截器 TransactionInterceptor 来使用拦截，在 TransactionInterceptor 拦截时，会在在目标方法开始执行之前创建并加入事务，并执行目标方法的逻辑, 最后根据执行情况是否出现异常，利用抽象事务管理器\n\n![image](D:/WorkSpaces/Hexo/HexoBlog/source/_posts/%E8%AE%B0%E4%B8%80%E6%AC%A1-Transactional%E4%B8%8D%E8%B5%B7%E4%BD%9C%E7%94%A8%E7%9A%84%E6%8E%92%E9%94%99%E5%8E%86%E7%A8%8B/01Spring%E4%BA%8B%E5%8A%A1%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6.jpg)\n\nSpring AOP 代理有 CglibAopProxy 和 JdkDynamicAopProxy 两种，上图 是以 CglibAopProxy 为例，对于 CglibAopProxy，需要调用其内部类的 DynamicAdvisedInterceptor 的 intercept 方法。对于 JdkDynamicAopProxy，需要调用其 invoke 方法。\n\n正如上文提到的，事务管理的框架是由抽象事务管理器 AbstractPlatformTransactionManager 来提供的，而具体的底层事务处理实现，由 PlatformTransactionManager 的具体实现类来实现，如事务管理器 DataSourceTransactionManager。不同的事务管理器管理不同的数据资源 DataSource，比如 DataSourceTransactionManager 管理 JDBC 的 Connection。\n\nPlatformTransactionManager，AbstractPlatformTransactionManager 及具体实现类关系下图所示\n\n![image](D:/WorkSpaces/Hexo/HexoBlog/source/_posts/%E8%AE%B0%E4%B8%80%E6%AC%A1-Transactional%E4%B8%8D%E8%B5%B7%E4%BD%9C%E7%94%A8%E7%9A%84%E6%8E%92%E9%94%99%E5%8E%86%E7%A8%8B/02TransactionManager%E7%B1%BB%E7%BB%93%E6%9E%84.jpg)\n\n### Spring事务7种传播行为\n\n所谓事务的传播行为是指，如果在开始当前事务之前，一个事务上下文已经存在，此时有若干选项可以指定一个事务性方法的执行行为。\n\n- **PROPAGATION.REQUIRED**：如果当前没有事务，就创建一个新事务，如果当前存在事务，就加入该事务，该设置是最常用的设置。**Spring默认的传播行为**\n- **PROPAGATION.SUPPORTS**：支持当前事务，如果当前存在事务，就加入该事务，如果当前不存在事务，就以非事务执行。\n- **PROPAGATION.MANDATORY**：支持当前事务，如果当前存在事务，就加入该事务，如果当前不存在事务，就抛出异常\n- **PROPAGATION.REQUIRES_NEW**：创建新事务，无论当前存不存在事务，都创建新事务\n- **PROPAGATION.NOT_SUPPORTED**：以非事务方式执行操作，如果当前存在事务，就把当前事务挂起\n- **PROPAGATION.NEVER**：以非事务方式执行，如果当前存在事务，则抛出异常\n- **PROPAGATION.NESTED**：如果当前存在事务，则在嵌套事务内执行。如果当前没有事务，则执行与PROPAGATION_REQUIRED类似的操作\n\n### Spring事务隔离性\n\n[示例地址](https://www.cnblogs.com/huanongying/p/7021555.html)\n\n隔离级别是指若干个并发的事务之间的隔离程度，与我们开发时候主要相关的场景包括：脏读取、重复读、幻读。\n\n- DEFAULT ：这是默认值，表示使用底层数据库的默认隔离级别。对大部分数据库而言，通常这值就是： READ_COMMITTED 。 MyAQL查询(SELECT @@tx_isolation)\n- READ_UNCOMMITTED ：该隔离级别表示一个事务可以读取另一个事务修改但还没有提交的数据。该级别不能防止脏读和不可重复读，因此很少使用该隔离级别。 \n- READ_COMMITTED ：该隔离级别表示一个事务只能读取另一个事务已经提交的数据。该级别可以防止脏读，这也是大多数情况下的推荐值。 \n- REPEATABLE_READ ：该隔离级别表示一个事务在整个过程中可以多次重复执行某个查询，并且每次返回的记录都相同。即使在多次查询之间有新增的数据满足该查询，这些新增的记录也会被忽略。该级别可以防止脏读和不可重复读。 \n- SERIALIZABLE ：所有的事务依次逐个执行，这样事务之间就完全不可能产生干扰，也就是说，该级别可以防止脏读、不可重复读以及幻读。但是这将严重影响程序的性能。通常情况下也不会用到该级别。 \n\n指定方法：通过使用 isolation 属性设置，例如：@Transactional(isolation = Isolation.DEFAULT)/\n\n**丢失更新**：两个事务同时更新一行数据，最后一个事务的更新会覆盖掉第一个事务的更新，从而导致第一个事务更新的数据丢失，后果比较严重。一般是由于没加锁的原因造成的。\n**脏读（Dirty reads）**：一个事务A读取到了另一个事务B还没有提交的数据，并在此基础上进行操作。如果B事务rollback，那么A事务所读取到的数据就是不正确的，会带来问题。\n**不可重复读（Non-repeatable reads）**：在同一事务范围内读取两次相同的数据，所返回的结果不同。比如事务B第一次读数据后，事务A更新数据并commit，那么事务B第二次读取的数据就与第一次是不一样的。\n**幻读（Phantom reads）**：一个事务A读取到了另一个事务B新提交的数据。比如，事务A对一个表中所有行的数据按照某规则进行修改（整表操作），同时，事务B向表中插入了一行原始数据，那么后面事务A再对表进行操作时，会发现表中居然还有一行数据没有被修改，就像发生了幻觉，飘飘欲仙一样。\n注意：不可重复读和幻读的区别是，不可重复读对应的表的操作是更改(UPDATE)，而幻读对应的表的操作是插入(INSERT)，两种的应对策略不一样。对于不可重复读，只需要采用行级锁防止该记录被更新即可，而对于幻读必须加个表级锁，防止在表中插入数据。有关锁的问题，下面会讨论。","source":"_posts/20190611-记一次事务不起作用的排错历程.md","raw":"---\ntitle: 记一次事务不起作用的排错历程\ndate: 2019-06-11 22:04:03\ntags: '经验总结'\ncategories: 'Lesson-Learned'\n---\n\n# 记一次@Transactional不起作用的排错历程\n\n## 问题描述\n\n服务端接口需提供接口，在web端将某个终端调为在线模式时，同时需要更新内存中在线的终端数据。 在更新终端状态成功之后，立刻查询数据库处于在线状态的终端数据,然后内存中的数据。更新状态与更新内存数据在同一个事务，查询操作需要保证能够读取到还未提交的更新操作。\n\n<!--more-->\n\n想到这应该是设计到事务的隔离性这块，因为之前对事务处理这块认识比较不足，就决定来科普下事务相关的知识点。\n\n但出门的第一步就跌了个大跟头，代码里的事务根本不起作用，@Transactional注解形同虚设，于是开始排错。\n\n代码是这样的(项目整合了SpringBoot+MyBatisPlus+Druid+Shiro)\n\nController层\n\n```java\n@RequestMapping(value = \"/switchstatus\", method = RequestMethod.POST)\n@RequiresPermissions(\"oilset:intelligentterminal:update\")\npublic ResponseResult switchStatus(String uid, Integer status) {\n    if (StrUtils.isEmpty(uid) || status == null) return ResponseResult.error(ResponseCode.requiredParamNotFound);\n    IntelligentterminalEntity entity = intelligentterminalService.selectById(uid);\n    if (entity == null) {\n        return ResponseResult.error(ResponseCode.recordNotFound);\n    } else if (entity.getStatus() == status) {\n        return ResponseResult.error(ResponseCode.requestParamInvalid);\n    }\n    boolean success = intelligentterminalService.switchStatus(uid, status);\n    return success ? ResponseResult.ok() : ResponseResult.error();\n}\n```\n\nService层\n\n```java\n@Override\n@Transactional\npublic boolean switchStatus(String uid, Integer status) {\n    boolean success = false;\n    success = this.updateById(new IntelligentterminalEntity(uid, status), SpringContextHolder.getLogInUserId());\n    if (success) {\n        throw new RuntimeException();\n    }\n    return success;\n}\n```\n\n尝试手动rollback,事务可以回滚\n\n```java\n@Autowired\nprivate DataSourceTransactionManager transactionManager;\n\n\n@Override\n@Transactional\npublic boolean switchStatus(String uid, Integer status) {\n    DefaultTransactionDefinition def = new DefaultTransactionDefinition();\n    def.setName(\"text-transaction\");\n    def.setPropagationBehavior(TransactionDefinition.PROPAGATION_REQUIRED);\n    TransactionStatus tsStatus = transactionManager.getTransaction(def);\n\n    boolean success = false;\n    try {\n        success = this.updateById(new IntelligentterminalEntity(uid, status), SpringContextHolder.getLogInUserId());\n        if (success){\n            throw new RuntimeException();\n        }\n    } catch (RuntimeException e) {\n        transactionManager.rollback(tsStatus);\n        throw e;\n    }\n    return success;\n}\n```\n\n启动类加入了\n\n```xml\n@EnableTransactionManagement\n```\n\napplication.properties加入了\n\n```xml\nspring.transaction.rollback-on-commit-failure=true\n```\n\n本来想的是，本次更新应该不会成功，可数据库偏偏就更新了，事务根本就没有回滚。\n\n## 分析\n\n- 事务用法不对，对@Transactional的用法存在问题\n- 项目搭建/配置存在问题，导致整个项目事务不起作用\n- 框架之间整合不兼容，导致事务不起作用\n\n### 排错之一：SpringBoot事务管理用法错误\n\n经过查阅各种资料，SpringBoot中声明式事务注意点有以下几点：\n\n- @Transactional 只能应用到 public 方法才有效\n- 正确的设置@Transactional 的 rollbackFor 属性。默认情况下，如果在事务中抛出了未检查异常（继承自 RuntimeException 的异常）或者 Error，则 Spring 将回滚事务；除此之外，Spring 不会回滚事务。如果在事务中抛出其他类型的异常，并期望 Spring 能够回滚事务，可以指定 rollbackFor\n- 正确的设置@Transactional 的 propagation 属性\n- 避免 Spring 的 AOP 的自调用问题。在 Spring 的 AOP 代理下，只有目标方法由外部调用，目标方法才由 Spring 生成的代理对象来管理，这会造成自调用问题。若同一类中的其他没有@Transactional 注解的方法内部调用有@Transactional 注解的方法，有@Transactional 注解的方法的事务被忽略，不会发生回滚。\n- 抛出的异常不能被catch,或者catch后抛出其他异常\n\n检查代码后，所有这些条件都符合，可是就是没有生效呢。于是只能换个思路走走\n\n### 排错之二：数据库引擎类型不支持\n\n数据库引擎要支持事务，如果是MySQL，注意表要使用支持事务的引擎，比如innodb，如果是myisam，事务是不起作用的。可检查发现表引擎确实是innodb。为了确认表引擎支持事务，我还重新在另一个项目里测试了表确实支持事务。那这到底是为啥呢，别的项目里可以，目前这个项目里就是不生效。于是怀疑是项目各框架之间整合出了问题。\n\n### 排错之三：框架整合冲突\n\n第一步：\n我重新建一张测试表, 然后操作这张表，其他代码与原代码一致。见证奇迹的时候到了,事务回滚了，欣喜若狂。代码如下\n\nController层\n\n```java\n@RequestMapping(\"/update\")\npublic ResponseResult update(String id, String name) {\n    areaService.updateAreaById(id, name);\n    return ResponseResult.ok();\n}\n```\n\nService层\n\n```java\n@Override\n@Transactional\npublic boolean updateAreaById(String id, String name) {\n        AreaEntity entity = new AreaEntity();\n        entity.setAreaId(Integer.parseInt(id));\n        entity.setAreaName(name);\n        Integer integer = this.baseMapper.updateById(entity);\n        if (integer > 0) {\n            throw new RuntimeException();\n        }\n    return true;\n}\n```\n\n这就奇怪了,项目整合没啥问题,怎么操作终端的就是不回滚呢。好吧，我开始怀疑人生了。。。\n于是我又用同样的操作，测试了用户更新，果然不负所望，跟操作终端的update一样的效果。我先冷静会。。。后来我各种神测试，在终端的Controller层调用Area的Service层，在终端Service层调用Area的Service层。突然，原来的测试Area的事务也不回滚了，这下彻底无解了。\n\n这期间实在头疼，脑子里各种回忆还有那种可能。好像项目中还有比较影响的就是Shiro了，于是灵机一动，百度一下\"Shiro 使注解无效\"。果然，有大牛给出了答案。[Spring Boot整合shiro后导致@Cacheable、@Transactional等注解失效的问题](https://blog.csdn.net/gnail_oug/article/details/80706205)\n\n参考:\nstackoverflow网站上的一些文章认为，Shiro框架初始化比Spring框架的某些部件早，导致使用@Autowire注入Shiro框架的某些类不能被Spring正确初始化。\n[文章链接](https://stackoverflow.com/questions/21512791/spring-service-with-cacheable-methods-gets-initialized-without-cache-when-autowi)\n\n原来是shiro框架与spring框架的BeanFactory有所冲突，导致注入shiro框架的类不能被spring正确初始化。\n于是修改了MyShiroRealm中的代码加入懒加载@Lazy\n\n```java\n@Lazy\n@Autowired\nprivate SysUserService userService;\n```\n\n终于，奇迹发生了，事务回滚了，我欣喜若狂。但回头想想，不对呀，Realm只注入了SysUserService，怎么会影响终端的Service,于是又开始各种寻找，果然SysUserService里注入了B，B又注入了终端的Service，这就是一环套一环啊，之前测试Area也解释通了，我在终端Service注入了AreaService，导致也被带跑偏了。\n\n终于这个找了2天的问题终于得到了解答。\n\n\n\n## 补充知识点\n\n[转自https://www.ibm.com/developerworks/cn/java/j-master-spring-transactional-use/](https://www.ibm.com/developerworks/cn/java/j-master-spring-transactional-use/)\n\nSpring 事务管理分为编码式和声明式的两种方式。编程式事务指的是通过编码方式实现事务；声明式事务基于 AOP,将具体业务逻辑与事务处理解耦。声明式事务管理使业务代码逻辑不受污染, 因此在实际使用中声明式事务用的比较多\n\n### @Transactional注解实现事务管理的步骤\n\n#### 事务配置信息\n\n```xml\n<tx:annotation-driven />\n<bean id=\"transactionManager\" class=\"org.springframework.jdbc.datasource.DataSourceTransactionManager\">\n    <property name=\"dataSource\" ref=\"dataSource\" />\n</bean>\n```\n\n或者使用 **@EnableTransactionManagement** 注解\n\n#### 将@Transactional 注解添加到合适的方法上，并设置合适的属性信息。\n\n@Transactional 注解的属性信息\n\n|     属性名      | 说明                                                         |\n| :-------------: | :----------------------------------------------------------- |\n|      name       | 当在配置文件中有多个 TransactionManager , 可以用该属性指定选择哪个事务管理器 |\n|   propagation   | 事务的传播行为，默认值为 REQUIRED                            |\n|    isolation    | 事务的隔离度，默认值采用 DEFAULT                             |\n|     timeout     | 事务的超时时间，默认值为-1。如果超过该时间限制但事务还没有完成，则自动回滚事务 |\n|    read-only    | 指定事务是否为只读事务，默认值为 false；为了忽略那些不需要事务的方法，比如读取数据，可以设置 read-only 为 true |\n|  rollback-for   | 用于指定能够触发事务回滚的异常类型，如果有多个异常类型需要指定，各类型之间可以通过逗号分隔 |\n| no-rollback-for | 抛出 no-rollback-for 指定的异常类型，不回滚事务              |\n\n除此以外，@Transactional 注解也可以添加到类级别上。当把@Transactional 注解放在类级别时，表示所有该类的公共方法都配置相同的事务属性信息。见清单 2，EmployeeService 的所有方法都支持事务并且是只读。当类级别配置了@Transactional，方法级别也配置了@Transactional，应用程序会以方法级别的事务属性信息来管理事务，换言之，方法级别的事务属性信息会覆盖类级别的相关配置信息\n\n**read-only使用场景**\n\n从这一点设置的时间点开始（时间点a）到这个事务结束的过程中，其他事务所提交的数据，该事务将看不见！（查询中不会出现别人在时间点a之后提交的数据）\n\n如果你一次执行单条查询语句，则没有必要启用事务支持，数据库默认支持SQL执行期间的读一致性； \n如果你一次执行多条查询语句，例如统计查询，报表查询，在这种场景下，多条查询SQL必须保证整体的读一致性，否则，在前条SQL查询之后，后条SQL查询之前，数据被其他用户改变，则该次整体的统计查询将会出现读数据不一致的状态，此时，应该启用事务支持。\n【注意是一次执行多次查询来统计某些信息，这时为了保证数据整体的一致性，要用只读事务】\n\n在将事务设置成只读后，相当于将数据库设置成只读数据库，此时若要进行写的操作，会出现错误\n\n### Spring 的注解方式的事务实现机制\n\n在应用系统调用声明@Transactional 的目标方法时，Spring Framework 默认使用 AOP 代理，在代码运行时生成一个代理对象，根据@Transactional 的属性配置信息，这个代理对象决定该声明@Transactional 的目标方法是否由拦截器 TransactionInterceptor 来使用拦截，在 TransactionInterceptor 拦截时，会在在目标方法开始执行之前创建并加入事务，并执行目标方法的逻辑, 最后根据执行情况是否出现异常，利用抽象事务管理器\n\n![image](D:/WorkSpaces/Hexo/HexoBlog/source/_posts/%E8%AE%B0%E4%B8%80%E6%AC%A1-Transactional%E4%B8%8D%E8%B5%B7%E4%BD%9C%E7%94%A8%E7%9A%84%E6%8E%92%E9%94%99%E5%8E%86%E7%A8%8B/01Spring%E4%BA%8B%E5%8A%A1%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6.jpg)\n\nSpring AOP 代理有 CglibAopProxy 和 JdkDynamicAopProxy 两种，上图 是以 CglibAopProxy 为例，对于 CglibAopProxy，需要调用其内部类的 DynamicAdvisedInterceptor 的 intercept 方法。对于 JdkDynamicAopProxy，需要调用其 invoke 方法。\n\n正如上文提到的，事务管理的框架是由抽象事务管理器 AbstractPlatformTransactionManager 来提供的，而具体的底层事务处理实现，由 PlatformTransactionManager 的具体实现类来实现，如事务管理器 DataSourceTransactionManager。不同的事务管理器管理不同的数据资源 DataSource，比如 DataSourceTransactionManager 管理 JDBC 的 Connection。\n\nPlatformTransactionManager，AbstractPlatformTransactionManager 及具体实现类关系下图所示\n\n![image](D:/WorkSpaces/Hexo/HexoBlog/source/_posts/%E8%AE%B0%E4%B8%80%E6%AC%A1-Transactional%E4%B8%8D%E8%B5%B7%E4%BD%9C%E7%94%A8%E7%9A%84%E6%8E%92%E9%94%99%E5%8E%86%E7%A8%8B/02TransactionManager%E7%B1%BB%E7%BB%93%E6%9E%84.jpg)\n\n### Spring事务7种传播行为\n\n所谓事务的传播行为是指，如果在开始当前事务之前，一个事务上下文已经存在，此时有若干选项可以指定一个事务性方法的执行行为。\n\n- **PROPAGATION.REQUIRED**：如果当前没有事务，就创建一个新事务，如果当前存在事务，就加入该事务，该设置是最常用的设置。**Spring默认的传播行为**\n- **PROPAGATION.SUPPORTS**：支持当前事务，如果当前存在事务，就加入该事务，如果当前不存在事务，就以非事务执行。\n- **PROPAGATION.MANDATORY**：支持当前事务，如果当前存在事务，就加入该事务，如果当前不存在事务，就抛出异常\n- **PROPAGATION.REQUIRES_NEW**：创建新事务，无论当前存不存在事务，都创建新事务\n- **PROPAGATION.NOT_SUPPORTED**：以非事务方式执行操作，如果当前存在事务，就把当前事务挂起\n- **PROPAGATION.NEVER**：以非事务方式执行，如果当前存在事务，则抛出异常\n- **PROPAGATION.NESTED**：如果当前存在事务，则在嵌套事务内执行。如果当前没有事务，则执行与PROPAGATION_REQUIRED类似的操作\n\n### Spring事务隔离性\n\n[示例地址](https://www.cnblogs.com/huanongying/p/7021555.html)\n\n隔离级别是指若干个并发的事务之间的隔离程度，与我们开发时候主要相关的场景包括：脏读取、重复读、幻读。\n\n- DEFAULT ：这是默认值，表示使用底层数据库的默认隔离级别。对大部分数据库而言，通常这值就是： READ_COMMITTED 。 MyAQL查询(SELECT @@tx_isolation)\n- READ_UNCOMMITTED ：该隔离级别表示一个事务可以读取另一个事务修改但还没有提交的数据。该级别不能防止脏读和不可重复读，因此很少使用该隔离级别。 \n- READ_COMMITTED ：该隔离级别表示一个事务只能读取另一个事务已经提交的数据。该级别可以防止脏读，这也是大多数情况下的推荐值。 \n- REPEATABLE_READ ：该隔离级别表示一个事务在整个过程中可以多次重复执行某个查询，并且每次返回的记录都相同。即使在多次查询之间有新增的数据满足该查询，这些新增的记录也会被忽略。该级别可以防止脏读和不可重复读。 \n- SERIALIZABLE ：所有的事务依次逐个执行，这样事务之间就完全不可能产生干扰，也就是说，该级别可以防止脏读、不可重复读以及幻读。但是这将严重影响程序的性能。通常情况下也不会用到该级别。 \n\n指定方法：通过使用 isolation 属性设置，例如：@Transactional(isolation = Isolation.DEFAULT)/\n\n**丢失更新**：两个事务同时更新一行数据，最后一个事务的更新会覆盖掉第一个事务的更新，从而导致第一个事务更新的数据丢失，后果比较严重。一般是由于没加锁的原因造成的。\n**脏读（Dirty reads）**：一个事务A读取到了另一个事务B还没有提交的数据，并在此基础上进行操作。如果B事务rollback，那么A事务所读取到的数据就是不正确的，会带来问题。\n**不可重复读（Non-repeatable reads）**：在同一事务范围内读取两次相同的数据，所返回的结果不同。比如事务B第一次读数据后，事务A更新数据并commit，那么事务B第二次读取的数据就与第一次是不一样的。\n**幻读（Phantom reads）**：一个事务A读取到了另一个事务B新提交的数据。比如，事务A对一个表中所有行的数据按照某规则进行修改（整表操作），同时，事务B向表中插入了一行原始数据，那么后面事务A再对表进行操作时，会发现表中居然还有一行数据没有被修改，就像发生了幻觉，飘飘欲仙一样。\n注意：不可重复读和幻读的区别是，不可重复读对应的表的操作是更改(UPDATE)，而幻读对应的表的操作是插入(INSERT)，两种的应对策略不一样。对于不可重复读，只需要采用行级锁防止该记录被更新即可，而对于幻读必须加个表级锁，防止在表中插入数据。有关锁的问题，下面会讨论。","slug":"记一次事务不起作用的排错历程","published":1,"updated":"2019-06-11T14:11:04.769Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck27dih28000cmskp116iltb1","content":"<h1 id=\"记一次-Transactional不起作用的排错历程\"><a href=\"#记一次-Transactional不起作用的排错历程\" class=\"headerlink\" title=\"记一次@Transactional不起作用的排错历程\"></a>记一次@Transactional不起作用的排错历程</h1><h2 id=\"问题描述\"><a href=\"#问题描述\" class=\"headerlink\" title=\"问题描述\"></a>问题描述</h2><p>服务端接口需提供接口，在web端将某个终端调为在线模式时，同时需要更新内存中在线的终端数据。 在更新终端状态成功之后，立刻查询数据库处于在线状态的终端数据,然后内存中的数据。更新状态与更新内存数据在同一个事务，查询操作需要保证能够读取到还未提交的更新操作。</p>\n<a id=\"more\"></a>\n<p>想到这应该是设计到事务的隔离性这块，因为之前对事务处理这块认识比较不足，就决定来科普下事务相关的知识点。</p>\n<p>但出门的第一步就跌了个大跟头，代码里的事务根本不起作用，@Transactional注解形同虚设，于是开始排错。</p>\n<p>代码是这样的(项目整合了SpringBoot+MyBatisPlus+Druid+Shiro)</p>\n<p>Controller层</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RequestMapping</span>(value = <span class=\"string\">\"/switchstatus\"</span>, method = RequestMethod.POST)</span><br><span class=\"line\"><span class=\"meta\">@RequiresPermissions</span>(<span class=\"string\">\"oilset:intelligentterminal:update\"</span>)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> ResponseResult <span class=\"title\">switchStatus</span><span class=\"params\">(String uid, Integer status)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (StrUtils.isEmpty(uid) || status == <span class=\"keyword\">null</span>) <span class=\"keyword\">return</span> ResponseResult.error(ResponseCode.requiredParamNotFound);</span><br><span class=\"line\">    IntelligentterminalEntity entity = intelligentterminalService.selectById(uid);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (entity == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResponseResult.error(ResponseCode.recordNotFound);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (entity.getStatus() == status) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResponseResult.error(ResponseCode.requestParamInvalid);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">boolean</span> success = intelligentterminalService.switchStatus(uid, status);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> success ? ResponseResult.ok() : ResponseResult.error();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Service层</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"meta\">@Transactional</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">switchStatus</span><span class=\"params\">(String uid, Integer status)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">boolean</span> success = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    success = <span class=\"keyword\">this</span>.updateById(<span class=\"keyword\">new</span> IntelligentterminalEntity(uid, status), SpringContextHolder.getLogInUserId());</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (success) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> success;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>尝试手动rollback,事务可以回滚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Autowired</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> DataSourceTransactionManager transactionManager;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"meta\">@Transactional</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">switchStatus</span><span class=\"params\">(String uid, Integer status)</span> </span>&#123;</span><br><span class=\"line\">    DefaultTransactionDefinition def = <span class=\"keyword\">new</span> DefaultTransactionDefinition();</span><br><span class=\"line\">    def.setName(<span class=\"string\">\"text-transaction\"</span>);</span><br><span class=\"line\">    def.setPropagationBehavior(TransactionDefinition.PROPAGATION_REQUIRED);</span><br><span class=\"line\">    TransactionStatus tsStatus = transactionManager.getTransaction(def);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">boolean</span> success = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        success = <span class=\"keyword\">this</span>.updateById(<span class=\"keyword\">new</span> IntelligentterminalEntity(uid, status), SpringContextHolder.getLogInUserId());</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (success)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (RuntimeException e) &#123;</span><br><span class=\"line\">        transactionManager.rollback(tsStatus);</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> e;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> success;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>启动类加入了</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@EnableTransactionManagement</span><br></pre></td></tr></table></figure>\n<p>application.properties加入了</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring.transaction.rollback-on-commit-failure=true</span><br></pre></td></tr></table></figure>\n<p>本来想的是，本次更新应该不会成功，可数据库偏偏就更新了，事务根本就没有回滚。</p>\n<h2 id=\"分析\"><a href=\"#分析\" class=\"headerlink\" title=\"分析\"></a>分析</h2><ul>\n<li>事务用法不对，对@Transactional的用法存在问题</li>\n<li>项目搭建/配置存在问题，导致整个项目事务不起作用</li>\n<li>框架之间整合不兼容，导致事务不起作用</li>\n</ul>\n<h3 id=\"排错之一：SpringBoot事务管理用法错误\"><a href=\"#排错之一：SpringBoot事务管理用法错误\" class=\"headerlink\" title=\"排错之一：SpringBoot事务管理用法错误\"></a>排错之一：SpringBoot事务管理用法错误</h3><p>经过查阅各种资料，SpringBoot中声明式事务注意点有以下几点：</p>\n<ul>\n<li>@Transactional 只能应用到 public 方法才有效</li>\n<li>正确的设置@Transactional 的 rollbackFor 属性。默认情况下，如果在事务中抛出了未检查异常（继承自 RuntimeException 的异常）或者 Error，则 Spring 将回滚事务；除此之外，Spring 不会回滚事务。如果在事务中抛出其他类型的异常，并期望 Spring 能够回滚事务，可以指定 rollbackFor</li>\n<li>正确的设置@Transactional 的 propagation 属性</li>\n<li>避免 Spring 的 AOP 的自调用问题。在 Spring 的 AOP 代理下，只有目标方法由外部调用，目标方法才由 Spring 生成的代理对象来管理，这会造成自调用问题。若同一类中的其他没有@Transactional 注解的方法内部调用有@Transactional 注解的方法，有@Transactional 注解的方法的事务被忽略，不会发生回滚。</li>\n<li>抛出的异常不能被catch,或者catch后抛出其他异常</li>\n</ul>\n<p>检查代码后，所有这些条件都符合，可是就是没有生效呢。于是只能换个思路走走</p>\n<h3 id=\"排错之二：数据库引擎类型不支持\"><a href=\"#排错之二：数据库引擎类型不支持\" class=\"headerlink\" title=\"排错之二：数据库引擎类型不支持\"></a>排错之二：数据库引擎类型不支持</h3><p>数据库引擎要支持事务，如果是MySQL，注意表要使用支持事务的引擎，比如innodb，如果是myisam，事务是不起作用的。可检查发现表引擎确实是innodb。为了确认表引擎支持事务，我还重新在另一个项目里测试了表确实支持事务。那这到底是为啥呢，别的项目里可以，目前这个项目里就是不生效。于是怀疑是项目各框架之间整合出了问题。</p>\n<h3 id=\"排错之三：框架整合冲突\"><a href=\"#排错之三：框架整合冲突\" class=\"headerlink\" title=\"排错之三：框架整合冲突\"></a>排错之三：框架整合冲突</h3><p>第一步：<br>我重新建一张测试表, 然后操作这张表，其他代码与原代码一致。见证奇迹的时候到了,事务回滚了，欣喜若狂。代码如下</p>\n<p>Controller层</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RequestMapping</span>(<span class=\"string\">\"/update\"</span>)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> ResponseResult <span class=\"title\">update</span><span class=\"params\">(String id, String name)</span> </span>&#123;</span><br><span class=\"line\">    areaService.updateAreaById(id, name);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ResponseResult.ok();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Service层</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"meta\">@Transactional</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">updateAreaById</span><span class=\"params\">(String id, String name)</span> </span>&#123;</span><br><span class=\"line\">        AreaEntity entity = <span class=\"keyword\">new</span> AreaEntity();</span><br><span class=\"line\">        entity.setAreaId(Integer.parseInt(id));</span><br><span class=\"line\">        entity.setAreaName(name);</span><br><span class=\"line\">        Integer integer = <span class=\"keyword\">this</span>.baseMapper.updateById(entity);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (integer &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>这就奇怪了,项目整合没啥问题,怎么操作终端的就是不回滚呢。好吧，我开始怀疑人生了。。。<br>于是我又用同样的操作，测试了用户更新，果然不负所望，跟操作终端的update一样的效果。我先冷静会。。。后来我各种神测试，在终端的Controller层调用Area的Service层，在终端Service层调用Area的Service层。突然，原来的测试Area的事务也不回滚了，这下彻底无解了。</p>\n<p>这期间实在头疼，脑子里各种回忆还有那种可能。好像项目中还有比较影响的就是Shiro了，于是灵机一动，百度一下”Shiro 使注解无效”。果然，有大牛给出了答案。<a href=\"https://blog.csdn.net/gnail_oug/article/details/80706205\" target=\"_blank\" rel=\"noopener\">Spring Boot整合shiro后导致@Cacheable、@Transactional等注解失效的问题</a></p>\n<p>参考:<br>stackoverflow网站上的一些文章认为，Shiro框架初始化比Spring框架的某些部件早，导致使用@Autowire注入Shiro框架的某些类不能被Spring正确初始化。<br><a href=\"https://stackoverflow.com/questions/21512791/spring-service-with-cacheable-methods-gets-initialized-without-cache-when-autowi\" target=\"_blank\" rel=\"noopener\">文章链接</a></p>\n<p>原来是shiro框架与spring框架的BeanFactory有所冲突，导致注入shiro框架的类不能被spring正确初始化。<br>于是修改了MyShiroRealm中的代码加入懒加载@Lazy</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Lazy</span></span><br><span class=\"line\"><span class=\"meta\">@Autowired</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> SysUserService userService;</span><br></pre></td></tr></table></figure>\n<p>终于，奇迹发生了，事务回滚了，我欣喜若狂。但回头想想，不对呀，Realm只注入了SysUserService，怎么会影响终端的Service,于是又开始各种寻找，果然SysUserService里注入了B，B又注入了终端的Service，这就是一环套一环啊，之前测试Area也解释通了，我在终端Service注入了AreaService，导致也被带跑偏了。</p>\n<p>终于这个找了2天的问题终于得到了解答。</p>\n<h2 id=\"补充知识点\"><a href=\"#补充知识点\" class=\"headerlink\" title=\"补充知识点\"></a>补充知识点</h2><p><a href=\"https://www.ibm.com/developerworks/cn/java/j-master-spring-transactional-use/\" target=\"_blank\" rel=\"noopener\">转自https://www.ibm.com/developerworks/cn/java/j-master-spring-transactional-use/</a></p>\n<p>Spring 事务管理分为编码式和声明式的两种方式。编程式事务指的是通过编码方式实现事务；声明式事务基于 AOP,将具体业务逻辑与事务处理解耦。声明式事务管理使业务代码逻辑不受污染, 因此在实际使用中声明式事务用的比较多</p>\n<h3 id=\"Transactional注解实现事务管理的步骤\"><a href=\"#Transactional注解实现事务管理的步骤\" class=\"headerlink\" title=\"@Transactional注解实现事务管理的步骤\"></a>@Transactional注解实现事务管理的步骤</h3><h4 id=\"事务配置信息\"><a href=\"#事务配置信息\" class=\"headerlink\" title=\"事务配置信息\"></a>事务配置信息</h4><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">tx:annotation-driven</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"transactionManager\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.springframework.jdbc.datasource.DataSourceTransactionManager\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"dataSource\"</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"dataSource\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>或者使用 <strong>@EnableTransactionManagement</strong> 注解</p>\n<h4 id=\"将-Transactional-注解添加到合适的方法上，并设置合适的属性信息。\"><a href=\"#将-Transactional-注解添加到合适的方法上，并设置合适的属性信息。\" class=\"headerlink\" title=\"将@Transactional 注解添加到合适的方法上，并设置合适的属性信息。\"></a>将@Transactional 注解添加到合适的方法上，并设置合适的属性信息。</h4><p>@Transactional 注解的属性信息</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">属性名</th>\n<th style=\"text-align:left\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">name</td>\n<td style=\"text-align:left\">当在配置文件中有多个 TransactionManager , 可以用该属性指定选择哪个事务管理器</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">propagation</td>\n<td style=\"text-align:left\">事务的传播行为，默认值为 REQUIRED</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">isolation</td>\n<td style=\"text-align:left\">事务的隔离度，默认值采用 DEFAULT</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">timeout</td>\n<td style=\"text-align:left\">事务的超时时间，默认值为-1。如果超过该时间限制但事务还没有完成，则自动回滚事务</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">read-only</td>\n<td style=\"text-align:left\">指定事务是否为只读事务，默认值为 false；为了忽略那些不需要事务的方法，比如读取数据，可以设置 read-only 为 true</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">rollback-for</td>\n<td style=\"text-align:left\">用于指定能够触发事务回滚的异常类型，如果有多个异常类型需要指定，各类型之间可以通过逗号分隔</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">no-rollback-for</td>\n<td style=\"text-align:left\">抛出 no-rollback-for 指定的异常类型，不回滚事务</td>\n</tr>\n</tbody>\n</table>\n<p>除此以外，@Transactional 注解也可以添加到类级别上。当把@Transactional 注解放在类级别时，表示所有该类的公共方法都配置相同的事务属性信息。见清单 2，EmployeeService 的所有方法都支持事务并且是只读。当类级别配置了@Transactional，方法级别也配置了@Transactional，应用程序会以方法级别的事务属性信息来管理事务，换言之，方法级别的事务属性信息会覆盖类级别的相关配置信息</p>\n<p><strong>read-only使用场景</strong></p>\n<p>从这一点设置的时间点开始（时间点a）到这个事务结束的过程中，其他事务所提交的数据，该事务将看不见！（查询中不会出现别人在时间点a之后提交的数据）</p>\n<p>如果你一次执行单条查询语句，则没有必要启用事务支持，数据库默认支持SQL执行期间的读一致性；<br>如果你一次执行多条查询语句，例如统计查询，报表查询，在这种场景下，多条查询SQL必须保证整体的读一致性，否则，在前条SQL查询之后，后条SQL查询之前，数据被其他用户改变，则该次整体的统计查询将会出现读数据不一致的状态，此时，应该启用事务支持。<br>【注意是一次执行多次查询来统计某些信息，这时为了保证数据整体的一致性，要用只读事务】</p>\n<p>在将事务设置成只读后，相当于将数据库设置成只读数据库，此时若要进行写的操作，会出现错误</p>\n<h3 id=\"Spring-的注解方式的事务实现机制\"><a href=\"#Spring-的注解方式的事务实现机制\" class=\"headerlink\" title=\"Spring 的注解方式的事务实现机制\"></a>Spring 的注解方式的事务实现机制</h3><p>在应用系统调用声明@Transactional 的目标方法时，Spring Framework 默认使用 AOP 代理，在代码运行时生成一个代理对象，根据@Transactional 的属性配置信息，这个代理对象决定该声明@Transactional 的目标方法是否由拦截器 TransactionInterceptor 来使用拦截，在 TransactionInterceptor 拦截时，会在在目标方法开始执行之前创建并加入事务，并执行目标方法的逻辑, 最后根据执行情况是否出现异常，利用抽象事务管理器</p>\n<p><img src=\"D:/WorkSpaces/Hexo/HexoBlog/source/_posts/%E8%AE%B0%E4%B8%80%E6%AC%A1-Transactional%E4%B8%8D%E8%B5%B7%E4%BD%9C%E7%94%A8%E7%9A%84%E6%8E%92%E9%94%99%E5%8E%86%E7%A8%8B/01Spring%E4%BA%8B%E5%8A%A1%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6.jpg\" alt=\"image\"></p>\n<p>Spring AOP 代理有 CglibAopProxy 和 JdkDynamicAopProxy 两种，上图 是以 CglibAopProxy 为例，对于 CglibAopProxy，需要调用其内部类的 DynamicAdvisedInterceptor 的 intercept 方法。对于 JdkDynamicAopProxy，需要调用其 invoke 方法。</p>\n<p>正如上文提到的，事务管理的框架是由抽象事务管理器 AbstractPlatformTransactionManager 来提供的，而具体的底层事务处理实现，由 PlatformTransactionManager 的具体实现类来实现，如事务管理器 DataSourceTransactionManager。不同的事务管理器管理不同的数据资源 DataSource，比如 DataSourceTransactionManager 管理 JDBC 的 Connection。</p>\n<p>PlatformTransactionManager，AbstractPlatformTransactionManager 及具体实现类关系下图所示</p>\n<p><img src=\"D:/WorkSpaces/Hexo/HexoBlog/source/_posts/%E8%AE%B0%E4%B8%80%E6%AC%A1-Transactional%E4%B8%8D%E8%B5%B7%E4%BD%9C%E7%94%A8%E7%9A%84%E6%8E%92%E9%94%99%E5%8E%86%E7%A8%8B/02TransactionManager%E7%B1%BB%E7%BB%93%E6%9E%84.jpg\" alt=\"image\"></p>\n<h3 id=\"Spring事务7种传播行为\"><a href=\"#Spring事务7种传播行为\" class=\"headerlink\" title=\"Spring事务7种传播行为\"></a>Spring事务7种传播行为</h3><p>所谓事务的传播行为是指，如果在开始当前事务之前，一个事务上下文已经存在，此时有若干选项可以指定一个事务性方法的执行行为。</p>\n<ul>\n<li><strong>PROPAGATION.REQUIRED</strong>：如果当前没有事务，就创建一个新事务，如果当前存在事务，就加入该事务，该设置是最常用的设置。<strong>Spring默认的传播行为</strong></li>\n<li><strong>PROPAGATION.SUPPORTS</strong>：支持当前事务，如果当前存在事务，就加入该事务，如果当前不存在事务，就以非事务执行。</li>\n<li><strong>PROPAGATION.MANDATORY</strong>：支持当前事务，如果当前存在事务，就加入该事务，如果当前不存在事务，就抛出异常</li>\n<li><strong>PROPAGATION.REQUIRES_NEW</strong>：创建新事务，无论当前存不存在事务，都创建新事务</li>\n<li><strong>PROPAGATION.NOT_SUPPORTED</strong>：以非事务方式执行操作，如果当前存在事务，就把当前事务挂起</li>\n<li><strong>PROPAGATION.NEVER</strong>：以非事务方式执行，如果当前存在事务，则抛出异常</li>\n<li><strong>PROPAGATION.NESTED</strong>：如果当前存在事务，则在嵌套事务内执行。如果当前没有事务，则执行与PROPAGATION_REQUIRED类似的操作</li>\n</ul>\n<h3 id=\"Spring事务隔离性\"><a href=\"#Spring事务隔离性\" class=\"headerlink\" title=\"Spring事务隔离性\"></a>Spring事务隔离性</h3><p><a href=\"https://www.cnblogs.com/huanongying/p/7021555.html\" target=\"_blank\" rel=\"noopener\">示例地址</a></p>\n<p>隔离级别是指若干个并发的事务之间的隔离程度，与我们开发时候主要相关的场景包括：脏读取、重复读、幻读。</p>\n<ul>\n<li>DEFAULT ：这是默认值，表示使用底层数据库的默认隔离级别。对大部分数据库而言，通常这值就是： READ_COMMITTED 。 MyAQL查询(SELECT @@tx_isolation)</li>\n<li>READ_UNCOMMITTED ：该隔离级别表示一个事务可以读取另一个事务修改但还没有提交的数据。该级别不能防止脏读和不可重复读，因此很少使用该隔离级别。 </li>\n<li>READ_COMMITTED ：该隔离级别表示一个事务只能读取另一个事务已经提交的数据。该级别可以防止脏读，这也是大多数情况下的推荐值。 </li>\n<li>REPEATABLE_READ ：该隔离级别表示一个事务在整个过程中可以多次重复执行某个查询，并且每次返回的记录都相同。即使在多次查询之间有新增的数据满足该查询，这些新增的记录也会被忽略。该级别可以防止脏读和不可重复读。 </li>\n<li>SERIALIZABLE ：所有的事务依次逐个执行，这样事务之间就完全不可能产生干扰，也就是说，该级别可以防止脏读、不可重复读以及幻读。但是这将严重影响程序的性能。通常情况下也不会用到该级别。 </li>\n</ul>\n<p>指定方法：通过使用 isolation 属性设置，例如：@Transactional(isolation = Isolation.DEFAULT)/</p>\n<p><strong>丢失更新</strong>：两个事务同时更新一行数据，最后一个事务的更新会覆盖掉第一个事务的更新，从而导致第一个事务更新的数据丢失，后果比较严重。一般是由于没加锁的原因造成的。<br><strong>脏读（Dirty reads）</strong>：一个事务A读取到了另一个事务B还没有提交的数据，并在此基础上进行操作。如果B事务rollback，那么A事务所读取到的数据就是不正确的，会带来问题。<br><strong>不可重复读（Non-repeatable reads）</strong>：在同一事务范围内读取两次相同的数据，所返回的结果不同。比如事务B第一次读数据后，事务A更新数据并commit，那么事务B第二次读取的数据就与第一次是不一样的。<br><strong>幻读（Phantom reads）</strong>：一个事务A读取到了另一个事务B新提交的数据。比如，事务A对一个表中所有行的数据按照某规则进行修改（整表操作），同时，事务B向表中插入了一行原始数据，那么后面事务A再对表进行操作时，会发现表中居然还有一行数据没有被修改，就像发生了幻觉，飘飘欲仙一样。<br>注意：不可重复读和幻读的区别是，不可重复读对应的表的操作是更改(UPDATE)，而幻读对应的表的操作是插入(INSERT)，两种的应对策略不一样。对于不可重复读，只需要采用行级锁防止该记录被更新即可，而对于幻读必须加个表级锁，防止在表中插入数据。有关锁的问题，下面会讨论。</p>\n","site":{"data":{}},"length":8520,"excerpt":"<h1 id=\"记一次-Transactional不起作用的排错历程\"><a href=\"#记一次-Transactional不起作用的排错历程\" class=\"headerlink\" title=\"记一次@Transactional不起作用的排错历程\"></a>记一次@Transactional不起作用的排错历程</h1><h2 id=\"问题描述\"><a href=\"#问题描述\" class=\"headerlink\" title=\"问题描述\"></a>问题描述</h2><p>服务端接口需提供接口，在web端将某个终端调为在线模式时，同时需要更新内存中在线的终端数据。 在更新终端状态成功之后，立刻查询数据库处于在线状态的终端数据,然后内存中的数据。更新状态与更新内存数据在同一个事务，查询操作需要保证能够读取到还未提交的更新操作。</p>","more":"<p>想到这应该是设计到事务的隔离性这块，因为之前对事务处理这块认识比较不足，就决定来科普下事务相关的知识点。</p>\n<p>但出门的第一步就跌了个大跟头，代码里的事务根本不起作用，@Transactional注解形同虚设，于是开始排错。</p>\n<p>代码是这样的(项目整合了SpringBoot+MyBatisPlus+Druid+Shiro)</p>\n<p>Controller层</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RequestMapping</span>(value = <span class=\"string\">\"/switchstatus\"</span>, method = RequestMethod.POST)</span><br><span class=\"line\"><span class=\"meta\">@RequiresPermissions</span>(<span class=\"string\">\"oilset:intelligentterminal:update\"</span>)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> ResponseResult <span class=\"title\">switchStatus</span><span class=\"params\">(String uid, Integer status)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (StrUtils.isEmpty(uid) || status == <span class=\"keyword\">null</span>) <span class=\"keyword\">return</span> ResponseResult.error(ResponseCode.requiredParamNotFound);</span><br><span class=\"line\">    IntelligentterminalEntity entity = intelligentterminalService.selectById(uid);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (entity == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResponseResult.error(ResponseCode.recordNotFound);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (entity.getStatus() == status) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResponseResult.error(ResponseCode.requestParamInvalid);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">boolean</span> success = intelligentterminalService.switchStatus(uid, status);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> success ? ResponseResult.ok() : ResponseResult.error();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Service层</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"meta\">@Transactional</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">switchStatus</span><span class=\"params\">(String uid, Integer status)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">boolean</span> success = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    success = <span class=\"keyword\">this</span>.updateById(<span class=\"keyword\">new</span> IntelligentterminalEntity(uid, status), SpringContextHolder.getLogInUserId());</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (success) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> success;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>尝试手动rollback,事务可以回滚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Autowired</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> DataSourceTransactionManager transactionManager;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"meta\">@Transactional</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">switchStatus</span><span class=\"params\">(String uid, Integer status)</span> </span>&#123;</span><br><span class=\"line\">    DefaultTransactionDefinition def = <span class=\"keyword\">new</span> DefaultTransactionDefinition();</span><br><span class=\"line\">    def.setName(<span class=\"string\">\"text-transaction\"</span>);</span><br><span class=\"line\">    def.setPropagationBehavior(TransactionDefinition.PROPAGATION_REQUIRED);</span><br><span class=\"line\">    TransactionStatus tsStatus = transactionManager.getTransaction(def);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">boolean</span> success = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        success = <span class=\"keyword\">this</span>.updateById(<span class=\"keyword\">new</span> IntelligentterminalEntity(uid, status), SpringContextHolder.getLogInUserId());</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (success)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (RuntimeException e) &#123;</span><br><span class=\"line\">        transactionManager.rollback(tsStatus);</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> e;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> success;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>启动类加入了</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@EnableTransactionManagement</span><br></pre></td></tr></table></figure>\n<p>application.properties加入了</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring.transaction.rollback-on-commit-failure=true</span><br></pre></td></tr></table></figure>\n<p>本来想的是，本次更新应该不会成功，可数据库偏偏就更新了，事务根本就没有回滚。</p>\n<h2 id=\"分析\"><a href=\"#分析\" class=\"headerlink\" title=\"分析\"></a>分析</h2><ul>\n<li>事务用法不对，对@Transactional的用法存在问题</li>\n<li>项目搭建/配置存在问题，导致整个项目事务不起作用</li>\n<li>框架之间整合不兼容，导致事务不起作用</li>\n</ul>\n<h3 id=\"排错之一：SpringBoot事务管理用法错误\"><a href=\"#排错之一：SpringBoot事务管理用法错误\" class=\"headerlink\" title=\"排错之一：SpringBoot事务管理用法错误\"></a>排错之一：SpringBoot事务管理用法错误</h3><p>经过查阅各种资料，SpringBoot中声明式事务注意点有以下几点：</p>\n<ul>\n<li>@Transactional 只能应用到 public 方法才有效</li>\n<li>正确的设置@Transactional 的 rollbackFor 属性。默认情况下，如果在事务中抛出了未检查异常（继承自 RuntimeException 的异常）或者 Error，则 Spring 将回滚事务；除此之外，Spring 不会回滚事务。如果在事务中抛出其他类型的异常，并期望 Spring 能够回滚事务，可以指定 rollbackFor</li>\n<li>正确的设置@Transactional 的 propagation 属性</li>\n<li>避免 Spring 的 AOP 的自调用问题。在 Spring 的 AOP 代理下，只有目标方法由外部调用，目标方法才由 Spring 生成的代理对象来管理，这会造成自调用问题。若同一类中的其他没有@Transactional 注解的方法内部调用有@Transactional 注解的方法，有@Transactional 注解的方法的事务被忽略，不会发生回滚。</li>\n<li>抛出的异常不能被catch,或者catch后抛出其他异常</li>\n</ul>\n<p>检查代码后，所有这些条件都符合，可是就是没有生效呢。于是只能换个思路走走</p>\n<h3 id=\"排错之二：数据库引擎类型不支持\"><a href=\"#排错之二：数据库引擎类型不支持\" class=\"headerlink\" title=\"排错之二：数据库引擎类型不支持\"></a>排错之二：数据库引擎类型不支持</h3><p>数据库引擎要支持事务，如果是MySQL，注意表要使用支持事务的引擎，比如innodb，如果是myisam，事务是不起作用的。可检查发现表引擎确实是innodb。为了确认表引擎支持事务，我还重新在另一个项目里测试了表确实支持事务。那这到底是为啥呢，别的项目里可以，目前这个项目里就是不生效。于是怀疑是项目各框架之间整合出了问题。</p>\n<h3 id=\"排错之三：框架整合冲突\"><a href=\"#排错之三：框架整合冲突\" class=\"headerlink\" title=\"排错之三：框架整合冲突\"></a>排错之三：框架整合冲突</h3><p>第一步：<br>我重新建一张测试表, 然后操作这张表，其他代码与原代码一致。见证奇迹的时候到了,事务回滚了，欣喜若狂。代码如下</p>\n<p>Controller层</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RequestMapping</span>(<span class=\"string\">\"/update\"</span>)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> ResponseResult <span class=\"title\">update</span><span class=\"params\">(String id, String name)</span> </span>&#123;</span><br><span class=\"line\">    areaService.updateAreaById(id, name);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ResponseResult.ok();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Service层</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"meta\">@Transactional</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">updateAreaById</span><span class=\"params\">(String id, String name)</span> </span>&#123;</span><br><span class=\"line\">        AreaEntity entity = <span class=\"keyword\">new</span> AreaEntity();</span><br><span class=\"line\">        entity.setAreaId(Integer.parseInt(id));</span><br><span class=\"line\">        entity.setAreaName(name);</span><br><span class=\"line\">        Integer integer = <span class=\"keyword\">this</span>.baseMapper.updateById(entity);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (integer &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>这就奇怪了,项目整合没啥问题,怎么操作终端的就是不回滚呢。好吧，我开始怀疑人生了。。。<br>于是我又用同样的操作，测试了用户更新，果然不负所望，跟操作终端的update一样的效果。我先冷静会。。。后来我各种神测试，在终端的Controller层调用Area的Service层，在终端Service层调用Area的Service层。突然，原来的测试Area的事务也不回滚了，这下彻底无解了。</p>\n<p>这期间实在头疼，脑子里各种回忆还有那种可能。好像项目中还有比较影响的就是Shiro了，于是灵机一动，百度一下”Shiro 使注解无效”。果然，有大牛给出了答案。<a href=\"https://blog.csdn.net/gnail_oug/article/details/80706205\" target=\"_blank\" rel=\"noopener\">Spring Boot整合shiro后导致@Cacheable、@Transactional等注解失效的问题</a></p>\n<p>参考:<br>stackoverflow网站上的一些文章认为，Shiro框架初始化比Spring框架的某些部件早，导致使用@Autowire注入Shiro框架的某些类不能被Spring正确初始化。<br><a href=\"https://stackoverflow.com/questions/21512791/spring-service-with-cacheable-methods-gets-initialized-without-cache-when-autowi\" target=\"_blank\" rel=\"noopener\">文章链接</a></p>\n<p>原来是shiro框架与spring框架的BeanFactory有所冲突，导致注入shiro框架的类不能被spring正确初始化。<br>于是修改了MyShiroRealm中的代码加入懒加载@Lazy</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Lazy</span></span><br><span class=\"line\"><span class=\"meta\">@Autowired</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> SysUserService userService;</span><br></pre></td></tr></table></figure>\n<p>终于，奇迹发生了，事务回滚了，我欣喜若狂。但回头想想，不对呀，Realm只注入了SysUserService，怎么会影响终端的Service,于是又开始各种寻找，果然SysUserService里注入了B，B又注入了终端的Service，这就是一环套一环啊，之前测试Area也解释通了，我在终端Service注入了AreaService，导致也被带跑偏了。</p>\n<p>终于这个找了2天的问题终于得到了解答。</p>\n<h2 id=\"补充知识点\"><a href=\"#补充知识点\" class=\"headerlink\" title=\"补充知识点\"></a>补充知识点</h2><p><a href=\"https://www.ibm.com/developerworks/cn/java/j-master-spring-transactional-use/\" target=\"_blank\" rel=\"noopener\">转自https://www.ibm.com/developerworks/cn/java/j-master-spring-transactional-use/</a></p>\n<p>Spring 事务管理分为编码式和声明式的两种方式。编程式事务指的是通过编码方式实现事务；声明式事务基于 AOP,将具体业务逻辑与事务处理解耦。声明式事务管理使业务代码逻辑不受污染, 因此在实际使用中声明式事务用的比较多</p>\n<h3 id=\"Transactional注解实现事务管理的步骤\"><a href=\"#Transactional注解实现事务管理的步骤\" class=\"headerlink\" title=\"@Transactional注解实现事务管理的步骤\"></a>@Transactional注解实现事务管理的步骤</h3><h4 id=\"事务配置信息\"><a href=\"#事务配置信息\" class=\"headerlink\" title=\"事务配置信息\"></a>事务配置信息</h4><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">tx:annotation-driven</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"transactionManager\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.springframework.jdbc.datasource.DataSourceTransactionManager\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"dataSource\"</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"dataSource\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>或者使用 <strong>@EnableTransactionManagement</strong> 注解</p>\n<h4 id=\"将-Transactional-注解添加到合适的方法上，并设置合适的属性信息。\"><a href=\"#将-Transactional-注解添加到合适的方法上，并设置合适的属性信息。\" class=\"headerlink\" title=\"将@Transactional 注解添加到合适的方法上，并设置合适的属性信息。\"></a>将@Transactional 注解添加到合适的方法上，并设置合适的属性信息。</h4><p>@Transactional 注解的属性信息</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">属性名</th>\n<th style=\"text-align:left\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">name</td>\n<td style=\"text-align:left\">当在配置文件中有多个 TransactionManager , 可以用该属性指定选择哪个事务管理器</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">propagation</td>\n<td style=\"text-align:left\">事务的传播行为，默认值为 REQUIRED</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">isolation</td>\n<td style=\"text-align:left\">事务的隔离度，默认值采用 DEFAULT</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">timeout</td>\n<td style=\"text-align:left\">事务的超时时间，默认值为-1。如果超过该时间限制但事务还没有完成，则自动回滚事务</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">read-only</td>\n<td style=\"text-align:left\">指定事务是否为只读事务，默认值为 false；为了忽略那些不需要事务的方法，比如读取数据，可以设置 read-only 为 true</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">rollback-for</td>\n<td style=\"text-align:left\">用于指定能够触发事务回滚的异常类型，如果有多个异常类型需要指定，各类型之间可以通过逗号分隔</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">no-rollback-for</td>\n<td style=\"text-align:left\">抛出 no-rollback-for 指定的异常类型，不回滚事务</td>\n</tr>\n</tbody>\n</table>\n<p>除此以外，@Transactional 注解也可以添加到类级别上。当把@Transactional 注解放在类级别时，表示所有该类的公共方法都配置相同的事务属性信息。见清单 2，EmployeeService 的所有方法都支持事务并且是只读。当类级别配置了@Transactional，方法级别也配置了@Transactional，应用程序会以方法级别的事务属性信息来管理事务，换言之，方法级别的事务属性信息会覆盖类级别的相关配置信息</p>\n<p><strong>read-only使用场景</strong></p>\n<p>从这一点设置的时间点开始（时间点a）到这个事务结束的过程中，其他事务所提交的数据，该事务将看不见！（查询中不会出现别人在时间点a之后提交的数据）</p>\n<p>如果你一次执行单条查询语句，则没有必要启用事务支持，数据库默认支持SQL执行期间的读一致性；<br>如果你一次执行多条查询语句，例如统计查询，报表查询，在这种场景下，多条查询SQL必须保证整体的读一致性，否则，在前条SQL查询之后，后条SQL查询之前，数据被其他用户改变，则该次整体的统计查询将会出现读数据不一致的状态，此时，应该启用事务支持。<br>【注意是一次执行多次查询来统计某些信息，这时为了保证数据整体的一致性，要用只读事务】</p>\n<p>在将事务设置成只读后，相当于将数据库设置成只读数据库，此时若要进行写的操作，会出现错误</p>\n<h3 id=\"Spring-的注解方式的事务实现机制\"><a href=\"#Spring-的注解方式的事务实现机制\" class=\"headerlink\" title=\"Spring 的注解方式的事务实现机制\"></a>Spring 的注解方式的事务实现机制</h3><p>在应用系统调用声明@Transactional 的目标方法时，Spring Framework 默认使用 AOP 代理，在代码运行时生成一个代理对象，根据@Transactional 的属性配置信息，这个代理对象决定该声明@Transactional 的目标方法是否由拦截器 TransactionInterceptor 来使用拦截，在 TransactionInterceptor 拦截时，会在在目标方法开始执行之前创建并加入事务，并执行目标方法的逻辑, 最后根据执行情况是否出现异常，利用抽象事务管理器</p>\n<p><img src=\"D:/WorkSpaces/Hexo/HexoBlog/source/_posts/%E8%AE%B0%E4%B8%80%E6%AC%A1-Transactional%E4%B8%8D%E8%B5%B7%E4%BD%9C%E7%94%A8%E7%9A%84%E6%8E%92%E9%94%99%E5%8E%86%E7%A8%8B/01Spring%E4%BA%8B%E5%8A%A1%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6.jpg\" alt=\"image\"></p>\n<p>Spring AOP 代理有 CglibAopProxy 和 JdkDynamicAopProxy 两种，上图 是以 CglibAopProxy 为例，对于 CglibAopProxy，需要调用其内部类的 DynamicAdvisedInterceptor 的 intercept 方法。对于 JdkDynamicAopProxy，需要调用其 invoke 方法。</p>\n<p>正如上文提到的，事务管理的框架是由抽象事务管理器 AbstractPlatformTransactionManager 来提供的，而具体的底层事务处理实现，由 PlatformTransactionManager 的具体实现类来实现，如事务管理器 DataSourceTransactionManager。不同的事务管理器管理不同的数据资源 DataSource，比如 DataSourceTransactionManager 管理 JDBC 的 Connection。</p>\n<p>PlatformTransactionManager，AbstractPlatformTransactionManager 及具体实现类关系下图所示</p>\n<p><img src=\"D:/WorkSpaces/Hexo/HexoBlog/source/_posts/%E8%AE%B0%E4%B8%80%E6%AC%A1-Transactional%E4%B8%8D%E8%B5%B7%E4%BD%9C%E7%94%A8%E7%9A%84%E6%8E%92%E9%94%99%E5%8E%86%E7%A8%8B/02TransactionManager%E7%B1%BB%E7%BB%93%E6%9E%84.jpg\" alt=\"image\"></p>\n<h3 id=\"Spring事务7种传播行为\"><a href=\"#Spring事务7种传播行为\" class=\"headerlink\" title=\"Spring事务7种传播行为\"></a>Spring事务7种传播行为</h3><p>所谓事务的传播行为是指，如果在开始当前事务之前，一个事务上下文已经存在，此时有若干选项可以指定一个事务性方法的执行行为。</p>\n<ul>\n<li><strong>PROPAGATION.REQUIRED</strong>：如果当前没有事务，就创建一个新事务，如果当前存在事务，就加入该事务，该设置是最常用的设置。<strong>Spring默认的传播行为</strong></li>\n<li><strong>PROPAGATION.SUPPORTS</strong>：支持当前事务，如果当前存在事务，就加入该事务，如果当前不存在事务，就以非事务执行。</li>\n<li><strong>PROPAGATION.MANDATORY</strong>：支持当前事务，如果当前存在事务，就加入该事务，如果当前不存在事务，就抛出异常</li>\n<li><strong>PROPAGATION.REQUIRES_NEW</strong>：创建新事务，无论当前存不存在事务，都创建新事务</li>\n<li><strong>PROPAGATION.NOT_SUPPORTED</strong>：以非事务方式执行操作，如果当前存在事务，就把当前事务挂起</li>\n<li><strong>PROPAGATION.NEVER</strong>：以非事务方式执行，如果当前存在事务，则抛出异常</li>\n<li><strong>PROPAGATION.NESTED</strong>：如果当前存在事务，则在嵌套事务内执行。如果当前没有事务，则执行与PROPAGATION_REQUIRED类似的操作</li>\n</ul>\n<h3 id=\"Spring事务隔离性\"><a href=\"#Spring事务隔离性\" class=\"headerlink\" title=\"Spring事务隔离性\"></a>Spring事务隔离性</h3><p><a href=\"https://www.cnblogs.com/huanongying/p/7021555.html\" target=\"_blank\" rel=\"noopener\">示例地址</a></p>\n<p>隔离级别是指若干个并发的事务之间的隔离程度，与我们开发时候主要相关的场景包括：脏读取、重复读、幻读。</p>\n<ul>\n<li>DEFAULT ：这是默认值，表示使用底层数据库的默认隔离级别。对大部分数据库而言，通常这值就是： READ_COMMITTED 。 MyAQL查询(SELECT @@tx_isolation)</li>\n<li>READ_UNCOMMITTED ：该隔离级别表示一个事务可以读取另一个事务修改但还没有提交的数据。该级别不能防止脏读和不可重复读，因此很少使用该隔离级别。 </li>\n<li>READ_COMMITTED ：该隔离级别表示一个事务只能读取另一个事务已经提交的数据。该级别可以防止脏读，这也是大多数情况下的推荐值。 </li>\n<li>REPEATABLE_READ ：该隔离级别表示一个事务在整个过程中可以多次重复执行某个查询，并且每次返回的记录都相同。即使在多次查询之间有新增的数据满足该查询，这些新增的记录也会被忽略。该级别可以防止脏读和不可重复读。 </li>\n<li>SERIALIZABLE ：所有的事务依次逐个执行，这样事务之间就完全不可能产生干扰，也就是说，该级别可以防止脏读、不可重复读以及幻读。但是这将严重影响程序的性能。通常情况下也不会用到该级别。 </li>\n</ul>\n<p>指定方法：通过使用 isolation 属性设置，例如：@Transactional(isolation = Isolation.DEFAULT)/</p>\n<p><strong>丢失更新</strong>：两个事务同时更新一行数据，最后一个事务的更新会覆盖掉第一个事务的更新，从而导致第一个事务更新的数据丢失，后果比较严重。一般是由于没加锁的原因造成的。<br><strong>脏读（Dirty reads）</strong>：一个事务A读取到了另一个事务B还没有提交的数据，并在此基础上进行操作。如果B事务rollback，那么A事务所读取到的数据就是不正确的，会带来问题。<br><strong>不可重复读（Non-repeatable reads）</strong>：在同一事务范围内读取两次相同的数据，所返回的结果不同。比如事务B第一次读数据后，事务A更新数据并commit，那么事务B第二次读取的数据就与第一次是不一样的。<br><strong>幻读（Phantom reads）</strong>：一个事务A读取到了另一个事务B新提交的数据。比如，事务A对一个表中所有行的数据按照某规则进行修改（整表操作），同时，事务B向表中插入了一行原始数据，那么后面事务A再对表进行操作时，会发现表中居然还有一行数据没有被修改，就像发生了幻觉，飘飘欲仙一样。<br>注意：不可重复读和幻读的区别是，不可重复读对应的表的操作是更改(UPDATE)，而幻读对应的表的操作是插入(INSERT)，两种的应对策略不一样。对于不可重复读，只需要采用行级锁防止该记录被更新即可，而对于幻读必须加个表级锁，防止在表中插入数据。有关锁的问题，下面会讨论。</p>"}],"PostAsset":[],"PostCategory":[{"post_id":"ck27dih180000mskpbk426dyy","category_id":"ck27dih1s0004mskp4sxdzq80","_id":"ck27dih29000dmskpt180mbhb"},{"post_id":"ck27dih1k0002mskp58dr3i9v","category_id":"ck27dih240009mskpae6wa7gy","_id":"ck27dih2d000imskpi9g55mkm"},{"post_id":"ck27dih1w0006mskps5up6vty","category_id":"ck27dih1s0004mskp4sxdzq80","_id":"ck27dih2h000lmskpsvig3jrh"},{"post_id":"ck27dih200007mskpdmvhxywz","category_id":"ck27dih2d000hmskpwzld4efq","_id":"ck27dih2h000pmskpuq4huk4f"},{"post_id":"ck27dih240008mskp18panrad","category_id":"ck27dih2h000mmskpxdx4ns7g","_id":"ck27dih2m000tmskp17897hbq"},{"post_id":"ck27dih28000cmskp116iltb1","category_id":"ck27dih2h000mmskpxdx4ns7g","_id":"ck27dih2m000vmskp2w93dsx1"}],"PostTag":[{"post_id":"ck27dih180000mskpbk426dyy","tag_id":"ck27dih1w0005mskpusa0mk9b","_id":"ck27dih24000bmskp14ir6kq1"},{"post_id":"ck27dih1k0002mskp58dr3i9v","tag_id":"ck27dih24000amskp07wxzbts","_id":"ck27dih2d000gmskp1bcm1ia6"},{"post_id":"ck27dih1w0006mskps5up6vty","tag_id":"ck27dih1w0005mskpusa0mk9b","_id":"ck27dih2d000kmskpfqphri3v"},{"post_id":"ck27dih200007mskpdmvhxywz","tag_id":"ck27dih2d000jmskprohfn22n","_id":"ck27dih2h000omskpu5zt7olr"},{"post_id":"ck27dih240008mskp18panrad","tag_id":"ck27dih2h000nmskpfb4usypx","_id":"ck27dih2m000smskpoe4wxrss"},{"post_id":"ck27dih28000cmskp116iltb1","tag_id":"ck27dih2h000nmskpfb4usypx","_id":"ck27dih2m000umskpzodoa8es"}],"Tag":[{"name":"Hexo博客","_id":"ck27dih1w0005mskpusa0mk9b"},{"name":"Git","_id":"ck27dih24000amskp07wxzbts"},{"name":"FTP","_id":"ck27dih2d000jmskprohfn22n"},{"name":"经验总结","_id":"ck27dih2h000nmskpfb4usypx"}]}}